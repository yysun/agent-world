var sl=Object.defineProperty;var il=(t,e,n)=>e in t?sl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var A=(t,e,n)=>il(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(l){if(l.ep)return;l.ep=!0;const o=n(l);fetch(l.href,o)}})();const pr="3.38.0",al=`AppRun-${pr}`;class fr{constructor(){this._events={}}on(e,n,r={}){this._events[e]=this._events[e]||[],this._events[e].push({fn:n,options:r})}off(e,n){const r=this._events[e]||[];this._events[e]=r.filter(l=>l.fn!==n)}find(e){return this._events[e]}run(e,...n){const r=this.getSubscribers(e,this._events);return console.assert(r&&r.length>0,"No subscriber for event: "+e),r.forEach(l=>{const{fn:o,options:a}=l;if(!o||typeof o!="function")return console.error(`AppRun event handler for '${e}' is not a function:`,o),!1;if(a.delay)this.delay(e,o,n,a);else try{Object.keys(a).length>0?o.apply(this,[...n,a]):o.apply(this,n)}catch(i){console.error(`Error in event handler for '${e}':`,i)}return!l.options.once}),r.length}once(e,n,r={}){this.on(e,n,{...r,once:!0})}delay(e,n,r,l){l._t&&clearTimeout(l._t),l._t=setTimeout(()=>{clearTimeout(l._t);try{Object.keys(l).length>0?n.apply(this,[...r,l]):n.apply(this,r)}catch(o){console.error(`Error in delayed event handler for '${e}':`,o)}},l.delay)}runAsync(e,...n){const r=this.getSubscribers(e,this._events);console.assert(r&&r.length>0,"No subscriber for event: "+e);const l=r.map(o=>{const{fn:a,options:i}=o;if(!a||typeof a!="function")return console.error(`AppRun async event handler for '${e}' is not a function:`,a),Promise.resolve(null);try{return Object.keys(i).length>0?a.apply(this,[...n,i]):a.apply(this,n)}catch(h){return console.error(`Error in async event handler for '${e}':`,h),Promise.reject(h)}});return Promise.all(l)}query(e,...n){return console.warn("app.query() is deprecated. Use app.runAsync() instead."),this.runAsync(e,...n)}getSubscribers(e,n){const r=n[e]||[];return n[e]=r.filter(l=>!l.options.once),Object.keys(n).filter(l=>l.endsWith("*")&&e.startsWith(l.replace("*",""))).sort((l,o)=>o.length-l.length).forEach(l=>r.push(...n[l].map(o=>({...o,options:{...o.options,event:e}})))),r}}const cl=al;let ut;const Ue=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};Ue.app&&Ue._AppRunVersions?ut=Ue.app:(ut=new fr,Ue.app=ut,Ue._AppRunVersions=cl);const _=ut;function be(t){return(t==null?void 0:t.target)instanceof HTMLElement?t.target:null}function ul(t,e=document){try{return e.querySelector(t)}catch(n){return console.warn(`Invalid selector: ${t}`,n),null}}function dl(t){try{return document.getElementById(t)}catch(e){return console.warn(`Error getting element by id: ${t}`,e),null}}const gr=t=>{if(!t)return[];const e=[];let n="",r=!1,l="";for(let o=0;o<t.length;o++){const a=t[o];a==="["&&!r?(n&&(e.push(n),n=""),r=!0):a==="]"&&r?(l?n=n.slice(1,-1):/^\d+$/.test(n)&&(n=parseInt(n,10)),e.push(n),n="",r=!1,l=""):(a==='"'||a==="'")&&r?(l?a===l&&(l=""):l=a,n+=a):a==="."&&!r?n&&(e.push(n),n=""):n+=a}return n&&e.push(n),e},hl=(t,e)=>{let n=t;for(const r of e){if(n==null)return;n=n[r]}return n},pl=(t,e,n)=>{if(e.length===0)return n;const r={...t};let l=r;for(let o=0;o<e.length-1;o++){const a=e[o],i=e[o+1];l[a]==null?l[a]=typeof i=="number"?[]:{}:Array.isArray(l[a])?l[a]=[...l[a]]:typeof l[a]=="object"&&(l[a]={...l[a]}),l=l[a]}return l[e[e.length-1]]=n,r},ye=(t,e)=>{if(!e)return t.state||"";const n=gr(e),r=hl(t.state,n);return r!==void 0?r:""},we=(t,e,n)=>{if(!e){t.setState(n);return}const r=gr(e),l=t.state||{},o=pl(l,r,n);t.setState(o)},fl=(t,e,n,r)=>{if(t.startsWith("$on")){const l=e[t];if(t=t.substring(1),typeof l=="boolean")e[t]=o=>r.run?r.run(t,o):_.run(t,o);else if(typeof l=="string")e[t]=o=>r.run?r.run(l,o):_.run(l,o);else if(typeof l=="function")e[t]=o=>r.setState(l(r.state,o));else if(Array.isArray(l)){const[o,...a]=l;typeof o=="string"?e[t]=i=>r.run?r.run(o,...a,i):_.run(o,...a,i):typeof o=="function"&&(e[t]=i=>r.setState(o(r.state,...a,i)))}}else if(t==="$bind"){const l=e.type||"text",o=typeof e[t]=="string"?e[t]:e.name;if(n==="input")switch(l){case"checkbox":e.checked=ye(r,o),e.onclick=a=>{const i=be(a);i&&we(r,o||i.name,i.checked)};break;case"radio":e.checked=ye(r,o)===e.value,e.onclick=a=>{const i=be(a);i&&we(r,o||i.name,i.value)};break;case"number":case"range":e.value=ye(r,o),e.oninput=a=>{const i=be(a);i&&we(r,o||i.name,Number(i.value))};break;default:e.value=ye(r,o),e.oninput=a=>{const i=be(a);i&&we(r,o||i.name,i.value)}}else n==="select"?(e.value=ye(r,o),e.onchange=a=>{const i=be(a);i&&!i.multiple&&we(r,o||i.name,i.value)}):n==="option"?(e.selected=ye(r,o),e.onclick=a=>{const i=be(a);i&&we(r,o||i.name,i.selected)}):n==="textarea"&&(e.innerHTML=ye(r,o),e.oninput=a=>{const i=be(a);i&&we(r,o||i.name,i.value)})}else _.run("$",{key:t,tag:n,props:e,component:r})},gt=(t,e)=>{if(Array.isArray(t))return t.map(n=>gt(n,e));{let{type:n,tag:r,props:l,children:o}=t;return r=r||n,o=o||(l==null?void 0:l.children),l&&Object.keys(l).forEach(a=>{a.startsWith("$")&&(fl(a,l,r,e),delete l[a])}),o&&gt(o,e),t}};class Ke{constructor(e,n,r){this.normal=n,this.property=e,r&&(this.space=r)}}Ke.prototype.normal={};Ke.prototype.property={};Ke.prototype.space=void 0;function mr(t,e){const n={},r={};for(const l of t)Object.assign(n,l.property),Object.assign(r,l.normal);return new Ke(n,r,e)}function jt(t){return t.toLowerCase()}class G{constructor(e,n){this.attribute=n,this.property=e}}G.prototype.attribute="";G.prototype.booleanish=!1;G.prototype.boolean=!1;G.prototype.commaOrSpaceSeparated=!1;G.prototype.commaSeparated=!1;G.prototype.defined=!1;G.prototype.mustUseProperty=!1;G.prototype.number=!1;G.prototype.overloadedBoolean=!1;G.prototype.property="";G.prototype.spaceSeparated=!1;G.prototype.space=void 0;let gl=0;const k=ve(),L=ve(),qt=ve(),p=ve(),T=ve(),Ie=ve(),V=ve();function ve(){return 2**++gl}const Gt=Object.freeze(Object.defineProperty({__proto__:null,boolean:k,booleanish:L,commaOrSpaceSeparated:V,commaSeparated:Ie,number:p,overloadedBoolean:qt,spaceSeparated:T},Symbol.toStringTag,{value:"Module"})),Dt=Object.keys(Gt);class nn extends G{constructor(e,n,r,l){let o=-1;if(super(e,n),zn(this,"space",l),typeof r=="number")for(;++o<Dt.length;){const a=Dt[o];zn(this,Dt[o],(r&Gt[a])===Gt[a])}}}nn.prototype.defined=!0;function zn(t,e,n){n&&(t[e]=n)}function Pe(t){const e={},n={};for(const[r,l]of Object.entries(t.properties)){const o=new nn(r,t.transform(t.attributes||{},r),l,t.space);t.mustUseProperty&&t.mustUseProperty.includes(r)&&(o.mustUseProperty=!0),e[r]=o,n[jt(r)]=r,n[jt(o.attribute)]=r}return new Ke(e,n,t.space)}const br=Pe({properties:{ariaActiveDescendant:null,ariaAtomic:L,ariaAutoComplete:null,ariaBusy:L,ariaChecked:L,ariaColCount:p,ariaColIndex:p,ariaColSpan:p,ariaControls:T,ariaCurrent:null,ariaDescribedBy:T,ariaDetails:null,ariaDisabled:L,ariaDropEffect:T,ariaErrorMessage:null,ariaExpanded:L,ariaFlowTo:T,ariaGrabbed:L,ariaHasPopup:null,ariaHidden:L,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:T,ariaLevel:p,ariaLive:null,ariaModal:L,ariaMultiLine:L,ariaMultiSelectable:L,ariaOrientation:null,ariaOwns:T,ariaPlaceholder:null,ariaPosInSet:p,ariaPressed:L,ariaReadOnly:L,ariaRelevant:null,ariaRequired:L,ariaRoleDescription:T,ariaRowCount:p,ariaRowIndex:p,ariaRowSpan:p,ariaSelected:L,ariaSetSize:p,ariaSort:null,ariaValueMax:p,ariaValueMin:p,ariaValueNow:p,ariaValueText:null,role:null},transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function yr(t,e){return e in t?t[e]:e}function wr(t,e){return yr(t,e.toLowerCase())}const ml=Pe({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Ie,acceptCharset:T,accessKey:T,action:null,allow:null,allowFullScreen:k,allowPaymentRequest:k,allowUserMedia:k,alt:null,as:null,async:k,autoCapitalize:null,autoComplete:T,autoFocus:k,autoPlay:k,blocking:T,capture:null,charSet:null,checked:k,cite:null,className:T,cols:p,colSpan:null,content:null,contentEditable:L,controls:k,controlsList:T,coords:p|Ie,crossOrigin:null,data:null,dateTime:null,decoding:null,default:k,defer:k,dir:null,dirName:null,disabled:k,download:qt,draggable:L,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:k,formTarget:null,headers:T,height:p,hidden:qt,high:p,href:null,hrefLang:null,htmlFor:T,httpEquiv:T,id:null,imageSizes:null,imageSrcSet:null,inert:k,inputMode:null,integrity:null,is:null,isMap:k,itemId:null,itemProp:T,itemRef:T,itemScope:k,itemType:T,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:k,low:p,manifest:null,max:null,maxLength:p,media:null,method:null,min:null,minLength:p,multiple:k,muted:k,name:null,nonce:null,noModule:k,noValidate:k,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:k,optimum:p,pattern:null,ping:T,placeholder:null,playsInline:k,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:k,referrerPolicy:null,rel:T,required:k,reversed:k,rows:p,rowSpan:p,sandbox:T,scope:null,scoped:k,seamless:k,selected:k,shadowRootClonable:k,shadowRootDelegatesFocus:k,shadowRootMode:null,shape:null,size:p,sizes:null,slot:null,span:p,spellCheck:L,src:null,srcDoc:null,srcLang:null,srcSet:null,start:p,step:null,style:null,tabIndex:p,target:null,title:null,translate:null,type:null,typeMustMatch:k,useMap:null,value:L,width:p,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:T,axis:null,background:null,bgColor:null,border:p,borderColor:null,bottomMargin:p,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:k,declare:k,event:null,face:null,frame:null,frameBorder:null,hSpace:p,leftMargin:p,link:null,longDesc:null,lowSrc:null,marginHeight:p,marginWidth:p,noResize:k,noHref:k,noShade:k,noWrap:k,object:null,profile:null,prompt:null,rev:null,rightMargin:p,rules:null,scheme:null,scrolling:L,standby:null,summary:null,text:null,topMargin:p,valueType:null,version:null,vAlign:null,vLink:null,vSpace:p,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:k,disableRemotePlayback:k,prefix:null,property:null,results:p,security:null,unselectable:null},space:"html",transform:wr}),bl=Pe({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:V,accentHeight:p,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:p,amplitude:p,arabicForm:null,ascent:p,attributeName:null,attributeType:null,azimuth:p,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:p,by:null,calcMode:null,capHeight:p,className:T,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:p,diffuseConstant:p,direction:null,display:null,dur:null,divisor:p,dominantBaseline:null,download:k,dx:null,dy:null,edgeMode:null,editable:null,elevation:p,enableBackground:null,end:null,event:null,exponent:p,externalResourcesRequired:null,fill:null,fillOpacity:p,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Ie,g2:Ie,glyphName:Ie,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:p,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:p,horizOriginX:p,horizOriginY:p,id:null,ideographic:p,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:p,k:p,k1:p,k2:p,k3:p,k4:p,kernelMatrix:V,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:p,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:p,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:p,overlineThickness:p,paintOrder:null,panose1:null,path:null,pathLength:p,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:T,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:p,pointsAtY:p,pointsAtZ:p,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:V,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:V,rev:V,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:V,requiredFeatures:V,requiredFonts:V,requiredFormats:V,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:p,specularExponent:p,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:p,strikethroughThickness:p,string:null,stroke:null,strokeDashArray:V,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:p,strokeOpacity:p,strokeWidth:null,style:null,surfaceScale:p,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:V,tabIndex:p,tableValues:null,target:null,targetX:p,targetY:p,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:V,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:p,underlineThickness:p,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:p,values:null,vAlphabetic:p,vMathematical:p,vectorEffect:null,vHanging:p,vIdeographic:p,version:null,vertAdvY:p,vertOriginX:p,vertOriginY:p,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:p,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:yr}),kr=Pe({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()}}),Ar=Pe({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:wr}),Sr=Pe({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()}}),yl=/[A-Z]/g,Un=/-[a-z]/g,wl=/^data[-\w.:]+$/i;function kl(t,e){const n=jt(e);let r=e,l=G;if(n in t.normal)return t.property[t.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&wl.test(e)){if(e.charAt(4)==="-"){const o=e.slice(5).replace(Un,Sl);r="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=e.slice(4);if(!Un.test(o)){let a=o.replace(yl,Al);a.charAt(0)!=="-"&&(a="-"+a),e="data"+a}}l=nn}return new l(r,e)}function Al(t){return"-"+t.toLowerCase()}function Sl(t){return t.charAt(1).toUpperCase()}const xl=mr([br,ml,kr,Ar,Sr],"html"),vl=mr([br,bl,kr,Ar,Sr],"svg"),Fn="_props",Hn=new Map;function El(t,e){if(e&&(e.class=e.class||e.className,delete e.className),!t||Object.keys(t).length===0)return e||{};if(!e||Object.keys(e).length===0){const r={};return Object.keys(t).forEach(l=>r[l]=null),r}const n={};return Object.keys(t).forEach(r=>{r in e||(n[r]=null)}),Object.keys(e).forEach(r=>n[r]=e[r]),n}function _l(t){return t.length<=1?t.toLowerCase():t.split("-").map((e,n)=>n===0?e.toLowerCase():e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join("")}function Tl(t,e){const n=`${t}:${e}`;let r=Hn.get(n);return r===void 0&&(r=kl(e?vl:xl,t)||null,Hn.set(n,r)),r}function Nl(t,e,n){const r=_l(e.slice(5));n==null?delete t.dataset[r]:t.dataset[r]=String(n)}function Cl(t,e,n){e.startsWith("on")&&(!n||typeof n=="function"?t[e]=n:typeof n=="string"&&(n?t.setAttribute(e,n):t.removeAttribute(e)))}function Bn(t,e,n){Rl(n)?t.setAttribute(e,e):t.removeAttribute(e)}function st(t,e,n){try{t[e]=n}catch{dt(t,e,n,!1)}}function dt(t,e,n,r){if(n==null){t.removeAttribute(e);return}const l=String(n);if(r&&e.includes(":")){const[o]=e.split(":");o==="xlink"?t.setAttributeNS("http://www.w3.org/1999/xlink",e,l):t.setAttribute(e,l)}else t.setAttribute(e,l)}function Rl(t){return t==null||t===!1||t===""?!1:t===!0?!0:typeof t=="string"?t.toLowerCase()!=="false"&&t!=="0":!!t}function Ll(t,e,n,r){if(Ml(t,e))return;if(e==="style"){if(t.style.cssText&&(t.style.cssText=""),typeof n=="string")t.style.cssText=n;else if(n&&typeof n=="object")for(const o in n)t.style[o]!==n[o]&&(t.style[o]=n[o]);return}if(e==="key"){n!=null&&(t.key=n);return}if(e.startsWith("data-")){Nl(t,e,n);return}if(e.startsWith("on")){Cl(t,e,n);return}if((t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.tagName==="SELECT")&&(e==="value"||e==="selected"||e==="selectedIndex")){st(t,e,n);return}if(t.tagName==="INPUT"&&e==="checked"){st(t,e,n),Bn(t,e,n);return}const l=Tl(e,r);l?l.boolean||l.overloadedBoolean?Bn(t,l.attribute,n):l.mustUseProperty&&!r?st(t,l.property,n):dt(t,l.attribute,n,r):e.startsWith("aria-")||e==="role"?dt(t,e,n,r):e in t||t[e]!==void 0?st(t,e,n):dt(t,e,n,r)}function Ml(t,e){return document.activeElement===t?["selectionStart","selectionEnd","selectionDirection"].includes(e):!!(e==="scrollTop"||e==="scrollLeft"||t instanceof HTMLMediaElement&&["currentTime","paused","playbackRate","volume"].includes(e))}function Ol(t){return/^[a-zA-Z_:][\w\-:.]*$/.test(t)&&!t.includes("<")&&!t.includes(">")&&!t.includes('"')&&!t.includes("'")}function rn(t,e,n){const r=t[Fn]||{},l=El(r,e);t[Fn]=e||{},Il(t,l,e,n)}function Il(t,e,n,r){for(const l in e)Ol(l)&&Ll(t,l,e[l],r);e&&typeof e.ref=="function"&&window.requestAnimationFrame(()=>e.ref(t))}function Pl(t,...e){return xr(e)}function xr(t){const e=[],n=r=>{r!=null&&r!==""&&r!==!1&&e.push(typeof r=="function"||typeof r=="object"?r:`${r}`)};return t&&t.forEach(r=>{Array.isArray(r)?r.forEach(l=>n(l)):n(r)}),e}const Ye={};let jn=0;const Dl=500,$l=1e3;function Wl(){if(!(Object.keys(Ye).length<=$l))for(const[t,e]of Object.entries(Ye))e.isConnected||delete Ye[t]}function zl(t,e,...n){const r=xr(n);if(typeof t=="string")return{tag:t,props:e,children:r};if(Array.isArray(t))return t;if(t===void 0&&n)return r;if(Object.getPrototypeOf(t).__isAppRunComponent)return{tag:t,props:e,children:r};if(typeof t=="function")return t(e,r);throw new Error(`Unknown tag in vdom ${t}`)}const Ul=(t,e,n={})=>{if(e==null||e===!1)return;const r=typeof t=="string"&&t?document.getElementById(t)||document.querySelector(t):t;e=gt(e,n),Fl(r,e,n)};function Fl(t,e,n={}){if(e==null||e===!1||(e=ht(e,n),!t))return;const r=t.nodeName==="SVG";Array.isArray(e)?Vt(t,e,r):Vt(t,[e],r)}function Hl(t,e){const n=t.nodeName,r=`${e.tag||""}`;return n.toUpperCase()===r.toUpperCase()}function $t(t,e,n){if(n=n||e.tag==="svg",!Hl(t,e)){t.parentNode.replaceChild(mt(e,n),t);return}Vt(t,e.children,n),rn(t,e.props,n)}function Vt(t,e,n){var i,h;const r=((i=t.childNodes)==null?void 0:i.length)||0,l=(e==null?void 0:e.length)||0,o=Math.min(r,l);for(let d=0;d<o;d++){const u=e[d],b=t.childNodes[d];if(typeof u=="string")b.textContent!==u&&(b.nodeType===3?b.nodeValue=u:t.replaceChild(Yt(u),b));else if(u instanceof HTMLElement||u instanceof SVGElement)t.insertBefore(u,b);else{const g=u.props&&u.props.key;if(g)if(b.key===g)$t(t.childNodes[d],u,n);else{const x=Ye[g];x?(t.insertBefore(x,b),$t(t.childNodes[d],u,n)):t.replaceChild(mt(u,n),b)}else $t(t.childNodes[d],u,n)}}let a=((h=t.childNodes)==null?void 0:h.length)||0;for(;a>o;)t.removeChild(t.lastChild),a--;if(l>o){const d=document.createDocumentFragment();for(let u=o;u<e.length;u++)d.appendChild(mt(e[u],n));t.appendChild(d)}}const qn=t=>{const e=document.createElement("section");return e.insertAdjacentHTML("afterbegin",t),Array.from(e.children)};function Yt(t){if((t==null?void 0:t.indexOf("_html:"))===0){const e=document.createElement("div");return e.insertAdjacentHTML("afterbegin",t.substring(6)),e}else return document.createTextNode(t??"")}function mt(t,e){if(t instanceof HTMLElement||t instanceof SVGElement)return t;if(typeof t=="string")return Yt(t);if(!t.tag||typeof t.tag=="function")return Yt(JSON.stringify(t));e=e||t.tag==="svg";const n=e?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag);return rn(n,t.props,e),t.children&&t.children.forEach(r=>n.appendChild(mt(r,e))),t.props&&t.props.key!==void 0&&(n.key=t.props.key,Ye[t.props.key]=n,++jn>=Dl&&(Wl(),jn=0)),n}function Bl(t,e,n){const{tag:r,props:l,children:o}=t;let a=`_${n}`,i=l&&l.id;i?a=i:i=`_${n}${Date.now()}`;let h="section";l&&l.as&&(h=l.as,delete l.as),e.__componentCache||(e.__componentCache={});let d=e.__componentCache[a];if(!d||!(d instanceof r)||!d.element){const u=document.createElement(h);d=e.__componentCache[a]=new r({...l,children:o}).mount(u,{render:!0})}else d.renderState(d.state);if(d.mounted){const u=d.mounted(l,o,d.state);typeof u<"u"&&d.setState(u)}return rn(d.element,l,!1),d.element}function ht(t,e,n=0){var l;if(typeof t=="string")return t;if(Array.isArray(t))return t.map(o=>ht(o,e,n++));let r=t;if(t&&typeof t.tag=="function"&&Object.getPrototypeOf(t.tag).__isAppRunComponent&&(r=Bl(t,e,n)),r&&Array.isArray(r.children)){const o=(l=r.props)==null?void 0:l._component;if(o){let a=0;r.children=r.children.map(i=>ht(i,o,a++))}else r.children=r.children.map(a=>ht(a,e,n++))}return r}const jl=(t,e={})=>class extends HTMLElement{constructor(){super()}get component(){return this._component}get state(){return this._component.state}static get observedAttributes(){return(e.observedAttributes||[]).map(r=>r.toLowerCase())}connectedCallback(){if(this.isConnected&&!this._component){const r=e||{};this._shadowRoot=r.shadow?this.attachShadow({mode:"open"}):this;const l=r.observedAttributes||[],o=l.reduce((i,h)=>{const d=h.toLowerCase();return d!==h&&(i[d]=h),i},{});this._attrMap=i=>o[i]||i;const a={};Array.from(this.attributes).forEach(i=>a[this._attrMap(i.name)]=i.value),l.forEach(i=>{this[i]!==void 0&&(a[i]=this[i]),Object.defineProperty(this,i,{get(){return a[i]},set(h){this.attributeChangedCallback(i,a[i],h)},configurable:!0,enumerable:!0})}),requestAnimationFrame(()=>{const i=this.children?Array.from(this.children):[];if(this._component=new t({...a,children:i}).mount(this._shadowRoot,r),this._component._props=a,this._component.dispatchEvent=this.dispatchEvent.bind(this),this._component.mounted){const h=this._component.mounted(a,i,this._component.state);typeof h<"u"&&(this._component.state=h)}this.on=this._component.on.bind(this._component),this.run=this._component.run.bind(this._component),r.render!==!1&&this._component.run(".")})}}disconnectedCallback(){var r,l,o,a;(l=(r=this._component)==null?void 0:r.unload)==null||l.call(r),(a=(o=this._component)==null?void 0:o.unmount)==null||a.call(o),this._component=null}attributeChangedCallback(r,l,o){if(this._component){const a=this._attrMap(r);this._component._props[a]=o,this._component.run("attributeChanged",a,l,o),o!==l&&e.render!==!1&&window.requestAnimationFrame(()=>{this._component.run(".")})}}},vr=(t,e,n)=>{typeof customElements<"u"&&customElements.define(t,jl(e,n))},Zt={meta:new WeakMap,defineMetadata(t,e,n){this.meta.has(n)||this.meta.set(n,{}),this.meta.get(n)[t]=e},getMetadataKeys(t){return t=Object.getPrototypeOf(t),this.meta.get(t)?Object.keys(this.meta.get(t)):[]},getMetadata(t,e){return e=Object.getPrototypeOf(e),this.meta.get(e)?this.meta.get(e)[t]:null}};function ql(t,e={}){return function(n,r){const l=t?t.toString():r;Zt.defineMetadata(`apprun-update:${l}`,{name:l,key:r,options:e},n)}}function Gl(t,e){return function(r){return vr(t,r,e),r}}const Gn=t=>t,$=_;class Se{renderState(e,n=null){if(!this.view)return;let r=n||this.view(e);if($.debug&&$.run("debug",{component:this,_:r?".":"-",state:e,vdom:r,el:this.element}),typeof document!="object")return;const l=typeof this.element=="string"&&this.element?dl(this.element)||ul(this.element):this.element;if(!l){console.warn(`Component element not found: ${this.element}`);return}const o="_c";this.unload?(l._component!==this||l.getAttribute(o)!==this.tracking_id)&&(this.tracking_id=new Date().valueOf().toString(),l.setAttribute(o,this.tracking_id),typeof MutationObserver<"u"&&(this.observer||(this.observer=new MutationObserver(a=>{(a[0].oldValue===this.tracking_id||!document.body.contains(l))&&(this.unload(this.state),this.observer.disconnect(),this.observer=null)})),this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:[o]}))):l.removeAttribute&&l.removeAttribute(o),l._component=this,!n&&r&&(r=gt(r,this),this.options.transition&&document&&document.startViewTransition?document.startViewTransition(()=>$.render(l,r,this)):$.render(l,r,this)),this.rendered&&this.rendered(this.state)}setState(e,n={render:!0,history:!1}){const r=async o=>{try{for(;;){const{value:a,done:i}=await o.next();if(i)break;this.setState(a,n)}}catch(a){console.error("Error in async iterator:",a)}},l=e;if(l!=null&&l[Symbol.asyncIterator]){this.setState(r(l[Symbol.asyncIterator]()),n);return}else if(l!=null&&l[Symbol.iterator]&&typeof l.next=="function"){for(const o of l)this.setState(o,n);return}else if(e&&e instanceof Promise)Promise.resolve(e).then(o=>{this.setState(o,n),this._state=e});else{if(this._state=e,e==null)return;this.state=e,n.render!==!1&&(n.transition&&document&&document.startViewTransition?document.startViewTransition(()=>this.renderState(e)):this.renderState(e)),n.history!==!1&&this.enable_history&&(this._history=[...this._history,e],this._history_idx=this._history.length-1),typeof n.callback=="function"&&n.callback(this.state)}}constructor(e,n,r,l){this.state=e,this.view=n,this.update=r,this.options=l,this._app=new fr,this._actions=[],this._global_events=[],this._history=[],this._history_idx=-1,this._history_prev=()=>{this._history_idx--,this._history_idx>=0?this.setState(this._history[this._history_idx],{render:!0,history:!1}):this._history_idx=0},this._history_next=()=>{this._history_idx++,this._history_idx<this._history.length?this.setState(this._history[this._history_idx],{render:!0,history:!1}):this._history_idx=this._history.length-1},this.start=(o=null,a)=>{if(this.mount(o,{render:!0,...a}),this.mounted&&typeof this.mounted=="function"){const i=this.mounted({},[],this.state);typeof i<"u"&&this.setState(i)}return this}}mount(e=null,n){var r;return console.assert(!this.element,"Component already mounted."),this.options=n={...this.options,...n},this.element=e,this.global_event=n.global_event,this.enable_history=!!n.history,this.enable_history&&(this.on(n.history.prev||"history-prev",this._history_prev),this.on(n.history.next||"history-next",this._history_next)),n.route&&(this.update=this.update||{},this.update[n.route]||(this.update[n.route]=Gn)),this.add_actions(),this.state=this.state??this.model??{},typeof this.state=="function"&&(this.state=this.state()),this.setState(this.state,{render:!!n.render,history:!0}),$.debug&&((r=$.find("debug-create-component"))!=null&&r.length)&&$.run("debug-create-component",this),this}is_global_event(e){return e&&(this.global_event||this._global_events.indexOf(e)>=0||e.startsWith("#")||e.startsWith("/")||e.startsWith("@"))}add_action(e,n,r={}){if(!n||typeof n!="function"){console.warn(`Component action for '${e}' is not a valid function:`,n);return}r.global&&this._global_events.push(e),this.on(e,(...l)=>{$.debug&&$.run("debug",{component:this,_:">",event:e,p:l,current_state:this.state,options:r});try{const o=n(this.state,...l);$.debug&&$.run("debug",{component:this,_:"<",event:e,p:l,newState:o,state:this.state,options:r}),this.setState(o,r)}catch(o){console.error(`Error in component action '${e}':`,o),$.debug&&$.run("debug",{component:this,_:"!",event:e,p:l,error:o,state:this.state,options:r})}},r)}add_actions(){const e=this.update||{};Zt.getMetadataKeys(this).forEach(r=>{if(r.startsWith("apprun-update:")){const l=Zt.getMetadata(r,this);e[l.name]=[this[l.key].bind(this),l.options]}});const n={};Array.isArray(e)?e.forEach(r=>{const[l,o,a]=r;l.toString().split(",").forEach(h=>n[h.trim()]=[o,a])}):Object.keys(e).forEach(r=>{const l=e[r];(typeof l=="function"||Array.isArray(l))&&r.split(",").forEach(o=>n[o.trim()]=l)}),n["."]||(n["."]=Gn),Object.keys(n).forEach(r=>{const l=n[r];typeof l=="function"?this.add_action(r,l):Array.isArray(l)&&this.add_action(r,l[0],l[1])})}run(e,...n){if(this.state instanceof Promise)return Promise.resolve(this.state).then(r=>{this.state=r,this.run(e,...n)});{const r=e.toString();return this.is_global_event(r)?$.run(r,...n):this._app.run(r,...n)}}on(e,n,r){const l=e.toString();return this._actions.push({name:l,fn:n}),this.is_global_event(l)?$.on(l,n,r):this._app.on(l,n,r)}runAsync(e,...n){const r=e.toString();return this.is_global_event(r)?$.runAsync(r,...n):this._app.runAsync(r,...n)}query(e,...n){return console.warn("component.query() is deprecated. Use component.runAsync() instead."),this.runAsync(e,...n)}unmount(){var e;(e=this.observer)==null||e.disconnect(),this._actions.forEach(n=>{const{name:r,fn:l}=n;this.is_global_event(r)?$.off(r,l):this._app.off(r,l)})}}Se.__isAppRunComponent=!0;function Vl(t){return t?t.startsWith("#/")?t.substring(2).split("/"):t.startsWith("#")||t.startsWith("/")?t.substring(1).split("/"):t.split("/"):[]}function Yl(t){return!t||t==="/"||t==="#"||t==="#/"?t:t.endsWith("/")?t.slice(0,-1):t}function Zl(t){const e=t.filter(Boolean);e.length>11&&console.warn(`Deep route hierarchy detected: ${e.join("/")} (${e.length} levels)`)}function Xl(t,e){if(!e||e==="/"||e==="")return t;const n=e.startsWith("/")?e:"/"+e;if(t.startsWith(n)){const r=t.substring(n.length);return r.startsWith("/")?r:"/"+r}return t}function Kl(t,e){const n=[];for(let r=t.length;r>0;r--){const l=t.slice(0,r);let o="";switch(e){case"path":o="/"+l.join("/");break;case"hash":o="#"+l.join("/");break;case"hash-slash":o="#/"+l.join("/");break;case"non-prefixed":o=l.join("/");break}n.push(o)}return n}function Ql(t,e){for(let n=0;n<t.length;n++){const r=t[n],l=_.find(r);if(l&&l.length>0){const o=t.length-n,a=e.slice(o);return{eventName:r,parameters:a}}}return null}function Vn(){const t=_.find("#");if(t&&t.length>0){_.run("#"),_.run(de,"#");return}const e=_.find("/");if(e&&e.length>0){_.run("/"),_.run(de,"/");return}const n=_.find("#/");if(n&&n.length>0){_.run("#/"),_.run(de,"#/");return}console.warn("No subscribers for event: "),_.run(Xe,""),_.run(de,"")}function Jl(t){if(!t){Vn();return}t=Yl(t);const e=_.basePath;e&&(t=Xl(t,e));const n=Vl(t);Zl(n);let r;t.startsWith("#/")?r="hash-slash":t.startsWith("#")?r="hash":t.startsWith("/")?r="path":r="non-prefixed";const l=Kl(n,r),o=Ql(l,n);if(o)eo(o.eventName,...o.parameters);else if(l.length>0){const a=l[l.length-1];console.warn(`No subscribers for event: ${a}`),_.run(Xe,t),_.run(de,t)}else Vn()}const eo=(t,...e)=>{if(!t||t===de||t===Xe)return;const n=_.find(t);!n||n.length===0?(console.warn(`No subscribers for event: ${t}`),_.run(Xe,t,...e)):_.run(t,...e),_.run(de,t,...e)},de="//",Xe="///",Oe=t=>{_.lastUrl!==t&&(_.lastUrl=t,Jl(t))};function Yn(t){return t&&typeof t=="object"&&typeof t.mount=="function"}function Xt(t){return typeof t=="function"&&t.prototype&&t.prototype.constructor===t&&(t.prototype.mount!==void 0||t.prototype.state!==void 0||t.prototype.view!==void 0)}function Er(t){return typeof t=="function"&&!Xt(t)}async function to(t,e=3){let n=t,r=0;for(;Er(n)&&r<e;)try{const l=await n();if(l===n)break;n=l,r++}catch(l){console.error(`Error executing component function: ${l}`);break}return n}const no=async(t,e)=>{for(const[n,r]of Object.entries(e)){if(!r||!n){console.error(`Invalid component configuration: component=${r}, route=${n}`);continue}if(Yn(r)){const l={route:n};r.mount(t,l);continue}if(Xt(r)){const l=new r,o={route:n};l.mount(t,o);continue}if(Er(r)){let l=await to(r);if(Yn(l)){const o={route:n};l.mount(t,o);continue}if(Xt(l)){const o=new l,a={route:n};o.mount(t,a);continue}_.on(n,(...o)=>{const a=r(...o);if(typeof t=="string"&&(t=document.querySelector(t),!t)){console.error(`Element not found: ${t}`);return}return _.render(t,a)});continue}console.error("Invalid component: component must be a class, instance, or function that returns a class/instance")}},s=_;if(!s.start){s.version=pr,s.h=s.createElement=zl,s.render=Ul,s.Fragment=Pl,s.webComponent=vr,s.safeHTML=qn,s.start=(e,n,r,l,o)=>{const a={render:!0,global_event:!0,...o},i=new Se(n,r,l);return o&&o.rendered&&(i.rendered=o.rendered),o&&o.mounted&&(i.mounted=o.mounted),i.start(e,a),i},s.query=s.query||s.runAsync;const t=e=>{};if(s.on("/",t),s.on("debug",e=>t),s.on(de,t),s.on(Xe,t),s.route=Oe,s.on("route",e=>s.route&&s.route(e)),typeof document=="object"&&document.addEventListener("DOMContentLoaded",()=>{const e=document.body.hasAttribute("apprun-no-init")||s["no-init-route"]||!1,n=s.find("#")||s.find("#/")||!1;window.addEventListener("hashchange",()=>Oe(location.hash)),window.addEventListener("popstate",()=>Oe(location.pathname)),n?!e&&Oe(location.hash):(!e&&(()=>{const r=s.basePath||"";let l=location.pathname;r&&l.startsWith(r)&&(l=l.substring(r.length),l.startsWith("/")||(l="/"+l)),Oe(l)})(),document.body.addEventListener("click",r=>{const l=r.target;if(!l)return;const o=l.tagName==="A"?l:l.closest("a");if(o&&o.origin===location.origin&&o.pathname){r.preventDefault();const i=(s.basePath||"")+o.pathname;history.pushState(null,"",i),Oe(o.pathname)}}))}),typeof window=="object"){const e=window;e.Component=Se,e._React=e.React,e.React=s,e.on=ql,e.customElement=Gl,e.safeHTML=qn}s.use_render=(e,n=0)=>{n===0?s.render=(r,l)=>e(l,r):s.render=(r,l)=>e(r,l)},s.use_react=(e,n)=>{if(!e||!n){console.error("AppRun use_react: React and ReactDOM parameters are required");return}if(typeof e.createElement!="function"){console.error("AppRun use_react: Invalid React object - createElement method not found");return}if(!e.Fragment){console.error("AppRun use_react: Invalid React object - Fragment not found");return}if(s.h=s.createElement=e.createElement,s.Fragment=e.Fragment,e.version&&e.version.startsWith("18")){if(!n.createRoot||typeof n.createRoot!="function"){console.error("AppRun use_react: ReactDOM.createRoot not found in React 18+");return}s.render=(r,l)=>{!r||l===void 0||(r._root||(r._root=n.createRoot(r)),r._root.render(l))}}else{if(!n.render||typeof n.render!="function"){console.error("AppRun use_react: ReactDOM.render not found in legacy React");return}s.render=(r,l)=>n.render(l,r)}},s.addComponents=no}const ro=()=>s.h("div",{id:"main"},s.h("div",{id:"pages"})),lo="/api";async function Y(t,e={}){const n=`${lo}${t}`;try{const r=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!r.ok){let l=`HTTP ${r.status}: ${r.statusText}`;try{const o=await r.json();o.error&&(l=o.error,o.code&&(l+=` (${o.code})`))}catch{}throw new Error(l)}return r}catch(r){throw console.error(`API request failed for ${t}:`,r),r}}async function oo(){return(await Y("/worlds")).json()}async function so(t){if(!t)throw new Error("World name is required");return(await Y(`/worlds/${encodeURIComponent(t)}`)).json()}async function io(t){if(!t||!t.name)throw new Error("World data with name is required");const e={name:t.name,description:t.description||"",turnLimit:t.turnLimit??5,agents:t.agents??[]};return(await Y("/worlds",{method:"POST",body:JSON.stringify(e)})).json()}async function ao(t,e){if(!t||!e)throw new Error("World name and update data are required");return(await Y(`/worlds/${encodeURIComponent(t)}`,{method:"PATCH",body:JSON.stringify(e)})).json()}async function co(t){if(!t)throw new Error("World name is required");await Y(`/worlds/${encodeURIComponent(t)}`,{method:"DELETE"})}async function uo(t){if(!t)throw new Error("World name is required");return(await Y(`/worlds/${encodeURIComponent(t)}/agents`)).json()}async function ho(t,e){if(!t||!e)throw new Error("Both world name and agent name are required");return(await Y(`/worlds/${encodeURIComponent(t)}/agents/${encodeURIComponent(e)}`)).json()}async function po(t,e){if(!t||!e)throw new Error("World name and agent data are required");return(await Y(`/worlds/${encodeURIComponent(t)}/agents`,{method:"POST",body:JSON.stringify(e)})).json()}async function fo(t,e,n){if(!t||!e||!n)throw new Error("World name, agent name, and update data are required");return(await Y(`/worlds/${encodeURIComponent(t)}/agents/${encodeURIComponent(e)}`,{method:"PATCH",body:JSON.stringify(n)})).json()}async function go(t,e){if(!t||!e)throw new Error("World name and agent name are required");await Y(`/worlds/${encodeURIComponent(t)}/agents/${encodeURIComponent(e)}`,{method:"DELETE"})}async function mo(t,e){if(!t||!e)throw new Error("World name and agent name are required");await Y(`/worlds/${encodeURIComponent(t)}/agents/${encodeURIComponent(e)}/memory`,{method:"DELETE"})}const ne={apiRequest:Y,getWorlds:oo,getWorld:so,createWorld:io,updateWorld:ao,deleteWorld:co,getAgents:uo,getAgent:ho,createAgent:po,updateAgent:fo,deleteAgent:go,clearAgentMemory:mo},bo=t=>({mode:t.mode||"create",world:t.world||_r(),parentComponent:t.parentComponent,loading:!1}),_r=()=>({name:"",description:"",turnLimit:5}),Zn=async function*(t){if(!t.world.name.trim()){yield{...t,error:"World name is required"};return}yield{...t,loading:!0,error:null};try{t.mode==="create"?await ne.createWorld(t.world):await ne.updateWorld(t.world.name,t.world);const e=t.mode==="create"?"World created successfully!":"World updated successfully!";yield{...t,loading:!1,successMessage:e},setTimeout(()=>{t.mode==="create"?window.location.href="/World/"+encodeURIComponent(t.world.name):t.parentComponent.run("world-saved")},2e3)}catch(e){yield{...t,loading:!1,error:e.message||"Failed to save world"}}},Xn=async function*(t){yield{...t,loading:!0,error:null};try{await ne.deleteWorld(t.world.name),yield{...t,loading:!1,successMessage:"World deleted successfully!"},setTimeout(()=>{t.parentComponent.run("world-deleted")},2e3)}catch(e){yield{...t,loading:!1,error:e.message||"Failed to delete world"}}},ke=t=>{t!=null&&t.parentComponent&&typeof t.parentComponent.run=="function"?t.parentComponent.run("close-world-edit"):s.run("close-world-edit")};class Tr extends Se{constructor(){super(...arguments);A(this,"mounted",n=>bo(n));A(this,"state",{mode:"create",world:_r(),parentComponent:void 0,loading:!1,error:null,successMessage:null});A(this,"view",n=>{if(n.successMessage)return s.h("div",{className:"modal-backdrop",$onclick:ke},s.h("div",{className:"modal-content",onclick:a=>a.stopPropagation()},s.h("div",{className:"modal-header"},s.h("h2",{className:"modal-title"},"Success!"),s.h("button",{className:"modal-close-btn",$onclick:ke,title:"Close"},"×")),s.h("div",{className:"modal-body"},s.h("div",{className:"success-message"},s.h("p",{style:"font-size: 1rem;"},n.successMessage),s.h("div",{className:"loading-spinner",style:"font-size: 0.9rem;"},n.mode==="create"?"Redirecting to new world...":n.mode==="delete"?"Redirecting to home...":"Closing...")))));const r=n.mode==="edit",l=n.mode==="delete";let o;return l?o=`Delete ${n.world.name||"World"}`:r?o=`Edit ${n.world.name||"World"}`:o="Create New World",s.h("div",{className:"modal-backdrop",$onclick:ke},s.h("div",{className:"modal-content",onclick:a=>a.stopPropagation()},s.h("div",{className:"modal-header"},s.h("h2",{className:"modal-title"},o),s.h("button",{className:"modal-close-btn",$onclick:ke,title:"Close"},"×")),s.h("div",{className:"modal-body"},n.error&&s.h("div",{className:"error-message"},n.error),l?s.h("div",{className:"delete-confirmation"},s.h("p",{style:"font-size: 1rem;"},"Are you sure you want to delete ",s.h("span",{style:"font-size: 1.2rem;"},'"',n.world.name,'"'),"?"),s.h("p",{style:"font-size: 1rem;"},"This action cannot be undone and will delete all agents and messages in this world.")):s.h("form",{className:"world-form"},s.h("div",{className:"form-section"},s.h("div",{className:"form-group"},s.h("label",{htmlFor:"world-name"},"World Name *"),s.h("input",{id:"world-name",type:"text",className:"form-input",placeholder:"Enter world name",value:n.world.name,$bind:"world.name",disabled:n.loading||r})),s.h("div",{className:"form-group"},s.h("label",{htmlFor:"world-description"},"Description"),s.h("input",{id:"world-description",type:"text",className:"form-input",placeholder:"Brief description of the world",value:n.world.description,$bind:"world.description",disabled:n.loading})),s.h("div",{className:"form-group"},s.h("label",{htmlFor:"world-turn-limit"},"Turn Limit"),s.h("input",{id:"world-turn-limit",type:"number",className:"form-input",placeholder:"5",min:"1",max:"50",value:n.world.turnLimit,$bind:"world.turnLimit",disabled:n.loading}))))),s.h("div",{className:"modal-footer"},s.h("div",{className:"modal-actions"},l?s.h("div",{className:"modal-primary-actions",style:"margin-left: auto;"},s.h("button",{className:"btn btn-secondary",$onclick:ke,disabled:n.loading},"Cancel"),s.h("button",{className:"btn btn-danger",$onclick:[Xn],disabled:n.loading},n.loading?"Deleting...":"Delete")):r?s.h(s.Fragment,null,s.h("button",{className:"btn btn-danger",$onclick:[Xn],disabled:n.loading,title:"Delete world"},n.loading?"Deleting...":"Delete"),s.h("div",{className:"modal-primary-actions"},s.h("button",{className:"btn btn-secondary",$onclick:ke,disabled:n.loading},"Cancel"),s.h("button",{className:"btn btn-primary",$onclick:[Zn],disabled:n.loading||!n.world.name.trim()},n.loading?"Saving...":"Update"))):s.h("div",{className:"modal-primary-actions",style:"margin-left: auto;"},s.h("button",{className:"btn btn-secondary",$onclick:ke,disabled:n.loading},"Cancel"),s.h("button",{className:"btn btn-primary",$onclick:[Zn],disabled:n.loading||!n.world.name.trim()},n.loading?"Saving...":"Create"))))))})}}class yo extends Se{constructor(){super(...arguments);A(this,"state",async()=>({worlds:await ne.getWorlds(),currentIndex:0,loading:!1,error:null,showWorldEdit:!1,worldEditMode:"create",selectedWorldForEdit:null}));A(this,"view",n=>{var r,l,o,a;return n.loading?s.h("div",{class:"container"},s.h("div",{class:"row"},s.h("div",{class:"col"},s.h("div",{class:"loading-message"},"Loading worlds...")))):n.error?s.h("div",{class:"container"},s.h("div",{class:"row"},s.h("div",{class:"col"},s.h("div",{class:"error-message"},s.h("h3",null,"Error loading worlds"),s.h("p",null,n.error),s.h("button",{class:"btn btn-primary",$onclick:"/"},"Retry"))))):n.worlds.length===0?s.h("div",{class:"container"},s.h("div",{class:"row"},s.h("div",{class:"col"},s.h("div",{class:"no-worlds-message"},s.h("h3",null,"No worlds found"),s.h("p",null,"Create your first world to get started!"),s.h("button",{class:"btn btn-primary",$onclick:"open-world-create"},"Create World"))))):s.h("div",{class:"container"},s.h("div",{class:"row"},s.h("div",{class:"col banner-col"},s.h("h1",{class:"banner-title"},"PICK YOUR WORLD"))),s.h("div",{class:"row carousel-row"},s.h("div",{class:"col"},s.h("div",{class:"world-carousel"},s.h("button",{class:"btn carousel-arrow",$onclick:"prev-world"},"‹"),s.h("div",{class:"world-cards"},n.worlds.map((i,h)=>{const d=h===n.currentIndex;let u=!1;return n.worlds.length<=3?u=!0:u=Math.abs(h-n.currentIndex)<=1,u?s.h("button",{class:`btn world-card-btn ${d?"btn-primary center":"btn-secondary side"}`,$onclick:d?["enter-world",i]:["select-world",i]},s.h("span",{class:"world-name"},i.name)):null})),s.h("button",{class:"btn carousel-arrow",$onclick:"next-world"},"›")),s.h("div",{class:"world-indicators"},n.worlds.map((i,h)=>s.h("button",{class:`world-dot ${h===n.currentIndex?"active":""}`,$onclick:["select-world",i],title:i.name}))))),s.h("div",{class:"row"},s.h("div",{class:"col"},s.h("div",{class:"description-card"},s.h("h4",{class:"description-title"},((r=n.worlds[n.currentIndex])==null?void 0:r.name)||"Unknown World"),s.h("p",{class:"description-text"},((l=n.worlds[n.currentIndex])==null?void 0:l.description)||"No description available"),s.h("div",{class:"action-buttons"},s.h("button",{class:"btn add-world-btn",title:"Add New World",$onclick:"open-world-create"},s.h("span",{class:"plus-icon"},"+")),s.h("a",{href:"/World/"+(((o=n.worlds[n.currentIndex])==null?void 0:o.name)||"")},s.h("button",{class:"btn btn-primary enter-btn"},"Enter ",((a=n.worlds[n.currentIndex])==null?void 0:a.name)||"World")),s.h("button",{class:"btn add-world-btn delete-world-btn",title:"Delete World",$onclick:["open-world-delete",n.worlds[n.currentIndex]]},s.h("span",{class:"plus-icon"},"×")))))),n.showWorldEdit&&s.h(Tr,{world:n.selectedWorldForEdit,mode:n.worldEditMode,parentComponent:this}))});A(this,"update",{"prev-world":n=>({...n,currentIndex:n.currentIndex>0?n.currentIndex-1:n.worlds.length-1}),"next-world":n=>({...n,currentIndex:n.currentIndex<n.worlds.length-1?n.currentIndex+1:0}),"select-world":(n,r)=>{const l=n.worlds.findIndex(o=>o.name===r.name);return{...n,currentIndex:l>=0?l:n.currentIndex}},"enter-world":(n,r)=>{window.location.href="/World/"+r.name},"open-world-create":n=>({...n,showWorldEdit:!0,worldEditMode:"create",selectedWorldForEdit:null}),"open-world-edit":(n,r)=>({...n,showWorldEdit:!0,worldEditMode:"edit",selectedWorldForEdit:r}),"open-world-delete":(n,r)=>({...n,showWorldEdit:!0,worldEditMode:"delete",selectedWorldForEdit:r}),"close-world-edit":n=>({...n,showWorldEdit:!1}),"world-saved":n=>{location.reload()},"world-deleted":n=>{location.reload()}})}}function ln(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Ee=ln();function Nr(t){Ee=t}var Ze={exec:()=>null};function E(t,e=""){let n=typeof t=="string"?t:t.source,r={replace:(l,o)=>{let a=typeof o=="string"?o:o.source;return a=a.replace(H.caret,"$1"),n=n.replace(l,a),r},getRegex:()=>new RegExp(n,e)};return r}var H={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},wo=/^(?:[ \t]*(?:\n|$))+/,ko=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Ao=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Qe=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,So=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,on=/(?:[*+-]|\d{1,9}[.)])/,Cr=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Rr=E(Cr).replace(/bull/g,on).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),xo=E(Cr).replace(/bull/g,on).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),sn=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,vo=/^[^\n]+/,an=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Eo=E(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",an).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),_o=E(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,on).getRegex(),kt="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",cn=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,To=E("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",cn).replace("tag",kt).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Lr=E(sn).replace("hr",Qe).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kt).getRegex(),No=E(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Lr).getRegex(),un={blockquote:No,code:ko,def:Eo,fences:Ao,heading:So,hr:Qe,html:To,lheading:Rr,list:_o,newline:wo,paragraph:Lr,table:Ze,text:vo},Kn=E("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Qe).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kt).getRegex(),Co={...un,lheading:xo,table:Kn,paragraph:E(sn).replace("hr",Qe).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Kn).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",kt).getRegex()},Ro={...un,html:E(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",cn).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Ze,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:E(sn).replace("hr",Qe).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Rr).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Lo=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Mo=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Mr=/^( {2,}|\\)\n(?!\s*$)/,Oo=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,At=/[\p{P}\p{S}]/u,dn=/[\s\p{P}\p{S}]/u,Or=/[^\s\p{P}\p{S}]/u,Io=E(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,dn).getRegex(),Ir=/(?!~)[\p{P}\p{S}]/u,Po=/(?!~)[\s\p{P}\p{S}]/u,Do=/(?:[^\s\p{P}\p{S}]|~)/u,$o=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<(?! )[^<>]*?>/g,Pr=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Wo=E(Pr,"u").replace(/punct/g,At).getRegex(),zo=E(Pr,"u").replace(/punct/g,Ir).getRegex(),Dr="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Uo=E(Dr,"gu").replace(/notPunctSpace/g,Or).replace(/punctSpace/g,dn).replace(/punct/g,At).getRegex(),Fo=E(Dr,"gu").replace(/notPunctSpace/g,Do).replace(/punctSpace/g,Po).replace(/punct/g,Ir).getRegex(),Ho=E("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Or).replace(/punctSpace/g,dn).replace(/punct/g,At).getRegex(),Bo=E(/\\(punct)/,"gu").replace(/punct/g,At).getRegex(),jo=E(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),qo=E(cn).replace("(?:-->|$)","-->").getRegex(),Go=E("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",qo).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),bt=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Vo=E(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",bt).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),$r=E(/^!?\[(label)\]\[(ref)\]/).replace("label",bt).replace("ref",an).getRegex(),Wr=E(/^!?\[(ref)\](?:\[\])?/).replace("ref",an).getRegex(),Yo=E("reflink|nolink(?!\\()","g").replace("reflink",$r).replace("nolink",Wr).getRegex(),hn={_backpedal:Ze,anyPunctuation:Bo,autolink:jo,blockSkip:$o,br:Mr,code:Mo,del:Ze,emStrongLDelim:Wo,emStrongRDelimAst:Uo,emStrongRDelimUnd:Ho,escape:Lo,link:Vo,nolink:Wr,punctuation:Io,reflink:$r,reflinkSearch:Yo,tag:Go,text:Oo,url:Ze},Zo={...hn,link:E(/^!?\[(label)\]\((.*?)\)/).replace("label",bt).getRegex(),reflink:E(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",bt).getRegex()},Kt={...hn,emStrongRDelimAst:Fo,emStrongLDelim:zo,url:E(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Xo={...Kt,br:E(Mr).replace("{2,}","*").getRegex(),text:E(Kt.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},it={normal:un,gfm:Co,pedantic:Ro},Fe={normal:hn,gfm:Kt,breaks:Xo,pedantic:Zo},Ko={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Qn=t=>Ko[t];function ee(t,e){if(e){if(H.escapeTest.test(t))return t.replace(H.escapeReplace,Qn)}else if(H.escapeTestNoEncode.test(t))return t.replace(H.escapeReplaceNoEncode,Qn);return t}function Jn(t){try{t=encodeURI(t).replace(H.percentDecode,"%")}catch{return null}return t}function er(t,e){var o;let n=t.replace(H.findPipe,(a,i,h)=>{let d=!1,u=i;for(;--u>=0&&h[u]==="\\";)d=!d;return d?"|":" |"}),r=n.split(H.splitPipe),l=0;if(r[0].trim()||r.shift(),r.length>0&&!((o=r.at(-1))!=null&&o.trim())&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;l<r.length;l++)r[l]=r[l].trim().replace(H.slashPipe,"|");return r}function He(t,e,n){let r=t.length;if(r===0)return"";let l=0;for(;l<r&&t.charAt(r-l-1)===e;)l++;return t.slice(0,r-l)}function Qo(t,e){if(t.indexOf(e[1])===-1)return-1;let n=0;for(let r=0;r<t.length;r++)if(t[r]==="\\")r++;else if(t[r]===e[0])n++;else if(t[r]===e[1]&&(n--,n<0))return r;return n>0?-2:-1}function tr(t,e,n,r,l){let o=e.href,a=e.title||null,i=t[1].replace(l.other.outputLinkReplace,"$1");r.state.inLink=!0;let h={type:t[0].charAt(0)==="!"?"image":"link",raw:n,href:o,title:a,text:i,tokens:r.inlineTokens(i)};return r.state.inLink=!1,h}function Jo(t,e,n){let r=t.match(n.other.indentCodeCompensation);if(r===null)return e;let l=r[1];return e.split(`
`).map(o=>{let a=o.match(n.other.beginningSpace);if(a===null)return o;let[i]=a;return i.length>=l.length?o.slice(l.length):o}).join(`
`)}var yt=class{constructor(t){A(this,"options");A(this,"rules");A(this,"lexer");this.options=t||Ee}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let n=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?n:He(n,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let n=e[0],r=Jo(n,e[3]||"",this.rules);return{type:"code",raw:n,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:r}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let n=e[2].trim();if(this.rules.other.endingHash.test(n)){let r=He(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:He(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let n=He(e[0],`
`).split(`
`),r="",l="",o=[];for(;n.length>0;){let a=!1,i=[],h;for(h=0;h<n.length;h++)if(this.rules.other.blockquoteStart.test(n[h]))i.push(n[h]),a=!0;else if(!a)i.push(n[h]);else break;n=n.slice(h);let d=i.join(`
`),u=d.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${d}`:d,l=l?`${l}
${u}`:u;let b=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,o,!0),this.lexer.state.top=b,n.length===0)break;let g=o.at(-1);if((g==null?void 0:g.type)==="code")break;if((g==null?void 0:g.type)==="blockquote"){let x=g,w=x.raw+`
`+n.join(`
`),C=this.blockquote(w);o[o.length-1]=C,r=r.substring(0,r.length-x.raw.length)+C.raw,l=l.substring(0,l.length-x.text.length)+C.text;break}else if((g==null?void 0:g.type)==="list"){let x=g,w=x.raw+`
`+n.join(`
`),C=this.list(w);o[o.length-1]=C,r=r.substring(0,r.length-g.raw.length)+C.raw,l=l.substring(0,l.length-x.raw.length)+C.raw,n=w.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:o,text:l}}}list(t){let e=this.rules.block.list.exec(t);if(e){let n=e[1].trim(),r=n.length>1,l={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");let o=this.rules.other.listItemRegex(n),a=!1;for(;t;){let h=!1,d="",u="";if(!(e=o.exec(t))||this.rules.block.hr.test(t))break;d=e[0],t=t.substring(d.length);let b=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,re=>" ".repeat(3*re.length)),g=t.split(`
`,1)[0],x=!b.trim(),w=0;if(this.options.pedantic?(w=2,u=b.trimStart()):x?w=e[1].length+1:(w=e[2].search(this.rules.other.nonSpaceChar),w=w>4?1:w,u=b.slice(w),w+=e[1].length),x&&this.rules.other.blankLine.test(g)&&(d+=g+`
`,t=t.substring(g.length+1),h=!0),!h){let re=this.rules.other.nextBulletRegex(w),le=this.rules.other.hrRegex(w),K=this.rules.other.fencesBeginRegex(w),O=this.rules.other.headingBeginRegex(w),pe=this.rules.other.htmlBeginRegex(w);for(;t;){let fe=t.split(`
`,1)[0],ge;if(g=fe,this.options.pedantic?(g=g.replace(this.rules.other.listReplaceNesting,"  "),ge=g):ge=g.replace(this.rules.other.tabCharGlobal,"    "),K.test(g)||O.test(g)||pe.test(g)||re.test(g)||le.test(g))break;if(ge.search(this.rules.other.nonSpaceChar)>=w||!g.trim())u+=`
`+ge.slice(w);else{if(x||b.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||K.test(b)||O.test(b)||le.test(b))break;u+=`
`+g}!x&&!g.trim()&&(x=!0),d+=fe+`
`,t=t.substring(fe.length+1),b=ge.slice(w)}}l.loose||(a?l.loose=!0:this.rules.other.doubleBlankLine.test(d)&&(a=!0));let C=null,he;this.options.gfm&&(C=this.rules.other.listIsTask.exec(u),C&&(he=C[0]!=="[ ] ",u=u.replace(this.rules.other.listReplaceTask,""))),l.items.push({type:"list_item",raw:d,task:!!C,checked:he,loose:!1,text:u,tokens:[]}),l.raw+=d}let i=l.items.at(-1);if(i)i.raw=i.raw.trimEnd(),i.text=i.text.trimEnd();else return;l.raw=l.raw.trimEnd();for(let h=0;h<l.items.length;h++)if(this.lexer.state.top=!1,l.items[h].tokens=this.lexer.blockTokens(l.items[h].text,[]),!l.loose){let d=l.items[h].tokens.filter(b=>b.type==="space"),u=d.length>0&&d.some(b=>this.rules.other.anyLine.test(b.raw));l.loose=u}if(l.loose)for(let h=0;h<l.items.length;h++)l.items[h].loose=!0;return l}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let n=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",l=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:n,raw:e[0],href:r,title:l}}}table(t){var a;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let n=er(e[1]),r=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),l=(a=e[3])!=null&&a.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(n.length===r.length){for(let i of r)this.rules.other.tableAlignRight.test(i)?o.align.push("right"):this.rules.other.tableAlignCenter.test(i)?o.align.push("center"):this.rules.other.tableAlignLeft.test(i)?o.align.push("left"):o.align.push(null);for(let i=0;i<n.length;i++)o.header.push({text:n[i],tokens:this.lexer.inline(n[i]),header:!0,align:o.align[i]});for(let i of l)o.rows.push(er(i,o.header.length).map((h,d)=>({text:h,tokens:this.lexer.inline(h),header:!1,align:o.align[d]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let n=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:n,tokens:this.lexer.inline(n)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let n=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let o=He(n.slice(0,-1),"\\");if((n.length-o.length)%2===0)return}else{let o=Qo(e[2],"()");if(o===-2)return;if(o>-1){let a=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,a).trim(),e[3]=""}}let r=e[2],l="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(r);o&&(r=o[1],l=o[3])}else l=e[3]?e[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),tr(e,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:l&&l.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){let r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),l=e[r.toLowerCase()];if(!l){let o=n[0].charAt(0);return{type:"text",raw:o,text:o}}return tr(n,l,n[0],this.lexer,this.rules)}}emStrong(t,e,n=""){let r=this.rules.inline.emStrongLDelim.exec(t);if(!(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!n||this.rules.inline.punctuation.exec(n))){let l=[...r[0]].length-1,o,a,i=l,h=0,d=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,e=e.slice(-1*t.length+l);(r=d.exec(e))!=null;){if(o=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!o)continue;if(a=[...o].length,r[3]||r[4]){i+=a;continue}else if((r[5]||r[6])&&l%3&&!((l+a)%3)){h+=a;continue}if(i-=a,i>0)continue;a=Math.min(a,a+i+h);let u=[...r[0]][0].length,b=t.slice(0,l+r.index+u+a);if(Math.min(l,a)%2){let x=b.slice(1,-1);return{type:"em",raw:b,text:x,tokens:this.lexer.inlineTokens(x)}}let g=b.slice(2,-2);return{type:"strong",raw:b,text:g,tokens:this.lexer.inlineTokens(g)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let n=e[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(n),l=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&l&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:e[0],text:n}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){let e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let n,r;return e[2]==="@"?(n=e[1],r="mailto:"+n):(n=e[1],r=n),{type:"link",raw:e[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(t){var n;let e;if(e=this.rules.inline.url.exec(t)){let r,l;if(e[2]==="@")r=e[0],l="mailto:"+r;else{let o;do o=e[0],e[0]=((n=this.rules.inline._backpedal.exec(e[0]))==null?void 0:n[0])??"";while(o!==e[0]);r=e[0],e[1]==="www."?l="http://"+e[0]:l=e[0]}return{type:"link",raw:e[0],text:r,href:l,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let n=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:n}}}},ce=class Qt{constructor(e){A(this,"tokens");A(this,"options");A(this,"state");A(this,"tokenizer");A(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ee,this.options.tokenizer=this.options.tokenizer||new yt,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:H,block:it.normal,inline:Fe.normal};this.options.pedantic?(n.block=it.pedantic,n.inline=Fe.pedantic):this.options.gfm&&(n.block=it.gfm,this.options.breaks?n.inline=Fe.breaks:n.inline=Fe.gfm),this.tokenizer.rules=n}static get rules(){return{block:it,inline:Fe}}static lex(e,n){return new Qt(n).lex(e)}static lexInline(e,n){return new Qt(n).inlineTokens(e)}lex(e){e=e.replace(H.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[],r=!1){var l,o,a;for(this.options.pedantic&&(e=e.replace(H.tabCharGlobal,"    ").replace(H.spaceLine,""));e;){let i;if((o=(l=this.options.extensions)==null?void 0:l.block)!=null&&o.some(d=>(i=d.call({lexer:this},e,n))?(e=e.substring(i.raw.length),n.push(i),!0):!1))continue;if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length);let d=n.at(-1);i.raw.length===1&&d!==void 0?d.raw+=`
`:n.push(i);continue}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length);let d=n.at(-1);(d==null?void 0:d.type)==="paragraph"||(d==null?void 0:d.type)==="text"?(d.raw+=`
`+i.raw,d.text+=`
`+i.text,this.inlineQueue.at(-1).src=d.text):n.push(i);continue}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length);let d=n.at(-1);(d==null?void 0:d.type)==="paragraph"||(d==null?void 0:d.type)==="text"?(d.raw+=`
`+i.raw,d.text+=`
`+i.raw,this.inlineQueue.at(-1).src=d.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title});continue}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),n.push(i);continue}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),n.push(i);continue}let h=e;if((a=this.options.extensions)!=null&&a.startBlock){let d=1/0,u=e.slice(1),b;this.options.extensions.startBlock.forEach(g=>{b=g.call({lexer:this},u),typeof b=="number"&&b>=0&&(d=Math.min(d,b))}),d<1/0&&d>=0&&(h=e.substring(0,d+1))}if(this.state.top&&(i=this.tokenizer.paragraph(h))){let d=n.at(-1);r&&(d==null?void 0:d.type)==="paragraph"?(d.raw+=`
`+i.raw,d.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=d.text):n.push(i),r=h.length!==e.length,e=e.substring(i.raw.length);continue}if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length);let d=n.at(-1);(d==null?void 0:d.type)==="text"?(d.raw+=`
`+i.raw,d.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=d.text):n.push(i);continue}if(e){let d="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){var i,h,d;let r=e,l=null;if(this.tokens.links){let u=Object.keys(this.tokens.links);if(u.length>0)for(;(l=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)u.includes(l[0].slice(l[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,l.index)+"["+"a".repeat(l[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(l=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,l.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(l=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,l.index)+"["+"a".repeat(l[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let o=!1,a="";for(;e;){o||(a=""),o=!1;let u;if((h=(i=this.options.extensions)==null?void 0:i.inline)!=null&&h.some(g=>(u=g.call({lexer:this},e,n))?(e=e.substring(u.raw.length),n.push(u),!0):!1))continue;if(u=this.tokenizer.escape(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.tag(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.link(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(u.raw.length);let g=n.at(-1);u.type==="text"&&(g==null?void 0:g.type)==="text"?(g.raw+=u.raw,g.text+=u.text):n.push(u);continue}if(u=this.tokenizer.emStrong(e,r,a)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.codespan(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.br(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.del(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.autolink(e)){e=e.substring(u.raw.length),n.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(e))){e=e.substring(u.raw.length),n.push(u);continue}let b=e;if((d=this.options.extensions)!=null&&d.startInline){let g=1/0,x=e.slice(1),w;this.options.extensions.startInline.forEach(C=>{w=C.call({lexer:this},x),typeof w=="number"&&w>=0&&(g=Math.min(g,w))}),g<1/0&&g>=0&&(b=e.substring(0,g+1))}if(u=this.tokenizer.inlineText(b)){e=e.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(a=u.raw.slice(-1)),o=!0;let g=n.at(-1);(g==null?void 0:g.type)==="text"?(g.raw+=u.raw,g.text+=u.text):n.push(u);continue}if(e){let g="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(g);break}else throw new Error(g)}}return n}},wt=class{constructor(t){A(this,"options");A(this,"parser");this.options=t||Ee}space(t){return""}code({text:t,lang:e,escaped:n}){var o;let r=(o=(e||"").match(H.notSpaceStart))==null?void 0:o[0],l=t.replace(H.endingNewline,"")+`
`;return r?'<pre><code class="language-'+ee(r)+'">'+(n?l:ee(l,!0))+`</code></pre>
`:"<pre><code>"+(n?l:ee(l,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,n=t.start,r="";for(let a=0;a<t.items.length;a++){let i=t.items[a];r+=this.listitem(i)}let l=e?"ol":"ul",o=e&&n!==1?' start="'+n+'"':"";return"<"+l+o+`>
`+r+"</"+l+`>
`}listitem(t){var n;let e="";if(t.task){let r=this.checkbox({checked:!!t.checked});t.loose?((n=t.tokens[0])==null?void 0:n.type)==="paragraph"?(t.tokens[0].text=r+" "+t.tokens[0].text,t.tokens[0].tokens&&t.tokens[0].tokens.length>0&&t.tokens[0].tokens[0].type==="text"&&(t.tokens[0].tokens[0].text=r+" "+ee(t.tokens[0].tokens[0].text),t.tokens[0].tokens[0].escaped=!0)):t.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):e+=r+" "}return e+=this.parser.parse(t.tokens,!!t.loose),`<li>${e}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",n="";for(let l=0;l<t.header.length;l++)n+=this.tablecell(t.header[l]);e+=this.tablerow({text:n});let r="";for(let l=0;l<t.rows.length;l++){let o=t.rows[l];n="";for(let a=0;a<o.length;a++)n+=this.tablecell(o[a]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+r+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${ee(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:n}){let r=this.parser.parseInline(n),l=Jn(t);if(l===null)return r;t=l;let o='<a href="'+t+'"';return e&&(o+=' title="'+ee(e)+'"'),o+=">"+r+"</a>",o}image({href:t,title:e,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));let l=Jn(t);if(l===null)return ee(n);t=l;let o=`<img src="${t}" alt="${n}"`;return e&&(o+=` title="${ee(e)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:ee(t.text)}},pn=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}},ue=class Jt{constructor(e){A(this,"options");A(this,"renderer");A(this,"textRenderer");this.options=e||Ee,this.options.renderer=this.options.renderer||new wt,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new pn}static parse(e,n){return new Jt(n).parse(e)}static parseInline(e,n){return new Jt(n).parseInline(e)}parse(e,n=!0){var l,o;let r="";for(let a=0;a<e.length;a++){let i=e[a];if((o=(l=this.options.extensions)==null?void 0:l.renderers)!=null&&o[i.type]){let d=i,u=this.options.extensions.renderers[d.type].call({parser:this},d);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(d.type)){r+=u||"";continue}}let h=i;switch(h.type){case"space":{r+=this.renderer.space(h);continue}case"hr":{r+=this.renderer.hr(h);continue}case"heading":{r+=this.renderer.heading(h);continue}case"code":{r+=this.renderer.code(h);continue}case"table":{r+=this.renderer.table(h);continue}case"blockquote":{r+=this.renderer.blockquote(h);continue}case"list":{r+=this.renderer.list(h);continue}case"html":{r+=this.renderer.html(h);continue}case"paragraph":{r+=this.renderer.paragraph(h);continue}case"text":{let d=h,u=this.renderer.text(d);for(;a+1<e.length&&e[a+1].type==="text";)d=e[++a],u+=`
`+this.renderer.text(d);n?r+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):r+=u;continue}default:{let d='Token with "'+h.type+'" type was not found.';if(this.options.silent)return console.error(d),"";throw new Error(d)}}}return r}parseInline(e,n=this.renderer){var l,o;let r="";for(let a=0;a<e.length;a++){let i=e[a];if((o=(l=this.options.extensions)==null?void 0:l.renderers)!=null&&o[i.type]){let d=this.options.extensions.renderers[i.type].call({parser:this},i);if(d!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)){r+=d||"";continue}}let h=i;switch(h.type){case"escape":{r+=n.text(h);break}case"html":{r+=n.html(h);break}case"link":{r+=n.link(h);break}case"image":{r+=n.image(h);break}case"strong":{r+=n.strong(h);break}case"em":{r+=n.em(h);break}case"codespan":{r+=n.codespan(h);break}case"br":{r+=n.br(h);break}case"del":{r+=n.del(h);break}case"text":{r+=n.text(h);break}default:{let d='Token with "'+h.type+'" type was not found.';if(this.options.silent)return console.error(d),"";throw new Error(d)}}}return r}},Bt,pt=(Bt=class{constructor(t){A(this,"options");A(this,"block");this.options=t||Ee}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}provideLexer(){return this.block?ce.lex:ce.lexInline}provideParser(){return this.block?ue.parse:ue.parseInline}},A(Bt,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),Bt),es=class{constructor(...t){A(this,"defaults",ln());A(this,"options",this.setOptions);A(this,"parse",this.parseMarkdown(!0));A(this,"parseInline",this.parseMarkdown(!1));A(this,"Parser",ue);A(this,"Renderer",wt);A(this,"TextRenderer",pn);A(this,"Lexer",ce);A(this,"Tokenizer",yt);A(this,"Hooks",pt);this.use(...t)}walkTokens(t,e){var r,l;let n=[];for(let o of t)switch(n=n.concat(e.call(this,o)),o.type){case"table":{let a=o;for(let i of a.header)n=n.concat(this.walkTokens(i.tokens,e));for(let i of a.rows)for(let h of i)n=n.concat(this.walkTokens(h.tokens,e));break}case"list":{let a=o;n=n.concat(this.walkTokens(a.items,e));break}default:{let a=o;(l=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&l[a.type]?this.defaults.extensions.childTokens[a.type].forEach(i=>{let h=a[i].flat(1/0);n=n.concat(this.walkTokens(h,e))}):a.tokens&&(n=n.concat(this.walkTokens(a.tokens,e)))}}return n}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(n=>{let r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(l=>{if(!l.name)throw new Error("extension name required");if("renderer"in l){let o=e.renderers[l.name];o?e.renderers[l.name]=function(...a){let i=l.renderer.apply(this,a);return i===!1&&(i=o.apply(this,a)),i}:e.renderers[l.name]=l.renderer}if("tokenizer"in l){if(!l.level||l.level!=="block"&&l.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[l.level];o?o.unshift(l.tokenizer):e[l.level]=[l.tokenizer],l.start&&(l.level==="block"?e.startBlock?e.startBlock.push(l.start):e.startBlock=[l.start]:l.level==="inline"&&(e.startInline?e.startInline.push(l.start):e.startInline=[l.start]))}"childTokens"in l&&l.childTokens&&(e.childTokens[l.name]=l.childTokens)}),r.extensions=e),n.renderer){let l=this.defaults.renderer||new wt(this.defaults);for(let o in n.renderer){if(!(o in l))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let a=o,i=n.renderer[a],h=l[a];l[a]=(...d)=>{let u=i.apply(l,d);return u===!1&&(u=h.apply(l,d)),u||""}}r.renderer=l}if(n.tokenizer){let l=this.defaults.tokenizer||new yt(this.defaults);for(let o in n.tokenizer){if(!(o in l))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let a=o,i=n.tokenizer[a],h=l[a];l[a]=(...d)=>{let u=i.apply(l,d);return u===!1&&(u=h.apply(l,d)),u}}r.tokenizer=l}if(n.hooks){let l=this.defaults.hooks||new pt;for(let o in n.hooks){if(!(o in l))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let a=o,i=n.hooks[a],h=l[a];pt.passThroughHooks.has(o)?l[a]=d=>{if(this.defaults.async)return Promise.resolve(i.call(l,d)).then(b=>h.call(l,b));let u=i.call(l,d);return h.call(l,u)}:l[a]=(...d)=>{let u=i.apply(l,d);return u===!1&&(u=h.apply(l,d)),u}}r.hooks=l}if(n.walkTokens){let l=this.defaults.walkTokens,o=n.walkTokens;r.walkTokens=function(a){let i=[];return i.push(o.call(this,a)),l&&(i=i.concat(l.call(this,a))),i}}this.defaults={...this.defaults,...r}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return ce.lex(t,e??this.defaults)}parser(t,e){return ue.parse(t,e??this.defaults)}parseMarkdown(t){return(e,n)=>{let r={...n},l={...this.defaults,...r},o=this.onError(!!l.silent,!!l.async);if(this.defaults.async===!0&&r.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));l.hooks&&(l.hooks.options=l,l.hooks.block=t);let a=l.hooks?l.hooks.provideLexer():t?ce.lex:ce.lexInline,i=l.hooks?l.hooks.provideParser():t?ue.parse:ue.parseInline;if(l.async)return Promise.resolve(l.hooks?l.hooks.preprocess(e):e).then(h=>a(h,l)).then(h=>l.hooks?l.hooks.processAllTokens(h):h).then(h=>l.walkTokens?Promise.all(this.walkTokens(h,l.walkTokens)).then(()=>h):h).then(h=>i(h,l)).then(h=>l.hooks?l.hooks.postprocess(h):h).catch(o);try{l.hooks&&(e=l.hooks.preprocess(e));let h=a(e,l);l.hooks&&(h=l.hooks.processAllTokens(h)),l.walkTokens&&this.walkTokens(h,l.walkTokens);let d=i(h,l);return l.hooks&&(d=l.hooks.postprocess(d)),d}catch(h){return o(h)}}}onError(t,e){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let r="<p>An error occurred:</p><pre>"+ee(n.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(n);throw n}}},xe=new es;function v(t,e){return xe.parse(t,e)}v.options=v.setOptions=function(t){return xe.setOptions(t),v.defaults=xe.defaults,Nr(v.defaults),v};v.getDefaults=ln;v.defaults=Ee;v.use=function(...t){return xe.use(...t),v.defaults=xe.defaults,Nr(v.defaults),v};v.walkTokens=function(t,e){return xe.walkTokens(t,e)};v.parseInline=xe.parseInline;v.Parser=ue;v.parser=ue.parse;v.Renderer=wt;v.TextRenderer=pn;v.Lexer=ce;v.lexer=ce.lex;v.Tokenizer=yt;v.Hooks=pt;v.parse=v;v.options;v.setOptions;v.use;v.walkTokens;v.parseInline;ue.parse;ce.lex;/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:zr,setPrototypeOf:nr,isFrozen:ts,getPrototypeOf:ns,getOwnPropertyDescriptor:rs}=Object;let{freeze:B,seal:X,create:Ur}=Object,{apply:en,construct:tn}=typeof Reflect<"u"&&Reflect;B||(B=function(e){return e});X||(X=function(e){return e});en||(en=function(e,n,r){return e.apply(n,r)});tn||(tn=function(e,n){return new e(...n)});const at=j(Array.prototype.forEach),ls=j(Array.prototype.lastIndexOf),rr=j(Array.prototype.pop),Be=j(Array.prototype.push),os=j(Array.prototype.splice),ft=j(String.prototype.toLowerCase),Wt=j(String.prototype.toString),lr=j(String.prototype.match),je=j(String.prototype.replace),ss=j(String.prototype.indexOf),is=j(String.prototype.trim),Q=j(Object.prototype.hasOwnProperty),F=j(RegExp.prototype.test),qe=as(TypeError);function j(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),l=1;l<n;l++)r[l-1]=arguments[l];return en(t,e,r)}}function as(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return tn(t,n)}}function S(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ft;nr&&nr(t,null);let r=e.length;for(;r--;){let l=e[r];if(typeof l=="string"){const o=n(l);o!==l&&(ts(e)||(e[r]=o),l=o)}t[l]=!0}return t}function cs(t){for(let e=0;e<t.length;e++)Q(t,e)||(t[e]=null);return t}function ae(t){const e=Ur(null);for(const[n,r]of zr(t))Q(t,n)&&(Array.isArray(r)?e[n]=cs(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=ae(r):e[n]=r);return e}function Ge(t,e){for(;t!==null;){const r=rs(t,e);if(r){if(r.get)return j(r.get);if(typeof r.value=="function")return j(r.value)}t=ns(t)}function n(){return null}return n}const or=B(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),zt=B(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ut=B(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),us=B(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ft=B(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),ds=B(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),sr=B(["#text"]),ir=B(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Ht=B(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ar=B(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ct=B(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),hs=X(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ps=X(/<%[\w\W]*|[\w\W]*%>/gm),fs=X(/\$\{[\w\W]*/gm),gs=X(/^data-[\-\w.\u00B7-\uFFFF]+$/),ms=X(/^aria-[\-\w]+$/),Fr=X(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),bs=X(/^(?:\w+script|data):/i),ys=X(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Hr=X(/^html$/i),ws=X(/^[a-z][.\w]*(-[.\w]+)+$/i);var cr=Object.freeze({__proto__:null,ARIA_ATTR:ms,ATTR_WHITESPACE:ys,CUSTOM_ELEMENT:ws,DATA_ATTR:gs,DOCTYPE_NAME:Hr,ERB_EXPR:ps,IS_ALLOWED_URI:Fr,IS_SCRIPT_OR_DATA:bs,MUSTACHE_EXPR:hs,TMPLIT_EXPR:fs});const Ve={element:1,text:3,progressingInstruction:7,comment:8,document:9},ks=function(){return typeof window>"u"?null:window},As=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const l="data-tt-policy-suffix";n&&n.hasAttribute(l)&&(r=n.getAttribute(l));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},ur=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Br(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ks();const e=y=>Br(y);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==Ve.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,l=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:a,Node:i,Element:h,NodeFilter:d,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:b,DOMParser:g,trustedTypes:x}=t,w=h.prototype,C=Ge(w,"cloneNode"),he=Ge(w,"remove"),re=Ge(w,"nextSibling"),le=Ge(w,"childNodes"),K=Ge(w,"parentNode");if(typeof a=="function"){const y=n.createElement("template");y.content&&y.content.ownerDocument&&(n=y.content.ownerDocument)}let O,pe="";const{implementation:fe,createNodeIterator:ge,createDocumentFragment:qr,getElementsByTagName:Gr}=n,{importNode:Vr}=r;let U=ur();e.isSupported=typeof zr=="function"&&typeof K=="function"&&fe&&fe.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:St,ERB_EXPR:xt,TMPLIT_EXPR:vt,DATA_ATTR:Yr,ARIA_ATTR:Zr,IS_SCRIPT_OR_DATA:Xr,ATTR_WHITESPACE:fn,CUSTOM_ELEMENT:Kr}=cr;let{IS_ALLOWED_URI:gn}=cr,I=null;const mn=S({},[...or,...zt,...Ut,...Ft,...sr]);let D=null;const bn=S({},[...ir,...Ht,...ar,...ct]);let R=Object.seal(Ur(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),De=null,Et=null,yn=!0,_t=!0,wn=!1,kn=!0,_e=!1,Je=!0,me=!1,Tt=!1,Nt=!1,Te=!1,et=!1,tt=!1,An=!0,Sn=!1;const Qr="user-content-";let Ct=!0,$e=!1,Ne={},Ce=null;const xn=S({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let vn=null;const En=S({},["audio","video","img","source","image","track"]);let Rt=null;const _n=S({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),nt="http://www.w3.org/1998/Math/MathML",rt="http://www.w3.org/2000/svg",oe="http://www.w3.org/1999/xhtml";let Re=oe,Lt=!1,Mt=null;const Jr=S({},[nt,rt,oe],Wt);let lt=S({},["mi","mo","mn","ms","mtext"]),ot=S({},["annotation-xml"]);const el=S({},["title","style","font","a","script"]);let We=null;const tl=["application/xhtml+xml","text/html"],nl="text/html";let P=null,Le=null;const rl=n.createElement("form"),Tn=function(c){return c instanceof RegExp||c instanceof Function},Ot=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Le&&Le===c)){if((!c||typeof c!="object")&&(c={}),c=ae(c),We=tl.indexOf(c.PARSER_MEDIA_TYPE)===-1?nl:c.PARSER_MEDIA_TYPE,P=We==="application/xhtml+xml"?Wt:ft,I=Q(c,"ALLOWED_TAGS")?S({},c.ALLOWED_TAGS,P):mn,D=Q(c,"ALLOWED_ATTR")?S({},c.ALLOWED_ATTR,P):bn,Mt=Q(c,"ALLOWED_NAMESPACES")?S({},c.ALLOWED_NAMESPACES,Wt):Jr,Rt=Q(c,"ADD_URI_SAFE_ATTR")?S(ae(_n),c.ADD_URI_SAFE_ATTR,P):_n,vn=Q(c,"ADD_DATA_URI_TAGS")?S(ae(En),c.ADD_DATA_URI_TAGS,P):En,Ce=Q(c,"FORBID_CONTENTS")?S({},c.FORBID_CONTENTS,P):xn,De=Q(c,"FORBID_TAGS")?S({},c.FORBID_TAGS,P):ae({}),Et=Q(c,"FORBID_ATTR")?S({},c.FORBID_ATTR,P):ae({}),Ne=Q(c,"USE_PROFILES")?c.USE_PROFILES:!1,yn=c.ALLOW_ARIA_ATTR!==!1,_t=c.ALLOW_DATA_ATTR!==!1,wn=c.ALLOW_UNKNOWN_PROTOCOLS||!1,kn=c.ALLOW_SELF_CLOSE_IN_ATTR!==!1,_e=c.SAFE_FOR_TEMPLATES||!1,Je=c.SAFE_FOR_XML!==!1,me=c.WHOLE_DOCUMENT||!1,Te=c.RETURN_DOM||!1,et=c.RETURN_DOM_FRAGMENT||!1,tt=c.RETURN_TRUSTED_TYPE||!1,Nt=c.FORCE_BODY||!1,An=c.SANITIZE_DOM!==!1,Sn=c.SANITIZE_NAMED_PROPS||!1,Ct=c.KEEP_CONTENT!==!1,$e=c.IN_PLACE||!1,gn=c.ALLOWED_URI_REGEXP||Fr,Re=c.NAMESPACE||oe,lt=c.MATHML_TEXT_INTEGRATION_POINTS||lt,ot=c.HTML_INTEGRATION_POINTS||ot,R=c.CUSTOM_ELEMENT_HANDLING||{},c.CUSTOM_ELEMENT_HANDLING&&Tn(c.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(R.tagNameCheck=c.CUSTOM_ELEMENT_HANDLING.tagNameCheck),c.CUSTOM_ELEMENT_HANDLING&&Tn(c.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(R.attributeNameCheck=c.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),c.CUSTOM_ELEMENT_HANDLING&&typeof c.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(R.allowCustomizedBuiltInElements=c.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),_e&&(_t=!1),et&&(Te=!0),Ne&&(I=S({},sr),D=[],Ne.html===!0&&(S(I,or),S(D,ir)),Ne.svg===!0&&(S(I,zt),S(D,Ht),S(D,ct)),Ne.svgFilters===!0&&(S(I,Ut),S(D,Ht),S(D,ct)),Ne.mathMl===!0&&(S(I,Ft),S(D,ar),S(D,ct))),c.ADD_TAGS&&(I===mn&&(I=ae(I)),S(I,c.ADD_TAGS,P)),c.ADD_ATTR&&(D===bn&&(D=ae(D)),S(D,c.ADD_ATTR,P)),c.ADD_URI_SAFE_ATTR&&S(Rt,c.ADD_URI_SAFE_ATTR,P),c.FORBID_CONTENTS&&(Ce===xn&&(Ce=ae(Ce)),S(Ce,c.FORBID_CONTENTS,P)),Ct&&(I["#text"]=!0),me&&S(I,["html","head","body"]),I.table&&(S(I,["tbody"]),delete De.tbody),c.TRUSTED_TYPES_POLICY){if(typeof c.TRUSTED_TYPES_POLICY.createHTML!="function")throw qe('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof c.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw qe('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');O=c.TRUSTED_TYPES_POLICY,pe=O.createHTML("")}else O===void 0&&(O=As(x,l)),O!==null&&typeof pe=="string"&&(pe=O.createHTML(""));B&&B(c),Le=c}},Nn=S({},[...zt,...Ut,...us]),Cn=S({},[...Ft,...ds]),ll=function(c){let f=K(c);(!f||!f.tagName)&&(f={namespaceURI:Re,tagName:"template"});const m=ft(c.tagName),N=ft(f.tagName);return Mt[c.namespaceURI]?c.namespaceURI===rt?f.namespaceURI===oe?m==="svg":f.namespaceURI===nt?m==="svg"&&(N==="annotation-xml"||lt[N]):!!Nn[m]:c.namespaceURI===nt?f.namespaceURI===oe?m==="math":f.namespaceURI===rt?m==="math"&&ot[N]:!!Cn[m]:c.namespaceURI===oe?f.namespaceURI===rt&&!ot[N]||f.namespaceURI===nt&&!lt[N]?!1:!Cn[m]&&(el[m]||!Nn[m]):!!(We==="application/xhtml+xml"&&Mt[c.namespaceURI]):!1},J=function(c){Be(e.removed,{element:c});try{K(c).removeChild(c)}catch{he(c)}},Me=function(c,f){try{Be(e.removed,{attribute:f.getAttributeNode(c),from:f})}catch{Be(e.removed,{attribute:null,from:f})}if(f.removeAttribute(c),c==="is")if(Te||et)try{J(f)}catch{}else try{f.setAttribute(c,"")}catch{}},Rn=function(c){let f=null,m=null;if(Nt)c="<remove></remove>"+c;else{const M=lr(c,/^[\r\n\t ]+/);m=M&&M[0]}We==="application/xhtml+xml"&&Re===oe&&(c='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+c+"</body></html>");const N=O?O.createHTML(c):c;if(Re===oe)try{f=new g().parseFromString(N,We)}catch{}if(!f||!f.documentElement){f=fe.createDocument(Re,"template",null);try{f.documentElement.innerHTML=Lt?pe:N}catch{}}const W=f.body||f.documentElement;return c&&m&&W.insertBefore(n.createTextNode(m),W.childNodes[0]||null),Re===oe?Gr.call(f,me?"html":"body")[0]:me?f.documentElement:W},Ln=function(c){return ge.call(c.ownerDocument||c,c,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},It=function(c){return c instanceof b&&(typeof c.nodeName!="string"||typeof c.textContent!="string"||typeof c.removeChild!="function"||!(c.attributes instanceof u)||typeof c.removeAttribute!="function"||typeof c.setAttribute!="function"||typeof c.namespaceURI!="string"||typeof c.insertBefore!="function"||typeof c.hasChildNodes!="function")},Mn=function(c){return typeof i=="function"&&c instanceof i};function se(y,c,f){at(y,m=>{m.call(e,c,f,Le)})}const On=function(c){let f=null;if(se(U.beforeSanitizeElements,c,null),It(c))return J(c),!0;const m=P(c.nodeName);if(se(U.uponSanitizeElement,c,{tagName:m,allowedTags:I}),Je&&c.hasChildNodes()&&!Mn(c.firstElementChild)&&F(/<[/\w!]/g,c.innerHTML)&&F(/<[/\w!]/g,c.textContent)||c.nodeType===Ve.progressingInstruction||Je&&c.nodeType===Ve.comment&&F(/<[/\w]/g,c.data))return J(c),!0;if(!I[m]||De[m]){if(!De[m]&&Pn(m)&&(R.tagNameCheck instanceof RegExp&&F(R.tagNameCheck,m)||R.tagNameCheck instanceof Function&&R.tagNameCheck(m)))return!1;if(Ct&&!Ce[m]){const N=K(c)||c.parentNode,W=le(c)||c.childNodes;if(W&&N){const M=W.length;for(let q=M-1;q>=0;--q){const ie=C(W[q],!0);ie.__removalCount=(c.__removalCount||0)+1,N.insertBefore(ie,re(c))}}}return J(c),!0}return c instanceof h&&!ll(c)||(m==="noscript"||m==="noembed"||m==="noframes")&&F(/<\/no(script|embed|frames)/i,c.innerHTML)?(J(c),!0):(_e&&c.nodeType===Ve.text&&(f=c.textContent,at([St,xt,vt],N=>{f=je(f,N," ")}),c.textContent!==f&&(Be(e.removed,{element:c.cloneNode()}),c.textContent=f)),se(U.afterSanitizeElements,c,null),!1)},In=function(c,f,m){if(An&&(f==="id"||f==="name")&&(m in n||m in rl))return!1;if(!(_t&&!Et[f]&&F(Yr,f))){if(!(yn&&F(Zr,f))){if(!D[f]||Et[f]){if(!(Pn(c)&&(R.tagNameCheck instanceof RegExp&&F(R.tagNameCheck,c)||R.tagNameCheck instanceof Function&&R.tagNameCheck(c))&&(R.attributeNameCheck instanceof RegExp&&F(R.attributeNameCheck,f)||R.attributeNameCheck instanceof Function&&R.attributeNameCheck(f))||f==="is"&&R.allowCustomizedBuiltInElements&&(R.tagNameCheck instanceof RegExp&&F(R.tagNameCheck,m)||R.tagNameCheck instanceof Function&&R.tagNameCheck(m))))return!1}else if(!Rt[f]){if(!F(gn,je(m,fn,""))){if(!((f==="src"||f==="xlink:href"||f==="href")&&c!=="script"&&ss(m,"data:")===0&&vn[c])){if(!(wn&&!F(Xr,je(m,fn,"")))){if(m)return!1}}}}}}return!0},Pn=function(c){return c!=="annotation-xml"&&lr(c,Kr)},Dn=function(c){se(U.beforeSanitizeAttributes,c,null);const{attributes:f}=c;if(!f||It(c))return;const m={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:D,forceKeepAttr:void 0};let N=f.length;for(;N--;){const W=f[N],{name:M,namespaceURI:q,value:ie}=W,ze=P(M),Pt=ie;let z=M==="value"?Pt:is(Pt);if(m.attrName=ze,m.attrValue=z,m.keepAttr=!0,m.forceKeepAttr=void 0,se(U.uponSanitizeAttribute,c,m),z=m.attrValue,Sn&&(ze==="id"||ze==="name")&&(Me(M,c),z=Qr+z),Je&&F(/((--!?|])>)|<\/(style|title)/i,z)){Me(M,c);continue}if(m.forceKeepAttr)continue;if(!m.keepAttr){Me(M,c);continue}if(!kn&&F(/\/>/i,z)){Me(M,c);continue}_e&&at([St,xt,vt],Wn=>{z=je(z,Wn," ")});const $n=P(c.nodeName);if(!In($n,ze,z)){Me(M,c);continue}if(O&&typeof x=="object"&&typeof x.getAttributeType=="function"&&!q)switch(x.getAttributeType($n,ze)){case"TrustedHTML":{z=O.createHTML(z);break}case"TrustedScriptURL":{z=O.createScriptURL(z);break}}if(z!==Pt)try{q?c.setAttributeNS(q,M,z):c.setAttribute(M,z),It(c)?J(c):rr(e.removed)}catch{Me(M,c)}}se(U.afterSanitizeAttributes,c,null)},ol=function y(c){let f=null;const m=Ln(c);for(se(U.beforeSanitizeShadowDOM,c,null);f=m.nextNode();)se(U.uponSanitizeShadowNode,f,null),On(f),Dn(f),f.content instanceof o&&y(f.content);se(U.afterSanitizeShadowDOM,c,null)};return e.sanitize=function(y){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=null,m=null,N=null,W=null;if(Lt=!y,Lt&&(y="<!-->"),typeof y!="string"&&!Mn(y))if(typeof y.toString=="function"){if(y=y.toString(),typeof y!="string")throw qe("dirty is not a string, aborting")}else throw qe("toString is not a function");if(!e.isSupported)return y;if(Tt||Ot(c),e.removed=[],typeof y=="string"&&($e=!1),$e){if(y.nodeName){const ie=P(y.nodeName);if(!I[ie]||De[ie])throw qe("root node is forbidden and cannot be sanitized in-place")}}else if(y instanceof i)f=Rn("<!---->"),m=f.ownerDocument.importNode(y,!0),m.nodeType===Ve.element&&m.nodeName==="BODY"||m.nodeName==="HTML"?f=m:f.appendChild(m);else{if(!Te&&!_e&&!me&&y.indexOf("<")===-1)return O&&tt?O.createHTML(y):y;if(f=Rn(y),!f)return Te?null:tt?pe:""}f&&Nt&&J(f.firstChild);const M=Ln($e?y:f);for(;N=M.nextNode();)On(N),Dn(N),N.content instanceof o&&ol(N.content);if($e)return y;if(Te){if(et)for(W=qr.call(f.ownerDocument);f.firstChild;)W.appendChild(f.firstChild);else W=f;return(D.shadowroot||D.shadowrootmode)&&(W=Vr.call(r,W,!0)),W}let q=me?f.outerHTML:f.innerHTML;return me&&I["!doctype"]&&f.ownerDocument&&f.ownerDocument.doctype&&f.ownerDocument.doctype.name&&F(Hr,f.ownerDocument.doctype.name)&&(q="<!DOCTYPE "+f.ownerDocument.doctype.name+`>
`+q),_e&&at([St,xt,vt],ie=>{q=je(q,ie," ")}),O&&tt?O.createHTML(q):q},e.setConfig=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ot(y),Tt=!0},e.clearConfig=function(){Le=null,Tt=!1},e.isValidAttribute=function(y,c,f){Le||Ot({});const m=P(y),N=P(c);return In(m,N,f)},e.addHook=function(y,c){typeof c=="function"&&Be(U[y],c)},e.removeHook=function(y,c){if(c!==void 0){const f=ls(U[y],c);return f===-1?void 0:os(U[y],f,1)[0]}return rr(U[y])},e.removeHooks=function(y){U[y]=[]},e.removeAllHooks=function(){U=ur()},e}var Ss=Br();v.setOptions({gfm:!0,breaks:!0,tables:!0,headerIds:!1,mangle:!1});const xs=["p","br","strong","em","u","strike","del","s","h1","h2","h3","h4","h5","h6","ul","ol","li","blockquote","code","pre","table","thead","tbody","tr","th","td","a","img","hr","div","span"],vs={a:["href","title"],img:["src","alt","title","width","height"],table:["class"],th:["align","class"],td:["align","class"],code:["class"],pre:["class"],div:["class"],span:["class"]};function Es(t){if(!t||typeof t!="string")return"";try{const e=v(t);return Ss.sanitize(e,{ALLOWED_TAGS:xs,ALLOWED_ATTR:vs,ALLOW_DATA_ATTR:!1,ALLOW_UNKNOWN_PROTOCOLS:!1,FORBID_SCRIPT:!0,FORBID_TAGS:["script","object","embed","form","input","button"],FORBID_ATTR:["onload","onerror","onclick","onmouseover","onfocus","onblur"]})}catch(e){return console.error("Error rendering markdown:",e),t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}}function _s(t){const{worldName:e,messages:n=[],userInput:r="",messagesLoading:l,isSending:o,isWaiting:a,activeAgent:i,selectedAgent:h}=t,d=u=>{if(!u.fromAgentId||u.sender==="HUMAN"||u.sender==="USER"||u.type==="user"||u.sender==="system"||u.sender==="SYSTEM")return!1;const b=u.sender.toLowerCase(),g=u.fromAgentId.toLowerCase();return!(b.includes(g)||g.includes(b))};return s.h("fieldset",{className:"chat-fieldset"},s.h("legend",null,e),s.h("div",{className:"chat-container"},s.h("div",{className:"conversation-area",ref:u=>u.scrollTop=u.scrollHeight},l?s.h("div",{className:"loading-messages"},"Loading messages..."):n.length===0?s.h("div",{className:"no-messages"},"No messages yet. Start a conversation!"):n.filter(u=>u.sender==="HUMAN"||u.sender==="USER"||u.type==="user"||u.sender==="system"||u.sender==="SYSTEM"?!0:h!=null&&h.id&&u.fromAgentId!==h.id?!1:u.isStreaming===!0&&u.streamComplete!==!0||u.streamComplete===!0||u.streamComplete===void 0&&u.isStreaming===void 0).map((u,b)=>{const g=d(u),C=`message ${u.sender==="HUMAN"||u.sender==="USER"||u.type==="user"?"user-message":"agent-message"} ${g?"cross-agent-message":""}`.trim();return s.h("div",{key:u.id||b,className:C},s.h("div",{className:"message-sender"},u.sender||(u.type==="user"?"User":"Agent"),g&&u.fromAgentId&&s.h("span",{className:"source-agent-indicator",title:`From agent: ${u.fromAgentId}`},"→ ",u.fromAgentId)),s.h("div",{className:"message-content",dangerouslySetInnerHTML:{__html:Es(u.text)}}),s.h("div",{className:"message-timestamp"},u.createdAt?new Date(u.createdAt).toLocaleTimeString():"Now"),u.isStreaming&&s.h("div",{className:"streaming-indicator"},s.h("div",{className:"streaming-content"},s.h("div",{className:`agent-sprite sprite-${(i==null?void 0:i.spriteIndex)??0}`}),s.h("span",null,"responding ..."))),u.hasError&&s.h("div",{className:"error-indicator"},"Error: ",u.errorMessage))}),a&&s.h("div",{className:"message user-message waiting-message"},s.h("div",{className:"message-content"},s.h("div",{className:"waiting-dots"},s.h("span",null,"."),s.h("span",null,"."),s.h("span",null,"."))))),s.h("div",{className:"input-area"},s.h("div",{className:"input-container"},s.h("input",{type:"text",className:"message-input",placeholder:"Type your message...",value:r||"",$oninput:"update-input",$onkeypress:"key-press"}),s.h("button",{className:"send-button",$onclick:"send-message",disabled:!r.trim()||o},o?"Sending...":"Send")))))}function Ts(t){const{world:e,selectedSettingsTarget:n,selectedAgent:r,totalMessages:l}=t,o=()=>{n==="agent"&&r?confirm(`Clear all messages for agent ${r.name}?`)&&s.run("clear-agent-messages",r):n==="world"&&e&&confirm(`Clear all messages for world ${e.name}?`)&&s.run("clear-world-messages")};return s.h("fieldset",{className:"settings-fieldset"},s.h("legend",null,n==="agent"&&r?`${r.name} Settings`:n==="world"&&e?`${e.name} Settings`:"Settings"),s.h("div",{className:"chat-settings"},n==="agent"&&r?s.h("div",{className:"agent-settings"},s.h("div",{className:"setting-item"},s.h("label",null,"Agent Name:"),s.h("span",null,s.h("span",{className:"setting-value"},r.name),s.h("button",{className:"action-btn",$onclick:["open-agent-edit",r],title:"Edit agent"},s.h("span",{className:"btn-icon"},"⚙")))),s.h("div",{className:"setting-item"},s.h("label",null,"Message Count:"),s.h("span",null,s.h("span",{className:"setting-value"},r.messageCount),s.h("button",{className:"action-btn",onclick:o,title:"Clear agent messages"},s.h("span",{className:"btn-icon"},"×")))),s.h("div",{className:"setting-item"},s.h("label",null,"LLM Provider:"),s.h("span",{className:"setting-value"},r.provider||"N/A")),s.h("div",{className:"setting-item"},s.h("label",null,"Model:"),s.h("span",{className:"setting-value"},r.model||"N/A")),s.h("div",{className:"setting-item"},s.h("label",null,"Temperature:"),s.h("span",{className:"setting-value"},r.temperature!==void 0?r.temperature:"N/A")),s.h("div",{className:"setting-item"},s.h("label",null,"System Prompt:"),s.h("span",{className:"system-prompt-preview"},r.systemPrompt?r.systemPrompt.length>100?r.systemPrompt.substring(0,100)+"...":r.systemPrompt:"N/A"))):n==="world"&&e?s.h("div",{className:"world-settings"},s.h("div",{className:"setting-item"},s.h("label",null,"World Name:"),s.h("span",null,s.h("span",{className:"setting-value"},e.name),s.h("button",{className:"action-btn",$onclick:"open-world-edit",title:"Edit world"},s.h("span",{className:"btn-icon"},"⚙")))),s.h("div",{className:"setting-item"},s.h("label",null,"Agents Count:"),s.h("span",null,s.h("span",{className:"setting-value"},e.agents.length),s.h("button",{className:"action-btn",$onclick:"open-agent-create",title:"Add new agent"},s.h("span",{className:"btn-icon"},"+")))),s.h("div",{className:"setting-item"},s.h("label",null,"Total Messages:"),s.h("span",null,s.h("span",{className:"setting-value"},l),s.h("button",{className:"action-btn",$onclick:o,title:"Clear all messages"},s.h("span",{className:"btn-icon"},"×")))),s.h("div",{className:"setting-item"},s.h("label",null,"LLM Call Limit:"),s.h("span",{className:"setting-value"},e.llmCallLimit||"Unlimited"))):s.h("div",{className:"default-settings"},s.h("p",null,"Click on an agent or the gear icon to view settings"))))}const Ns=t=>({mode:t.mode||"create",worldName:t.worldName,agent:t.agent||jr,parentComponent:t.parentComponent,loading:!1}),jr={name:"",description:"",provider:"ollama",model:"llama3.2:3b",temperature:.7,systemPrompt:"You are a helpful assistant."},dr=async function*(t){if(!t.agent.name.trim()){yield{...t,error:"Agent name is required"};return}yield{...t,loading:!0,error:null};try{t.mode==="create"?await ne.createAgent(t.worldName,t.agent):await ne.updateAgent(t.worldName,t.agent.name,t.agent);const e=t.mode==="create"?"Agent created successfully!":"Agent updated successfully!";yield{...t,loading:!1,successMessage:e},setTimeout(()=>{t.parentComponent.run("agent-saved")},2e3)}catch(e){yield{...t,loading:!1,error:e.message||"Failed to save agent"}}},hr=async function*(t){yield{...t,loading:!0,error:null};try{await ne.deleteAgent(t.worldName,t.agent.name),yield{...t,loading:!1,successMessage:"Agent deleted successfully!"},setTimeout(()=>{t.parentComponent.run("agent-deleted")},2e3)}catch(e){yield{...t,loading:!1,error:e.message||"Failed to delete agent"}}},Ae=t=>{t!=null&&t.parentComponent&&typeof t.parentComponent.run=="function"?t.parentComponent.run("close-agent-edit"):s.run("close-agent-edit")};class Cs extends Se{constructor(){super(...arguments);A(this,"mounted",n=>Ns(n));A(this,"state",{mode:"create",worldName:"",agent:jr,parentComponent:void 0,loading:!0});A(this,"view",n=>{if(n.loading)return s.h("div",{className:"modal-backdrop"},s.h("div",{className:"modal-content"},s.h("div",{className:"modal-body"},s.h("div",{className:"loading-spinner"},n.mode==="create"?"Creating agent...":n.mode==="edit"?"Updating agent...":"Deleting agent..."))));if(n.successMessage)return s.h("div",{className:"modal-backdrop",$onclick:Ae},s.h("div",{className:"modal-content",onclick:a=>a.stopPropagation()},s.h("div",{className:"modal-header"},s.h("h2",{className:"modal-title"},"Success!"),s.h("button",{className:"modal-close-btn",$onclick:Ae,title:"Close"},"×")),s.h("div",{className:"modal-body"},s.h("div",{className:"success-message"},s.h("p",{style:"font-size: 1rem;"},n.successMessage),s.h("div",{className:"loading-spinner",style:"font-size: 0.9rem;"},"Closing...")))));const r=n.mode==="edit",l=n.mode==="delete";let o;return l?o=`Delete ${n.agent.name||"Agent"}`:r?o=`Edit ${n.agent.name||"Agent"}`:o="Create New Agent",s.h("div",{className:"modal-backdrop",$onclick:Ae},s.h("div",{className:"modal-content",onclick:a=>a.stopPropagation()},s.h("div",{className:"modal-header"},s.h("h2",{className:"modal-title"},o),s.h("button",{className:"modal-close-btn",$onclick:Ae,title:"Close"},"×")),s.h("div",{className:"modal-body"},n.error&&s.h("div",{className:"error-message"},n.error),l?s.h("div",{className:"delete-confirmation"},s.h("p",{style:"font-size: 1rem;"},"Are you sure you want to delete ",s.h("span",{style:"font-size: 1.2rem;"},'"',n.agent.name,'"'),"?"),s.h("p",{style:"font-size: 1rem;"},"This action cannot be undone.")):s.h("form",{className:"agent-form"},s.h("div",{className:"form-section"},s.h("div",{className:"form-row"},s.h("div",{className:"form-group"},s.h("label",{htmlFor:"agent-name"},"Agent Name *"),s.h("input",{id:"agent-name",type:"text",className:"form-input",placeholder:"Enter agent name",value:n.agent.name,$bind:"agent.name",disabled:n.loading||r})),s.h("div",{className:"form-group"},s.h("label",{htmlFor:"agent-temperature"},"Temperature"),s.h("input",{id:"agent-temperature",type:"number",className:"form-input",placeholder:"0.0 - 2.0",min:"0",max:"2",step:"0.1",value:n.agent.temperature,$bind:"agent.temperature",disabled:n.loading})))),s.h("div",{className:"form-section"},s.h("div",{className:"form-row"},s.h("div",{className:"form-group"},s.h("label",{htmlFor:"agent-provider"},"Provider"),s.h("select",{id:"agent-provider",className:"form-select",value:n.agent.provider,$bind:"agent.provider",disabled:n.loading},s.h("option",{value:""},"Select provider"),s.h("option",{value:"openai"},"OpenAI"),s.h("option",{value:"anthropic"},"Anthropic"),s.h("option",{value:"google"},"Google"),s.h("option",{value:"microsoft"},"Azure-OpenAI"),s.h("option",{value:"ollama"},"Ollama (Local)"))),s.h("div",{className:"form-group"},s.h("label",{htmlFor:"agent-model"},"Model"),s.h("input",{id:"agent-model",type:"text",className:"form-input",placeholder:"e.g. gpt-4, claude-3-sonnet, llama3.2:3b",value:n.agent.model,$bind:"agent.model",disabled:n.loading})))),s.h("div",{className:"form-section"},s.h("div",{className:"form-group"},s.h("label",{htmlFor:"agent-prompt"},"System Prompt"),s.h("textarea",{id:"agent-prompt",className:"form-textarea",placeholder:"Enter the system prompt for this agent...",rows:8,value:n.agent.systemPrompt,$bind:"agent.systemPrompt",disabled:n.loading}))))),s.h("div",{className:"modal-footer"},s.h("div",{className:"modal-actions"},l?s.h("div",{className:"modal-primary-actions",style:"margin-left: auto;"},s.h("button",{className:"btn btn-secondary",$onclick:Ae,disabled:n.loading},"Cancel"),s.h("button",{className:"btn btn-danger",$onclick:[hr],disabled:n.loading},n.loading?"Deleting...":"Delete")):r?s.h(s.Fragment,null,s.h("button",{className:"btn btn-danger",$onclick:[hr],disabled:n.loading,title:"Delete agent"},n.loading?"Deleting...":"Delete"),s.h("div",{className:"modal-primary-actions"},s.h("button",{className:"btn btn-secondary",$onclick:Ae,disabled:n.loading},"Cancel"),s.h("button",{className:"btn btn-primary",$onclick:[dr],disabled:n.loading||!n.agent.name.trim()},n.loading?"Saving...":"Update"))):s.h("div",{className:"modal-primary-actions",style:"margin-left: auto;"},s.h("button",{className:"btn btn-secondary",$onclick:Ae,disabled:n.loading},"Cancel"),s.h("button",{className:"btn btn-primary",$onclick:[dr],disabled:n.loading||!n.agent.name.trim()},n.loading?"Saving...":"Create"))))))})}}const te=(t,e)=>{s!=null&&s.run?s.run(t,e):console.warn("AppRun app not available for event:",t)};let Z={activeMessages:new Map,currentWorldName:null};const Rs=t=>{var e;!t||typeof t!="object"||(t.type==="sse"?Ls(t):t.type==="message"?te("handleMessage",t):t.type==="response"||(t.type==="error"?te("handleError",{message:t.message||"SSE error"}):t.type==="connected"?(te("handleConnectionStatus","connected"),Z.currentWorldName=((e=t.payload)==null?void 0:e.worldName)||null):t.type==="complete"&&te("handleComplete",t.payload)))},Ls=t=>{const e=t.data;if(!e)return;const n=e.messageId||"default",r=e.sender||"Agent";switch(e.type){case"start":Z.activeMessages.set(n,{content:"",sender:r,messageId:n,isStreaming:!0}),te("handleStreamStart",{messageId:n,sender:r,worldName:e.worldName||Z.currentWorldName});break;case"chunk":const l=Z.activeMessages.get(n);if(l){const a=e.accumulatedContent!==void 0?e.accumulatedContent:l.content+(e.content||"");l.content=a,te("handleStreamChunk",{messageId:n,sender:r,content:a,isAccumulated:e.accumulatedContent!==void 0,worldName:e.worldName||Z.currentWorldName})}break;case"end":const o=Z.activeMessages.get(n);if(o){const a=e.finalContent!==void 0?e.finalContent:o.content;te("handleStreamEnd",{messageId:n,sender:r,content:a,worldName:e.worldName||Z.currentWorldName}),Z.activeMessages.delete(n),Z.activeMessages.size}break;case"error":te("handleStreamError",{messageId:n,sender:r,error:e.error||"Streaming error",worldName:e.worldName||Z.currentWorldName}),Z.activeMessages.delete(n);break}};async function Ms(t,e,n="HUMAN",r,l,o){if(!t||!e)throw new Error("World name and message are required");if(!e.trim())throw new Error("Message cannot be empty");Z.currentWorldName=t;const a={message:e,sender:n},h=(await Y(`/worlds/${encodeURIComponent(t)}/chat`,{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json",Accept:"text/event-stream","Cache-Control":"no-cache"}})).body.getReader(),d=new TextDecoder;let u="",b=!0;const g=()=>{if(b){b=!1;try{h.cancel()}catch(w){console.warn("Error canceling SSE reader:",w)}}};return(async()=>{try{for(;b;){const{done:w,value:C}=await h.read();if(w)break;u+=d.decode(C,{stream:!0});const he=u.split(`
`);u=he.pop()||"";for(const re of he)if(re.trim()!==""&&re.startsWith("data: "))try{const le=re.slice(6).trim();if(le==="")continue;const K=JSON.parse(le);Rs(K),K.type}catch(le){console.error("Error parsing SSE data:",le),te("handleError",{message:"Failed to parse SSE data"})}}}catch(w){console.error("SSE stream error:",w);const C={message:w.message||"SSE stream error"};te("handleError",C)}finally{g()}})(),g}const Os=(t,e)=>{const{messageId:n,sender:r,worldName:l}=e,o=r||"Agent";let a;if("agents"in t&&Array.isArray(t.agents)){const i=t.agents.find(h=>h.name===o);a=i==null?void 0:i.id}return{...t,messages:[...t.messages||[],{id:Date.now()+Math.random(),type:"agent-stream",sender:o,text:"",createdAt:new Date().toISOString(),worldName:l||t.worldName,isStreaming:!0,messageId:n,fromAgentId:a}],needScroll:!0}},Is=(t,e)=>{const{messageId:n,sender:r,content:l,isAccumulated:o}=e,a=[...t.messages||[]];for(let i=a.length-1;i>=0;i--)if(a[i].isStreaming&&(a[i].messageId===n||!n&&a[i].sender===r&&a[i].type==="agent-stream"))return a[i]={...a[i],text:l||"",createdAt:new Date().toISOString()},{...t,messages:a,needScroll:!0};return{...t,messages:[...a,{id:Date.now()+Math.random(),type:"agent-stream",sender:r||"Agent",text:l||"",createdAt:new Date().toISOString(),worldName:e.worldName||t.worldName,isStreaming:!0,messageId:n}],needScroll:!0}},Ps=(t,e)=>{const{messageId:n,sender:r,content:l}=e,o=(t.messages||[]).filter(a=>!(a.isStreaming&&(a.messageId===n||!n&&a.sender===r&&a.type==="agent-stream")));return{...t,messages:o}},Ds=(t,e)=>{const{messageId:n,sender:r,error:l}=e,o=(t.messages||[]).map(a=>a.isStreaming&&(a.messageId===n||!n&&a.sender===r&&a.type==="agent-stream")?{...a,isStreaming:!1,hasError:!0,errorMessage:l}:a);return{...t,messages:o}},$s=(t,e)=>{const n=e.data||{},r=n.sender||n.agentName||"Agent";let l;if("agents"in t&&Array.isArray(t.agents)){const a=t.agents.find(i=>i.name===r);l=a==null?void 0:a.id}const o={id:Date.now()+Math.random(),type:n.type||"message",sender:r,text:n.content||n.message||"",createdAt:n.createdAt||new Date().toISOString(),worldName:n.worldName||t.worldName,fromAgentId:l};return{...t,messages:[...t.messages||[],o],needScroll:!0,isWaiting:!1}},Ws=(t,e)=>({...t,connectionStatus:e,wsError:e==="error"?t.wsError:null}),zs=(t,e)=>{const n=e.message||"SSE error",r={id:Date.now()+Math.random(),type:"error",sender:"System",text:n,createdAt:new Date().toISOString(),worldName:t.worldName,hasError:!0};return{...t,wsError:n,messages:[...t.messages||[],r],needScroll:!0}},Us=(t,e)=>({...t,connectionStatus:"completed"}),Fs={"/World":async function*(t,e){if(!e){location.href="/";return}const n=decodeURIComponent(e);try{yield{...t,worldName:n,loading:!0,error:null,isWaiting:!1,activeAgent:null};const r=await ne.getWorld(n);if(!r){yield{...t,worldName:n,loading:!1,error:"World not found",isWaiting:!1,selectedSettingsTarget:"world",selectedAgent:null,activeAgent:null};return}const l=new Map,o=await Promise.all(r.agents.map(async(i,h)=>{var u;i.memory&&Array.isArray(i.memory)&&i.memory.forEach(b=>{const g=`${b.createdAt||Date.now()}-${b.text||b.content||""}`;if(!l.has(g)){const x=b.sender||i.name;let w="agent";(x==="HUMAN"||x==="USER")&&(w="user"),l.set(g,{id:b.id||g,sender:x,text:b.text||b.content||"",createdAt:b.createdAt||new Date().toISOString(),type:w,streamComplete:!0,fromAgentId:i.id})}});const d=i.systemPrompt||"";return{...i,spriteIndex:h%9,messageCount:((u=i.memory)==null?void 0:u.length)||0,provider:i.provider||"openai",model:i.model||"gpt-4",temperature:i.temperature??.7,systemPrompt:d,description:i.description||"",type:i.type||"default",status:i.status||"active",llmCallCount:i.llmCallCount||0,memory:i.memory||[],createdAt:i.createdAt||new Date,lastActive:i.lastActive||new Date}})),a=Array.from(l.values()).sort((i,h)=>{const d=new Date(i.createdAt).getTime(),u=new Date(h.createdAt).getTime();return d-u});yield{...t,worldName:n,world:{name:n,agents:o,llmCallLimit:r.llmCallLimit||r.turnLimit},agents:o,messages:a,loading:!1,error:null,isWaiting:!1,selectedSettingsTarget:"world",selectedAgent:null,activeAgent:null}}catch(r){yield{...t,worldName:n,world:{name:n,agents:[],llmCallLimit:void 0},loading:!1,error:r.message||"Failed to load world data",isWaiting:!1,selectedSettingsTarget:"world",selectedAgent:null,activeAgent:null}}},"update-input":(t,e)=>({...t,userInput:e.target.value}),"key-press":(t,e)=>{e.key==="Enter"&&(t.userInput||"").trim()&&s.run("send-message")},"send-message":async t=>{if(!(t.userInput||"").trim())return t;const e=t.userInput||"",n={id:Date.now()+Math.random(),type:"user",sender:"HUMAN",text:e,createdAt:new Date().toISOString(),worldName:t.worldName,userEntered:!0},r={...t,messages:[...t.messages||[],n],userInput:"",isSending:!0,isWaiting:!0};try{return await Ms(t.worldName,e,"HUMAN"),{...r,isSending:!1}}catch(l){return{...r,isSending:!1,isWaiting:!1,error:l.message||"Failed to send message"}}},handleStreamStart:(t,e)=>{const n=Os(t,e),r=e.sender,l=t.agents.find(o=>o.name===r);return{...n,isWaiting:!1,activeAgent:l?{spriteIndex:l.spriteIndex,name:l.name}:null}},handleStreamChunk:(t,e)=>Is(t,e),handleStreamEnd:(t,e)=>{var o;const n=Ps(t,e),r=e.sender;let l={...n,activeAgent:null};if(r&&r!=="HUMAN"){const a=l.agents.map(d=>d.name===r?{...d,messageCount:d.messageCount+1}:d),i=l.world?{...l.world,agents:a}:null,h=((o=l.selectedAgent)==null?void 0:o.name)===r?{...l.selectedAgent,messageCount:l.selectedAgent.messageCount+1}:l.selectedAgent;l={...l,world:i,agents:a,selectedAgent:h}}return l},handleStreamError:(t,e)=>({...Ds(t,e),activeAgent:null}),handleMessage:(t,e)=>$s(t,e),handleConnectionStatus:(t,e)=>Ws(t,e),handleError:(t,e)=>zs(t,e),handleComplete:(t,e)=>Us(t),"clear-agent-messages":async(t,e)=>{var n;try{await ne.clearAgentMemory(t.worldName,e.name);const r=t.agents.map(i=>i.id===e.id?{...i,messageCount:0}:i),l=(t.messages||[]).filter(i=>i.sender!==e.name),o=((n=t.selectedAgent)==null?void 0:n.id)===e.id?{...t.selectedAgent,messageCount:0}:t.selectedAgent,a=t.world?{...t.world,agents:r}:null;return{...t,world:a,agents:r,messages:l,selectedAgent:o}}catch(r){return{...t,error:r.message||"Failed to clear agent messages"}}},"clear-world-messages":async t=>{try{await Promise.all(t.agents.map(l=>ne.clearAgentMemory(t.worldName,l.name)));const e=t.agents.map(l=>({...l,messageCount:0})),n=t.selectedAgent?{...t.selectedAgent,messageCount:0}:null,r=t.world?{...t.world,agents:e}:null;return{...t,world:r,agents:e,messages:[],selectedAgent:n}}catch(e){return{...t,error:e.message||"Failed to clear world messages"}}},"select-world-settings":t=>({...t,selectedSettingsTarget:"world",selectedAgent:null,messages:(t.messages||[]).filter(e=>!e.userEntered)}),"select-agent-settings":(t,e)=>{var n;return t.selectedSettingsTarget==="agent"&&((n=t.selectedAgent)==null?void 0:n.id)===e.id?{...t,selectedSettingsTarget:"world",selectedAgent:null,messages:(t.messages||[]).filter(r=>!r.userEntered),userInput:""}:{...t,selectedSettingsTarget:"agent",selectedAgent:e,messages:(t.messages||[]).filter(r=>!r.userEntered),userInput:"@"+e.name+" "}}};class Hs extends Se{constructor(){super(...arguments);A(this,"state",async()=>({worldName:"World",world:null,agents:[],messages:[],userInput:"",loading:!0,error:null,messagesLoading:!1,isSending:!1,isWaiting:!1,selectedSettingsTarget:"world",selectedAgent:null,activeAgent:null,showAgentEdit:!1,agentEditMode:"create",selectedAgentForEdit:null,showWorldEdit:!1,worldEditMode:"edit",selectedWorldForEdit:null,connectionStatus:"disconnected",wsError:null,needScroll:!1}));A(this,"view",n=>{var r;return n.loading?s.h("div",{className:"world-container"},s.h("div",{className:"world-columns"},s.h("div",{className:"chat-column"},s.h("div",{className:"agents-section"},s.h("div",{className:"agents-row"},s.h("div",{className:"loading-agents"},"Loading..."))),s.h("div",{className:"loading-state"},s.h("p",null,"Loading world data..."))),s.h("div",{className:"settings-column"},s.h("div",{className:"settings-section"},s.h("div",{className:"settings-row"},s.h("button",{className:"world-settings-btn",title:"World Settings"},s.h("span",{className:"world-gear-icon"},"⚙"))))))):n.error?s.h("div",{className:"world-container"},s.h("div",{className:"world-columns"},s.h("div",{className:"chat-column"},s.h("div",{className:"agents-section"},s.h("div",{className:"agents-row"},s.h("div",{className:"no-agents"},"Error"))),s.h("div",{className:"error-state"},s.h("p",null,"Error: ",n.error),s.h("button",{$onclick:["/World",n.worldName]},"Retry"))),s.h("div",{className:"settings-column"},s.h("div",{className:"settings-section"},s.h("div",{className:"settings-row"},s.h("button",{className:"world-settings-btn",title:"World Settings"},s.h("span",{className:"world-gear-icon"},"⚙"))))))):s.h("div",{className:"world-container"},s.h("div",{className:"world-columns"},s.h("div",{className:"chat-column"},s.h("div",{className:"agents-section"},s.h("div",{className:"agents-row agents-row-with-back"},s.h("div",{className:"back-button-container"},s.h("a",{href:"/"},s.h("button",{className:"back-button",title:"Back to Worlds"},s.h("span",{className:"world-back-icon"},"←")))),s.h("div",{className:"agents-list-container"},n.loading?s.h("div",{className:"loading-agents"},"Loading agents..."):(r=n.agents)!=null&&r.length?s.h("div",{className:"agents-list"},n.agents.map((l,o)=>{var i;const a=n.selectedSettingsTarget==="agent"&&((i=n.selectedAgent)==null?void 0:i.id)===l.id;return s.h("div",{key:`agent-${l.id||o}`,className:`agent-item ${a?"selected":""}`,$onclick:["select-agent-settings",l]},s.h("div",{className:"agent-sprite-container"},s.h("div",{className:`agent-sprite sprite-${l.spriteIndex}`}),s.h("div",{className:"message-badge"},l.messageCount)),s.h("div",{className:"agent-name"},l.name))})):s.h("div",{className:"no-agents"},"No agents in this world")))),s.h(_s,{worldName:n.worldName,messages:n.messages,userInput:n.userInput,messagesLoading:n.messagesLoading,isSending:n.isSending,isWaiting:n.isWaiting,activeAgent:n.activeAgent,selectedAgent:n.selectedSettingsTarget==="agent"?n.selectedAgent:null})),s.h("div",{className:"settings-column"},s.h("div",{className:"settings-section"},s.h("div",{className:"settings-row"},s.h("button",{className:"world-settings-btn",title:"World Settings",$onclick:"select-world-settings"},s.h("span",{className:"world-gear-icon"},"⊕")))),s.h(Ts,{world:n.world,selectedSettingsTarget:n.selectedSettingsTarget,selectedAgent:n.selectedAgent,totalMessages:(n.messages||[]).length}))),n.showAgentEdit&&s.h(Cs,{agent:n.selectedAgentForEdit,mode:n.agentEditMode,worldName:n.worldName,parentComponent:this}),n.showWorldEdit&&s.h(Tr,{world:n.selectedWorldForEdit,mode:n.worldEditMode,parentComponent:this}))});A(this,"is_global_event",()=>!0);A(this,"update",{...Fs,"open-agent-create":n=>({...n,showAgentEdit:!0,agentEditMode:"create",selectedAgentForEdit:null}),"open-agent-edit":(n,r)=>({...n,showAgentEdit:!0,agentEditMode:"edit",selectedAgentForEdit:r}),"open-agent-delete":(n,r)=>({...n,showAgentEdit:!0,agentEditMode:"delete",selectedAgentForEdit:r}),"close-agent-edit":n=>({...n,showAgentEdit:!1}),"open-world-edit":n=>({...n,showWorldEdit:!0,worldEditMode:"edit",selectedWorldForEdit:n.world}),"close-world-edit":n=>({...n,showWorldEdit:!1}),"agent-saved":n=>{location.reload()},"agent-deleted":n=>{location.reload()}})}}s.render("#root",s.h(ro,null));s.addComponents("#pages",{"/":yo,"/World":Hs});
