var al=Object.defineProperty;var cl=(t,e,n)=>e in t?al(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var A=(t,e,n)=>cl(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(l){if(l.ep)return;l.ep=!0;const o=n(l);fetch(l.href,o)}})();const gr="3.38.0",ul=`AppRun-${gr}`;class fr{constructor(){this._events={}}on(e,n,r={}){this._events[e]=this._events[e]||[],this._events[e].push({fn:n,options:r})}off(e,n){const r=this._events[e]||[];this._events[e]=r.filter(l=>l.fn!==n)}find(e){return this._events[e]}run(e,...n){const r=this.getSubscribers(e,this._events);return console.assert(r&&r.length>0,"No subscriber for event: "+e),r.forEach(l=>{const{fn:o,options:i}=l;if(!o||typeof o!="function")return console.error(`AppRun event handler for '${e}' is not a function:`,o),!1;if(i.delay)this.delay(e,o,n,i);else try{Object.keys(i).length>0?o.apply(this,[...n,i]):o.apply(this,n)}catch(a){console.error(`Error in event handler for '${e}':`,a)}return!l.options.once}),r.length}once(e,n,r={}){this.on(e,n,{...r,once:!0})}delay(e,n,r,l){l._t&&clearTimeout(l._t),l._t=setTimeout(()=>{clearTimeout(l._t);try{Object.keys(l).length>0?n.apply(this,[...r,l]):n.apply(this,r)}catch(o){console.error(`Error in delayed event handler for '${e}':`,o)}},l.delay)}runAsync(e,...n){const r=this.getSubscribers(e,this._events);console.assert(r&&r.length>0,"No subscriber for event: "+e);const l=r.map(o=>{const{fn:i,options:a}=o;if(!i||typeof i!="function")return console.error(`AppRun async event handler for '${e}' is not a function:`,i),Promise.resolve(null);try{return Object.keys(a).length>0?i.apply(this,[...n,a]):i.apply(this,n)}catch(u){return console.error(`Error in async event handler for '${e}':`,u),Promise.reject(u)}});return Promise.all(l)}query(e,...n){return console.warn("app.query() is deprecated. Use app.runAsync() instead."),this.runAsync(e,...n)}getSubscribers(e,n){const r=n[e]||[];return n[e]=r.filter(l=>!l.options.once),Object.keys(n).filter(l=>l.endsWith("*")&&e.startsWith(l.replace("*",""))).sort((l,o)=>o.length-l.length).forEach(l=>r.push(...n[l].map(o=>({...o,options:{...o.options,event:e}})))),r}}const dl=ul;let ut;const ze=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};ze.app&&ze._AppRunVersions?ut=ze.app:(ut=new fr,ze.app=ut,ze._AppRunVersions=dl);const _=ut;function be(t){return(t==null?void 0:t.target)instanceof HTMLElement?t.target:null}function hl(t,e=document){try{return e.querySelector(t)}catch(n){return console.warn(`Invalid selector: ${t}`,n),null}}function pl(t){try{return document.getElementById(t)}catch(e){return console.warn(`Error getting element by id: ${t}`,e),null}}const mr=t=>{if(!t)return[];const e=[];let n="",r=!1,l="";for(let o=0;o<t.length;o++){const i=t[o];i==="["&&!r?(n&&(e.push(n),n=""),r=!0):i==="]"&&r?(l?n=n.slice(1,-1):/^\d+$/.test(n)&&(n=parseInt(n,10)),e.push(n),n="",r=!1,l=""):(i==='"'||i==="'")&&r?(l?i===l&&(l=""):l=i,n+=i):i==="."&&!r?n&&(e.push(n),n=""):n+=i}return n&&e.push(n),e},gl=(t,e)=>{let n=t;for(const r of e){if(n==null)return;n=n[r]}return n},fl=(t,e,n)=>{if(e.length===0)return n;const r={...t};let l=r;for(let o=0;o<e.length-1;o++){const i=e[o],a=e[o+1];l[i]==null?l[i]=typeof a=="number"?[]:{}:Array.isArray(l[i])?l[i]=[...l[i]]:typeof l[i]=="object"&&(l[i]={...l[i]}),l=l[i]}return l[e[e.length-1]]=n,r},ye=(t,e)=>{if(!e)return t.state||"";const n=mr(e),r=gl(t.state,n);return r!==void 0?r:""},we=(t,e,n)=>{if(!e){t.setState(n);return}const r=mr(e),l=t.state||{},o=fl(l,r,n);t.setState(o)},ml=(t,e,n,r)=>{if(t.startsWith("$on")){const l=e[t];if(t=t.substring(1),typeof l=="boolean")e[t]=o=>r.run?r.run(t,o):_.run(t,o);else if(typeof l=="string")e[t]=o=>r.run?r.run(l,o):_.run(l,o);else if(typeof l=="function")e[t]=o=>r.setState(l(r.state,o));else if(Array.isArray(l)){const[o,...i]=l;typeof o=="string"?e[t]=a=>r.run?r.run(o,...i,a):_.run(o,...i,a):typeof o=="function"&&(e[t]=a=>r.setState(o(r.state,...i,a)))}}else if(t==="$bind"){const l=e.type||"text",o=typeof e[t]=="string"?e[t]:e.name;if(n==="input")switch(l){case"checkbox":e.checked=ye(r,o),e.onclick=i=>{const a=be(i);a&&we(r,o||a.name,a.checked)};break;case"radio":e.checked=ye(r,o)===e.value,e.onclick=i=>{const a=be(i);a&&we(r,o||a.name,a.value)};break;case"number":case"range":e.value=ye(r,o),e.oninput=i=>{const a=be(i);a&&we(r,o||a.name,Number(a.value))};break;default:e.value=ye(r,o),e.oninput=i=>{const a=be(i);a&&we(r,o||a.name,a.value)}}else n==="select"?(e.value=ye(r,o),e.onchange=i=>{const a=be(i);a&&!a.multiple&&we(r,o||a.name,a.value)}):n==="option"?(e.selected=ye(r,o),e.onclick=i=>{const a=be(i);a&&we(r,o||a.name,a.selected)}):n==="textarea"&&(e.innerHTML=ye(r,o),e.oninput=i=>{const a=be(i);a&&we(r,o||a.name,a.value)})}else _.run("$",{key:t,tag:n,props:e,component:r})},ft=(t,e)=>{if(Array.isArray(t))return t.map(n=>ft(n,e));{let{type:n,tag:r,props:l,children:o}=t;return r=r||n,o=o||(l==null?void 0:l.children),l&&Object.keys(l).forEach(i=>{i.startsWith("$")&&(ml(i,l,r,e),delete l[i])}),o&&ft(o,e),t}};class Ke{constructor(e,n,r){this.normal=n,this.property=e,r&&(this.space=r)}}Ke.prototype.normal={};Ke.prototype.property={};Ke.prototype.space=void 0;function br(t,e){const n={},r={};for(const l of t)Object.assign(n,l.property),Object.assign(r,l.normal);return new Ke(n,r,e)}function Gt(t){return t.toLowerCase()}class V{constructor(e,n){this.attribute=n,this.property=e}}V.prototype.attribute="";V.prototype.booleanish=!1;V.prototype.boolean=!1;V.prototype.commaOrSpaceSeparated=!1;V.prototype.commaSeparated=!1;V.prototype.defined=!1;V.prototype.mustUseProperty=!1;V.prototype.number=!1;V.prototype.overloadedBoolean=!1;V.prototype.property="";V.prototype.spaceSeparated=!1;V.prototype.space=void 0;let bl=0;const w=ve(),L=ve(),Vt=ve(),p=ve(),T=ve(),Ie=ve(),Y=ve();function ve(){return 2**++bl}const Yt=Object.freeze(Object.defineProperty({__proto__:null,boolean:w,booleanish:L,commaOrSpaceSeparated:Y,commaSeparated:Ie,number:p,overloadedBoolean:Vt,spaceSeparated:T},Symbol.toStringTag,{value:"Module"})),Wt=Object.keys(Yt);class ln extends V{constructor(e,n,r,l){let o=-1;if(super(e,n),Fn(this,"space",l),typeof r=="number")for(;++o<Wt.length;){const i=Wt[o];Fn(this,Wt[o],(r&Yt[i])===Yt[i])}}}ln.prototype.defined=!0;function Fn(t,e,n){n&&(t[e]=n)}function $e(t){const e={},n={};for(const[r,l]of Object.entries(t.properties)){const o=new ln(r,t.transform(t.attributes||{},r),l,t.space);t.mustUseProperty&&t.mustUseProperty.includes(r)&&(o.mustUseProperty=!0),e[r]=o,n[Gt(r)]=r,n[Gt(o.attribute)]=r}return new Ke(e,n,t.space)}const yr=$e({properties:{ariaActiveDescendant:null,ariaAtomic:L,ariaAutoComplete:null,ariaBusy:L,ariaChecked:L,ariaColCount:p,ariaColIndex:p,ariaColSpan:p,ariaControls:T,ariaCurrent:null,ariaDescribedBy:T,ariaDetails:null,ariaDisabled:L,ariaDropEffect:T,ariaErrorMessage:null,ariaExpanded:L,ariaFlowTo:T,ariaGrabbed:L,ariaHasPopup:null,ariaHidden:L,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:T,ariaLevel:p,ariaLive:null,ariaModal:L,ariaMultiLine:L,ariaMultiSelectable:L,ariaOrientation:null,ariaOwns:T,ariaPlaceholder:null,ariaPosInSet:p,ariaPressed:L,ariaReadOnly:L,ariaRelevant:null,ariaRequired:L,ariaRoleDescription:T,ariaRowCount:p,ariaRowIndex:p,ariaRowSpan:p,ariaSelected:L,ariaSetSize:p,ariaSort:null,ariaValueMax:p,ariaValueMin:p,ariaValueNow:p,ariaValueText:null,role:null},transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function wr(t,e){return e in t?t[e]:e}function kr(t,e){return wr(t,e.toLowerCase())}const yl=$e({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Ie,acceptCharset:T,accessKey:T,action:null,allow:null,allowFullScreen:w,allowPaymentRequest:w,allowUserMedia:w,alt:null,as:null,async:w,autoCapitalize:null,autoComplete:T,autoFocus:w,autoPlay:w,blocking:T,capture:null,charSet:null,checked:w,cite:null,className:T,cols:p,colSpan:null,content:null,contentEditable:L,controls:w,controlsList:T,coords:p|Ie,crossOrigin:null,data:null,dateTime:null,decoding:null,default:w,defer:w,dir:null,dirName:null,disabled:w,download:Vt,draggable:L,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:w,formTarget:null,headers:T,height:p,hidden:Vt,high:p,href:null,hrefLang:null,htmlFor:T,httpEquiv:T,id:null,imageSizes:null,imageSrcSet:null,inert:w,inputMode:null,integrity:null,is:null,isMap:w,itemId:null,itemProp:T,itemRef:T,itemScope:w,itemType:T,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:w,low:p,manifest:null,max:null,maxLength:p,media:null,method:null,min:null,minLength:p,multiple:w,muted:w,name:null,nonce:null,noModule:w,noValidate:w,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:w,optimum:p,pattern:null,ping:T,placeholder:null,playsInline:w,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:w,referrerPolicy:null,rel:T,required:w,reversed:w,rows:p,rowSpan:p,sandbox:T,scope:null,scoped:w,seamless:w,selected:w,shadowRootClonable:w,shadowRootDelegatesFocus:w,shadowRootMode:null,shape:null,size:p,sizes:null,slot:null,span:p,spellCheck:L,src:null,srcDoc:null,srcLang:null,srcSet:null,start:p,step:null,style:null,tabIndex:p,target:null,title:null,translate:null,type:null,typeMustMatch:w,useMap:null,value:L,width:p,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:T,axis:null,background:null,bgColor:null,border:p,borderColor:null,bottomMargin:p,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:w,declare:w,event:null,face:null,frame:null,frameBorder:null,hSpace:p,leftMargin:p,link:null,longDesc:null,lowSrc:null,marginHeight:p,marginWidth:p,noResize:w,noHref:w,noShade:w,noWrap:w,object:null,profile:null,prompt:null,rev:null,rightMargin:p,rules:null,scheme:null,scrolling:L,standby:null,summary:null,text:null,topMargin:p,valueType:null,version:null,vAlign:null,vLink:null,vSpace:p,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:w,disableRemotePlayback:w,prefix:null,property:null,results:p,security:null,unselectable:null},space:"html",transform:kr}),wl=$e({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Y,accentHeight:p,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:p,amplitude:p,arabicForm:null,ascent:p,attributeName:null,attributeType:null,azimuth:p,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:p,by:null,calcMode:null,capHeight:p,className:T,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:p,diffuseConstant:p,direction:null,display:null,dur:null,divisor:p,dominantBaseline:null,download:w,dx:null,dy:null,edgeMode:null,editable:null,elevation:p,enableBackground:null,end:null,event:null,exponent:p,externalResourcesRequired:null,fill:null,fillOpacity:p,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Ie,g2:Ie,glyphName:Ie,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:p,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:p,horizOriginX:p,horizOriginY:p,id:null,ideographic:p,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:p,k:p,k1:p,k2:p,k3:p,k4:p,kernelMatrix:Y,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:p,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:p,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:p,overlineThickness:p,paintOrder:null,panose1:null,path:null,pathLength:p,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:T,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:p,pointsAtY:p,pointsAtZ:p,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Y,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Y,rev:Y,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Y,requiredFeatures:Y,requiredFonts:Y,requiredFormats:Y,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:p,specularExponent:p,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:p,strikethroughThickness:p,string:null,stroke:null,strokeDashArray:Y,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:p,strokeOpacity:p,strokeWidth:null,style:null,surfaceScale:p,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Y,tabIndex:p,tableValues:null,target:null,targetX:p,targetY:p,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Y,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:p,underlineThickness:p,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:p,values:null,vAlphabetic:p,vMathematical:p,vectorEffect:null,vHanging:p,vIdeographic:p,version:null,vertAdvY:p,vertOriginX:p,vertOriginY:p,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:p,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:wr}),Ar=$e({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()}}),xr=$e({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:kr}),Sr=$e({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()}}),kl=/[A-Z]/g,Hn=/-[a-z]/g,Al=/^data[-\w.:]+$/i;function xl(t,e){const n=Gt(e);let r=e,l=V;if(n in t.normal)return t.property[t.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&Al.test(e)){if(e.charAt(4)==="-"){const o=e.slice(5).replace(Hn,vl);r="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=e.slice(4);if(!Hn.test(o)){let i=o.replace(kl,Sl);i.charAt(0)!=="-"&&(i="-"+i),e="data"+i}}l=ln}return new l(r,e)}function Sl(t){return"-"+t.toLowerCase()}function vl(t){return t.charAt(1).toUpperCase()}const El=br([yr,yl,Ar,xr,Sr],"html"),_l=br([yr,wl,Ar,xr,Sr],"svg"),Bn="_props",jn=new Map;function Tl(t,e){if(e&&(e.class=e.class||e.className,delete e.className),!t||Object.keys(t).length===0)return e||{};if(!e||Object.keys(e).length===0){const r={};return Object.keys(t).forEach(l=>r[l]=null),r}const n={};return Object.keys(t).forEach(r=>{r in e||(n[r]=null)}),Object.keys(e).forEach(r=>n[r]=e[r]),n}function Nl(t){return t.length<=1?t.toLowerCase():t.split("-").map((e,n)=>n===0?e.toLowerCase():e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join("")}function Cl(t,e){const n=`${t}:${e}`;let r=jn.get(n);return r===void 0&&(r=xl(e?_l:El,t)||null,jn.set(n,r)),r}function Rl(t,e,n){const r=Nl(e.slice(5));n==null?delete t.dataset[r]:t.dataset[r]=String(n)}function Ll(t,e,n){e.startsWith("on")&&(!n||typeof n=="function"?t[e]=n:typeof n=="string"&&(n?t.setAttribute(e,n):t.removeAttribute(e)))}function qn(t,e,n){Ml(n)?t.setAttribute(e,e):t.removeAttribute(e)}function st(t,e,n){try{t[e]=n}catch{dt(t,e,n,!1)}}function dt(t,e,n,r){if(n==null){t.removeAttribute(e);return}const l=String(n);if(r&&e.includes(":")){const[o]=e.split(":");o==="xlink"?t.setAttributeNS("http://www.w3.org/1999/xlink",e,l):t.setAttribute(e,l)}else t.setAttribute(e,l)}function Ml(t){return t==null||t===!1||t===""?!1:t===!0?!0:typeof t=="string"?t.toLowerCase()!=="false"&&t!=="0":!!t}function Ol(t,e,n,r){if(Il(t,e))return;if(e==="style"){if(t.style.cssText&&(t.style.cssText=""),typeof n=="string")t.style.cssText=n;else if(n&&typeof n=="object")for(const o in n)t.style[o]!==n[o]&&(t.style[o]=n[o]);return}if(e==="key"){n!=null&&(t.key=n);return}if(e.startsWith("data-")){Rl(t,e,n);return}if(e.startsWith("on")){Ll(t,e,n);return}if((t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.tagName==="SELECT")&&(e==="value"||e==="selected"||e==="selectedIndex")){st(t,e,n);return}if(t.tagName==="INPUT"&&e==="checked"){st(t,e,n),qn(t,e,n);return}const l=Cl(e,r);l?l.boolean||l.overloadedBoolean?qn(t,l.attribute,n):l.mustUseProperty&&!r?st(t,l.property,n):dt(t,l.attribute,n,r):e.startsWith("aria-")||e==="role"?dt(t,e,n,r):e in t||t[e]!==void 0?st(t,e,n):dt(t,e,n,r)}function Il(t,e){return document.activeElement===t?["selectionStart","selectionEnd","selectionDirection"].includes(e):!!(e==="scrollTop"||e==="scrollLeft"||t instanceof HTMLMediaElement&&["currentTime","paused","playbackRate","volume"].includes(e))}function $l(t){return/^[a-zA-Z_:][\w\-:.]*$/.test(t)&&!t.includes("<")&&!t.includes(">")&&!t.includes('"')&&!t.includes("'")}function on(t,e,n){const r=t[Bn]||{},l=Tl(r,e);t[Bn]=e||{},Pl(t,l,e,n)}function Pl(t,e,n,r){for(const l in e)$l(l)&&Ol(t,l,e[l],r);e&&typeof e.ref=="function"&&window.requestAnimationFrame(()=>e.ref(t))}function Dl(t,...e){return vr(e)}function vr(t){const e=[],n=r=>{r!=null&&r!==""&&r!==!1&&e.push(typeof r=="function"||typeof r=="object"?r:`${r}`)};return t&&t.forEach(r=>{Array.isArray(r)?r.forEach(l=>n(l)):n(r)}),e}const Ye={};let Gn=0;const Wl=500,Ul=1e3;function zl(){if(!(Object.keys(Ye).length<=Ul))for(const[t,e]of Object.entries(Ye))e.isConnected||delete Ye[t]}function Fl(t,e,...n){const r=vr(n);if(typeof t=="string")return{tag:t,props:e,children:r};if(Array.isArray(t))return t;if(t===void 0&&n)return r;if(Object.getPrototypeOf(t).__isAppRunComponent)return{tag:t,props:e,children:r};if(typeof t=="function")return t(e,r);throw new Error(`Unknown tag in vdom ${t}`)}const Hl=(t,e,n={})=>{if(e==null||e===!1)return;const r=typeof t=="string"&&t?document.getElementById(t)||document.querySelector(t):t;e=ft(e,n),Bl(r,e,n)};function Bl(t,e,n={}){if(e==null||e===!1||(e=ht(e,n),!t))return;const r=t.nodeName==="SVG";Array.isArray(e)?Zt(t,e,r):Zt(t,[e],r)}function jl(t,e){const n=t.nodeName,r=`${e.tag||""}`;return n.toUpperCase()===r.toUpperCase()}function Ut(t,e,n){if(n=n||e.tag==="svg",!jl(t,e)){t.parentNode.replaceChild(bt(e,n),t);return}Zt(t,e.children,n),on(t,e.props,n)}function Zt(t,e,n){var a,u;const r=((a=t.childNodes)==null?void 0:a.length)||0,l=(e==null?void 0:e.length)||0,o=Math.min(r,l);for(let h=0;h<o;h++){const d=e[h],b=t.childNodes[h];if(typeof d=="string")b.textContent!==d&&(b.nodeType===3?b.nodeValue=d:t.replaceChild(Xt(d),b));else if(d instanceof HTMLElement||d instanceof SVGElement)t.insertBefore(d,b);else{const f=d.props&&d.props.key;if(f)if(b.key===f)Ut(t.childNodes[h],d,n);else{const S=Ye[f];S?(t.insertBefore(S,b),Ut(t.childNodes[h],d,n)):t.replaceChild(bt(d,n),b)}else Ut(t.childNodes[h],d,n)}}let i=((u=t.childNodes)==null?void 0:u.length)||0;for(;i>o;)t.removeChild(t.lastChild),i--;if(l>o){const h=document.createDocumentFragment();for(let d=o;d<e.length;d++)h.appendChild(bt(e[d],n));t.appendChild(h)}}const mt=t=>{const e=document.createElement("section");return e.insertAdjacentHTML("afterbegin",t),Array.from(e.children)};function Xt(t){if((t==null?void 0:t.indexOf("_html:"))===0){const e=document.createElement("div");return e.insertAdjacentHTML("afterbegin",t.substring(6)),e}else return document.createTextNode(t??"")}function bt(t,e){if(t instanceof HTMLElement||t instanceof SVGElement)return t;if(typeof t=="string")return Xt(t);if(!t.tag||typeof t.tag=="function")return Xt(JSON.stringify(t));e=e||t.tag==="svg";const n=e?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag);return on(n,t.props,e),t.children&&t.children.forEach(r=>n.appendChild(bt(r,e))),t.props&&t.props.key!==void 0&&(n.key=t.props.key,Ye[t.props.key]=n,++Gn>=Wl&&(zl(),Gn=0)),n}function ql(t,e,n){const{tag:r,props:l,children:o}=t;let i=`_${n}`,a=l&&l.id;a?i=a:a=`_${n}${Date.now()}`;let u="section";l&&l.as&&(u=l.as,delete l.as),e.__componentCache||(e.__componentCache={});let h=e.__componentCache[i];if(!h||!(h instanceof r)||!h.element){const d=document.createElement(u);h=e.__componentCache[i]=new r({...l,children:o}).mount(d,{render:!0})}else h.renderState(h.state);if(h.mounted){const d=h.mounted(l,o,h.state);typeof d<"u"&&h.setState(d)}return on(h.element,l,!1),h.element}function ht(t,e,n=0){var l;if(typeof t=="string")return t;if(Array.isArray(t))return t.map(o=>ht(o,e,n++));let r=t;if(t&&typeof t.tag=="function"&&Object.getPrototypeOf(t.tag).__isAppRunComponent&&(r=ql(t,e,n)),r&&Array.isArray(r.children)){const o=(l=r.props)==null?void 0:l._component;if(o){let i=0;r.children=r.children.map(a=>ht(a,o,i++))}else r.children=r.children.map(i=>ht(i,e,n++))}return r}const Gl=(t,e={})=>class extends HTMLElement{constructor(){super()}get component(){return this._component}get state(){return this._component.state}static get observedAttributes(){return(e.observedAttributes||[]).map(r=>r.toLowerCase())}connectedCallback(){if(this.isConnected&&!this._component){const r=e||{};this._shadowRoot=r.shadow?this.attachShadow({mode:"open"}):this;const l=r.observedAttributes||[],o=l.reduce((a,u)=>{const h=u.toLowerCase();return h!==u&&(a[h]=u),a},{});this._attrMap=a=>o[a]||a;const i={};Array.from(this.attributes).forEach(a=>i[this._attrMap(a.name)]=a.value),l.forEach(a=>{this[a]!==void 0&&(i[a]=this[a]),Object.defineProperty(this,a,{get(){return i[a]},set(u){this.attributeChangedCallback(a,i[a],u)},configurable:!0,enumerable:!0})}),requestAnimationFrame(()=>{const a=this.children?Array.from(this.children):[];if(this._component=new t({...i,children:a}).mount(this._shadowRoot,r),this._component._props=i,this._component.dispatchEvent=this.dispatchEvent.bind(this),this._component.mounted){const u=this._component.mounted(i,a,this._component.state);typeof u<"u"&&(this._component.state=u)}this.on=this._component.on.bind(this._component),this.run=this._component.run.bind(this._component),r.render!==!1&&this._component.run(".")})}}disconnectedCallback(){var r,l,o,i;(l=(r=this._component)==null?void 0:r.unload)==null||l.call(r),(i=(o=this._component)==null?void 0:o.unmount)==null||i.call(o),this._component=null}attributeChangedCallback(r,l,o){if(this._component){const i=this._attrMap(r);this._component._props[i]=o,this._component.run("attributeChanged",i,l,o),o!==l&&e.render!==!1&&window.requestAnimationFrame(()=>{this._component.run(".")})}}},Er=(t,e,n)=>{typeof customElements<"u"&&customElements.define(t,Gl(e,n))},Kt={meta:new WeakMap,defineMetadata(t,e,n){this.meta.has(n)||this.meta.set(n,{}),this.meta.get(n)[t]=e},getMetadataKeys(t){return t=Object.getPrototypeOf(t),this.meta.get(t)?Object.keys(this.meta.get(t)):[]},getMetadata(t,e){return e=Object.getPrototypeOf(e),this.meta.get(e)?this.meta.get(e)[t]:null}};function Vl(t,e={}){return function(n,r){const l=t?t.toString():r;Kt.defineMetadata(`apprun-update:${l}`,{name:l,key:r,options:e},n)}}function Yl(t,e){return function(r){return Er(t,r,e),r}}const Vn=t=>t,D=_;class xe{renderState(e,n=null){if(!this.view)return;let r=n||this.view(e);if(D.debug&&D.run("debug",{component:this,_:r?".":"-",state:e,vdom:r,el:this.element}),typeof document!="object")return;const l=typeof this.element=="string"&&this.element?pl(this.element)||hl(this.element):this.element;if(!l){console.warn(`Component element not found: ${this.element}`);return}const o="_c";this.unload?(l._component!==this||l.getAttribute(o)!==this.tracking_id)&&(this.tracking_id=new Date().valueOf().toString(),l.setAttribute(o,this.tracking_id),typeof MutationObserver<"u"&&(this.observer||(this.observer=new MutationObserver(i=>{(i[0].oldValue===this.tracking_id||!document.body.contains(l))&&(this.unload(this.state),this.observer.disconnect(),this.observer=null)})),this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:[o]}))):l.removeAttribute&&l.removeAttribute(o),l._component=this,!n&&r&&(r=ft(r,this),this.options.transition&&document&&document.startViewTransition?document.startViewTransition(()=>D.render(l,r,this)):D.render(l,r,this)),this.rendered&&this.rendered(this.state)}setState(e,n={render:!0,history:!1}){const r=async o=>{try{for(;;){const{value:i,done:a}=await o.next();if(a)break;this.setState(i,n)}}catch(i){console.error("Error in async iterator:",i)}},l=e;if(l!=null&&l[Symbol.asyncIterator]){this.setState(r(l[Symbol.asyncIterator]()),n);return}else if(l!=null&&l[Symbol.iterator]&&typeof l.next=="function"){for(const o of l)this.setState(o,n);return}else if(e&&e instanceof Promise)Promise.resolve(e).then(o=>{this.setState(o,n),this._state=e});else{if(this._state=e,e==null)return;this.state=e,n.render!==!1&&(n.transition&&document&&document.startViewTransition?document.startViewTransition(()=>this.renderState(e)):this.renderState(e)),n.history!==!1&&this.enable_history&&(this._history=[...this._history,e],this._history_idx=this._history.length-1),typeof n.callback=="function"&&n.callback(this.state)}}constructor(e,n,r,l){this.state=e,this.view=n,this.update=r,this.options=l,this._app=new fr,this._actions=[],this._global_events=[],this._history=[],this._history_idx=-1,this._history_prev=()=>{this._history_idx--,this._history_idx>=0?this.setState(this._history[this._history_idx],{render:!0,history:!1}):this._history_idx=0},this._history_next=()=>{this._history_idx++,this._history_idx<this._history.length?this.setState(this._history[this._history_idx],{render:!0,history:!1}):this._history_idx=this._history.length-1},this.start=(o=null,i)=>{if(this.mount(o,{render:!0,...i}),this.mounted&&typeof this.mounted=="function"){const a=this.mounted({},[],this.state);typeof a<"u"&&this.setState(a)}return this}}mount(e=null,n){var r;return console.assert(!this.element,"Component already mounted."),this.options=n={...this.options,...n},this.element=e,this.global_event=n.global_event,this.enable_history=!!n.history,this.enable_history&&(this.on(n.history.prev||"history-prev",this._history_prev),this.on(n.history.next||"history-next",this._history_next)),n.route&&(this.update=this.update||{},this.update[n.route]||(this.update[n.route]=Vn)),this.add_actions(),this.state=this.state??this.model??{},typeof this.state=="function"&&(this.state=this.state()),this.setState(this.state,{render:!!n.render,history:!0}),D.debug&&((r=D.find("debug-create-component"))!=null&&r.length)&&D.run("debug-create-component",this),this}is_global_event(e){return e&&(this.global_event||this._global_events.indexOf(e)>=0||e.startsWith("#")||e.startsWith("/")||e.startsWith("@"))}add_action(e,n,r={}){if(!n||typeof n!="function"){console.warn(`Component action for '${e}' is not a valid function:`,n);return}r.global&&this._global_events.push(e),this.on(e,(...l)=>{D.debug&&D.run("debug",{component:this,_:">",event:e,p:l,current_state:this.state,options:r});try{const o=n(this.state,...l);D.debug&&D.run("debug",{component:this,_:"<",event:e,p:l,newState:o,state:this.state,options:r}),this.setState(o,r)}catch(o){console.error(`Error in component action '${e}':`,o),D.debug&&D.run("debug",{component:this,_:"!",event:e,p:l,error:o,state:this.state,options:r})}},r)}add_actions(){const e=this.update||{};Kt.getMetadataKeys(this).forEach(r=>{if(r.startsWith("apprun-update:")){const l=Kt.getMetadata(r,this);e[l.name]=[this[l.key].bind(this),l.options]}});const n={};Array.isArray(e)?e.forEach(r=>{const[l,o,i]=r;l.toString().split(",").forEach(u=>n[u.trim()]=[o,i])}):Object.keys(e).forEach(r=>{const l=e[r];(typeof l=="function"||Array.isArray(l))&&r.split(",").forEach(o=>n[o.trim()]=l)}),n["."]||(n["."]=Vn),Object.keys(n).forEach(r=>{const l=n[r];typeof l=="function"?this.add_action(r,l):Array.isArray(l)&&this.add_action(r,l[0],l[1])})}run(e,...n){if(this.state instanceof Promise)return Promise.resolve(this.state).then(r=>{this.state=r,this.run(e,...n)});{const r=e.toString();return this.is_global_event(r)?D.run(r,...n):this._app.run(r,...n)}}on(e,n,r){const l=e.toString();return this._actions.push({name:l,fn:n}),this.is_global_event(l)?D.on(l,n,r):this._app.on(l,n,r)}runAsync(e,...n){const r=e.toString();return this.is_global_event(r)?D.runAsync(r,...n):this._app.runAsync(r,...n)}query(e,...n){return console.warn("component.query() is deprecated. Use component.runAsync() instead."),this.runAsync(e,...n)}unmount(){var e;(e=this.observer)==null||e.disconnect(),this._actions.forEach(n=>{const{name:r,fn:l}=n;this.is_global_event(r)?D.off(r,l):this._app.off(r,l)})}}xe.__isAppRunComponent=!0;function Zl(t){return t?t.startsWith("#/")?t.substring(2).split("/"):t.startsWith("#")||t.startsWith("/")?t.substring(1).split("/"):t.split("/"):[]}function Xl(t){return!t||t==="/"||t==="#"||t==="#/"?t:t.endsWith("/")?t.slice(0,-1):t}function Kl(t){const e=t.filter(Boolean);e.length>11&&console.warn(`Deep route hierarchy detected: ${e.join("/")} (${e.length} levels)`)}function Ql(t,e){if(!e||e==="/"||e==="")return t;const n=e.startsWith("/")?e:"/"+e;if(t.startsWith(n)){const r=t.substring(n.length);return r.startsWith("/")?r:"/"+r}return t}function Jl(t,e){const n=[];for(let r=t.length;r>0;r--){const l=t.slice(0,r);let o="";switch(e){case"path":o="/"+l.join("/");break;case"hash":o="#"+l.join("/");break;case"hash-slash":o="#/"+l.join("/");break;case"non-prefixed":o=l.join("/");break}n.push(o)}return n}function eo(t,e){for(let n=0;n<t.length;n++){const r=t[n],l=_.find(r);if(l&&l.length>0){const o=t.length-n,i=e.slice(o);return{eventName:r,parameters:i}}}return null}function Yn(){const t=_.find("#");if(t&&t.length>0){_.run("#"),_.run(he,"#");return}const e=_.find("/");if(e&&e.length>0){_.run("/"),_.run(he,"/");return}const n=_.find("#/");if(n&&n.length>0){_.run("#/"),_.run(he,"#/");return}console.warn("No subscribers for event: "),_.run(Xe,""),_.run(he,"")}function to(t){if(!t){Yn();return}t=Xl(t);const e=_.basePath;e&&(t=Ql(t,e));const n=Zl(t);Kl(n);let r;t.startsWith("#/")?r="hash-slash":t.startsWith("#")?r="hash":t.startsWith("/")?r="path":r="non-prefixed";const l=Jl(n,r),o=eo(l,n);if(o)no(o.eventName,...o.parameters);else if(l.length>0){const i=l[l.length-1];console.warn(`No subscribers for event: ${i}`),_.run(Xe,t),_.run(he,t)}else Yn()}const no=(t,...e)=>{if(!t||t===he||t===Xe)return;const n=_.find(t);!n||n.length===0?(console.warn(`No subscribers for event: ${t}`),_.run(Xe,t,...e)):_.run(t,...e),_.run(he,t,...e)},he="//",Xe="///",Oe=t=>{_.lastUrl!==t&&(_.lastUrl=t,to(t))};function Zn(t){return t&&typeof t=="object"&&typeof t.mount=="function"}function Qt(t){return typeof t=="function"&&t.prototype&&t.prototype.constructor===t&&(t.prototype.mount!==void 0||t.prototype.state!==void 0||t.prototype.view!==void 0)}function _r(t){return typeof t=="function"&&!Qt(t)}async function ro(t,e=3){let n=t,r=0;for(;_r(n)&&r<e;)try{const l=await n();if(l===n)break;n=l,r++}catch(l){console.error(`Error executing component function: ${l}`);break}return n}const lo=async(t,e)=>{for(const[n,r]of Object.entries(e)){if(!r||!n){console.error(`Invalid component configuration: component=${r}, route=${n}`);continue}if(Zn(r)){const l={route:n};r.mount(t,l);continue}if(Qt(r)){const l=new r,o={route:n};l.mount(t,o);continue}if(_r(r)){let l=await ro(r);if(Zn(l)){const o={route:n};l.mount(t,o);continue}if(Qt(l)){const o=new l,i={route:n};o.mount(t,i);continue}_.on(n,(...o)=>{const i=r(...o);if(typeof t=="string"&&(t=document.querySelector(t),!t)){console.error(`Element not found: ${t}`);return}return _.render(t,i)});continue}console.error("Invalid component: component must be a class, instance, or function that returns a class/instance")}},s=_;if(!s.start){s.version=gr,s.h=s.createElement=Fl,s.render=Hl,s.Fragment=Dl,s.webComponent=Er,s.safeHTML=mt,s.start=(e,n,r,l,o)=>{const i={render:!0,global_event:!0,...o},a=new xe(n,r,l);return o&&o.rendered&&(a.rendered=o.rendered),o&&o.mounted&&(a.mounted=o.mounted),a.start(e,i),a},s.query=s.query||s.runAsync;const t=e=>{};if(s.on("/",t),s.on("debug",e=>t),s.on(he,t),s.on(Xe,t),s.route=Oe,s.on("route",e=>s.route&&s.route(e)),typeof document=="object"&&document.addEventListener("DOMContentLoaded",()=>{const e=document.body.hasAttribute("apprun-no-init")||s["no-init-route"]||!1,n=s.find("#")||s.find("#/")||!1;window.addEventListener("hashchange",()=>Oe(location.hash)),window.addEventListener("popstate",()=>Oe(location.pathname)),n?!e&&Oe(location.hash):(!e&&(()=>{const r=s.basePath||"";let l=location.pathname;r&&l.startsWith(r)&&(l=l.substring(r.length),l.startsWith("/")||(l="/"+l)),Oe(l)})(),document.body.addEventListener("click",r=>{const l=r.target;if(!l)return;const o=l.tagName==="A"?l:l.closest("a");if(o&&o.origin===location.origin&&o.pathname){r.preventDefault();const a=(s.basePath||"")+o.pathname;history.pushState(null,"",a),Oe(o.pathname)}}))}),typeof window=="object"){const e=window;e.Component=xe,e._React=e.React,e.React=s,e.on=Vl,e.customElement=Yl,e.safeHTML=mt}s.use_render=(e,n=0)=>{n===0?s.render=(r,l)=>e(l,r):s.render=(r,l)=>e(r,l)},s.use_react=(e,n)=>{if(!e||!n){console.error("AppRun use_react: React and ReactDOM parameters are required");return}if(typeof e.createElement!="function"){console.error("AppRun use_react: Invalid React object - createElement method not found");return}if(!e.Fragment){console.error("AppRun use_react: Invalid React object - Fragment not found");return}if(s.h=s.createElement=e.createElement,s.Fragment=e.Fragment,e.version&&e.version.startsWith("18")){if(!n.createRoot||typeof n.createRoot!="function"){console.error("AppRun use_react: ReactDOM.createRoot not found in React 18+");return}s.render=(r,l)=>{!r||l===void 0||(r._root||(r._root=n.createRoot(r)),r._root.render(l))}}else{if(!n.render||typeof n.render!="function"){console.error("AppRun use_react: ReactDOM.render not found in legacy React");return}s.render=(r,l)=>n.render(l,r)}},s.addComponents=lo}const oo=()=>s.h("div",{id:"main"},s.h("div",{id:"pages"})),so="/api";async function q(t,e={}){const n=`${so}${t}`;try{const r=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!r.ok){let l=`HTTP ${r.status}: ${r.statusText}`;try{const o=await r.json();o.error&&(l=o.error,o.code&&(l+=` (${o.code})`))}catch{}throw new Error(l)}return r}catch(r){throw console.error(`API request failed for ${t}:`,r),r}}async function io(){return(await q("/worlds")).json()}async function ao(t){if(!t)throw new Error("World name is required");return(await q(`/worlds/${encodeURIComponent(t)}`)).json()}async function co(t){if(!t||!t.name)throw new Error("World data with name is required");const e={name:t.name,description:t.description||"",turnLimit:t.turnLimit??5,agents:t.agents??[]};return(await q("/worlds",{method:"POST",body:JSON.stringify(e)})).json()}async function uo(t,e){if(!t||!e)throw new Error("World name and update data are required");return(await q(`/worlds/${encodeURIComponent(t)}`,{method:"PATCH",body:JSON.stringify(e)})).json()}async function ho(t){if(!t)throw new Error("World name is required");await q(`/worlds/${encodeURIComponent(t)}`,{method:"DELETE"})}async function po(t){if(!t)throw new Error("World name is required");return(await q(`/worlds/${encodeURIComponent(t)}/agents`)).json()}async function go(t,e){if(!t||!e)throw new Error("Both world name and agent name are required");return(await q(`/worlds/${encodeURIComponent(t)}/agents/${encodeURIComponent(e)}`)).json()}async function fo(t,e){if(!t||!e)throw new Error("World name and agent data are required");return(await q(`/worlds/${encodeURIComponent(t)}/agents`,{method:"POST",body:JSON.stringify(e)})).json()}async function mo(t,e,n){if(!t||!e||!n)throw new Error("World name, agent name, and update data are required");return(await q(`/worlds/${encodeURIComponent(t)}/agents/${encodeURIComponent(e)}`,{method:"PATCH",body:JSON.stringify(n)})).json()}async function bo(t,e){if(!t||!e)throw new Error("World name and agent name are required");await q(`/worlds/${encodeURIComponent(t)}/agents/${encodeURIComponent(e)}`,{method:"DELETE"})}async function yo(t,e){if(!t||!e)throw new Error("World name and agent name are required");await q(`/worlds/${encodeURIComponent(t)}/agents/${encodeURIComponent(e)}/memory`,{method:"DELETE"})}async function wo(t){if(!t)throw new Error("World name is required");const e=await q(`/worlds/${encodeURIComponent(t)}/export`),n=e.headers.get("Content-Disposition");let r=`${t}-export.md`;if(n){const u=n.match(/filename="(.+)"/);u&&(r=u[1])}const l=await e.text(),o=new Blob([l],{type:"text/markdown"}),i=URL.createObjectURL(o),a=document.createElement("a");a.href=i,a.download=r,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i)}async function ko(t){if(!t)throw new Error("World name is required");return(await q(`/worlds/${encodeURIComponent(t)}/export`)).text()}const Z={apiRequest:q,getWorlds:io,getWorld:ao,createWorld:co,updateWorld:uo,deleteWorld:ho,exportWorldToMarkdown:wo,getWorldMarkdown:ko,getAgents:po,getAgent:go,createAgent:fo,updateAgent:mo,deleteAgent:bo,clearAgentMemory:yo},Ao=t=>({mode:t.mode||"create",world:t.world||Tr(),parentComponent:t.parentComponent,loading:!1}),Tr=()=>({name:"",description:"",turnLimit:5}),Xn=async function*(t){if(!t.world.name.trim()){yield{...t,error:"World name is required"};return}yield{...t,loading:!0,error:null};try{t.mode==="create"?await Z.createWorld(t.world):await Z.updateWorld(t.world.name,t.world);const e=t.mode==="create"?"World created successfully!":"World updated successfully!";yield{...t,loading:!1,successMessage:e},setTimeout(()=>{t.mode==="create"?window.location.href="/World/"+encodeURIComponent(t.world.name):location.reload()},2e3)}catch(e){yield{...t,loading:!1,error:e.message||"Failed to save world"}}},Kn=async function*(t){yield{...t,loading:!0,error:null};try{await Z.deleteWorld(t.world.name),yield{...t,loading:!1,successMessage:"World deleted successfully!"},setTimeout(()=>{location.reload()},2e3)}catch(e){yield{...t,loading:!1,error:e.message||"Failed to delete world"}}},ke=t=>{t!=null&&t.parentComponent&&typeof t.parentComponent.run=="function"?t.parentComponent.run("close-world-edit"):s.run("close-world-edit")};class Nr extends xe{constructor(){super(...arguments);A(this,"mounted",n=>Ao(n));A(this,"state",{mode:"create",world:Tr(),parentComponent:void 0,loading:!1,error:null,successMessage:null});A(this,"view",n=>{if(n.successMessage)return s.h("div",{className:"modal-backdrop",$onclick:ke},s.h("div",{className:"modal-content",onclick:i=>i.stopPropagation()},s.h("div",{className:"modal-header"},s.h("h2",{className:"modal-title"},"Success!"),s.h("button",{className:"modal-close-btn",$onclick:ke,title:"Close"},"×")),s.h("div",{className:"modal-body"},s.h("div",{className:"success-message"},s.h("p",null,n.successMessage)))));const r=n.mode==="edit",l=n.mode==="delete";let o;return l?o=`Delete ${n.world.name||"World"}`:r?o=`Edit ${n.world.name||"World"}`:o="Create New World",s.h("div",{className:"modal-backdrop",$onclick:ke},s.h("div",{className:"modal-content",onclick:i=>i.stopPropagation()},s.h("div",{className:"modal-header"},s.h("h2",{className:"modal-title"},o),s.h("button",{className:"modal-close-btn",$onclick:ke,title:"Close"},"×")),s.h("div",{className:"modal-body"},n.error&&s.h("div",{className:"error-message"},n.error),l?s.h("div",{className:"delete-confirmation"},s.h("p",{style:"font-size: 1rem;"},"Are you sure you want to delete ",s.h("span",{style:"font-size: 1.2rem;"},'"',n.world.name,'"'),"?"),s.h("p",{style:"font-size: 1rem;"},"This action cannot be undone and will delete all agents and messages in this world.")):s.h("form",{className:"world-form"},s.h("div",{className:"form-section"},s.h("div",{className:`form-group ${r?"hidden":""}`},s.h("label",{htmlFor:"world-name"},"World Name *"),s.h("input",{id:"world-name",type:"text",className:"form-input",placeholder:"Enter world name",value:n.world.name,$bind:"world.name",disabled:n.loading})),s.h("div",{className:"form-group"},s.h("label",{htmlFor:"world-description"},"Description"),s.h("input",{id:"world-description",type:"text",className:"form-input",placeholder:"Brief description of the world",value:n.world.description,$bind:"world.description",disabled:n.loading})),s.h("div",{className:"form-group"},s.h("label",{htmlFor:"world-turn-limit"},"Turn Limit"),s.h("input",{id:"world-turn-limit",type:"number",className:"form-input",placeholder:"5",min:"1",max:"50",value:n.world.turnLimit,$bind:"world.turnLimit",disabled:n.loading}))))),s.h("div",{className:"modal-footer"},s.h("div",{className:"modal-actions"},l?s.h("div",{className:"modal-primary-actions",style:"margin-left: auto;"},s.h("button",{className:"btn btn-secondary",$onclick:ke,disabled:n.loading},"Cancel"),s.h("button",{className:"btn btn-danger",$onclick:[Kn],disabled:n.loading},n.loading?"Deleting...":"Delete")):r?s.h(s.Fragment,null,s.h("button",{className:"btn btn-danger",$onclick:[Kn],disabled:n.loading,title:"Delete world"},n.loading?"Deleting...":"Delete"),s.h("div",{className:"modal-primary-actions"},s.h("button",{className:"btn btn-secondary",$onclick:ke,disabled:n.loading},"Cancel"),s.h("button",{className:"btn btn-primary",$onclick:[Xn],disabled:n.loading||!n.world.name.trim()},n.loading?"Saving...":"Update"))):s.h("div",{className:"modal-primary-actions",style:"margin-left: auto;"},s.h("button",{className:"btn btn-secondary",$onclick:ke,disabled:n.loading},"Cancel"),s.h("button",{className:"btn btn-primary",$onclick:[Xn],disabled:n.loading||!n.world.name.trim()},n.loading?"Saving...":"Create"))))))})}}class xo extends xe{constructor(){super(...arguments);A(this,"state",async()=>({worlds:await Z.getWorlds(),currentIndex:0,loading:!1,error:null,showWorldEdit:!1,worldEditMode:"create",selectedWorldForEdit:null}));A(this,"view",n=>{var r,l,o,i;return n.loading?s.h("div",{class:"container"},s.h("div",{class:"row"},s.h("div",{class:"col"},s.h("div",{class:"loading-message"},"Loading worlds...")))):n.error?s.h("div",{class:"container"},s.h("div",{class:"row"},s.h("div",{class:"col"},s.h("div",{class:"error-message"},s.h("h3",null,"Error loading worlds"),s.h("p",null,n.error),s.h("button",{class:"btn btn-primary",$onclick:"/"},"Retry"))))):n.worlds.length===0?s.h("div",{class:"container"},s.h("div",{class:"row"},s.h("div",{class:"col"},s.h("div",{class:"no-worlds-message"},s.h("h3",null,"No worlds found"),s.h("p",null,"Create your first world to get started!"),s.h("button",{class:"btn btn-primary",$onclick:"open-world-create"},"Create World"))))):s.h("div",{class:"container"},s.h("div",{class:"row"},s.h("div",{class:"col banner-col"},s.h("h1",{class:"banner-title"},"PICK YOUR WORLD"))),s.h("div",{class:"row carousel-row"},s.h("div",{class:"col"},s.h("div",{class:"world-carousel"},s.h("button",{class:"btn carousel-arrow",$onclick:"prev-world"},"‹"),s.h("div",{class:"world-cards"},n.worlds.map((a,u)=>{const h=u===n.currentIndex;let d=!1;return n.worlds.length<=3?d=!0:d=Math.abs(u-n.currentIndex)<=1,d?s.h("button",{class:`btn world-card-btn ${h?"btn-primary center":"btn-secondary side"}`,$onclick:h?["enter-world",a]:["select-world",a]},s.h("span",{class:"world-name"},a.name)):null})),s.h("button",{class:"btn carousel-arrow",$onclick:"next-world"},"›")),s.h("div",{class:"world-indicators"},n.worlds.map((a,u)=>s.h("button",{class:`world-dot ${u===n.currentIndex?"active":""}`,$onclick:["select-world",a],title:a.name}))))),s.h("div",{class:"row"},s.h("div",{class:"col"},s.h("div",{class:"description-card"},s.h("h4",{class:"description-title"},((r=n.worlds[n.currentIndex])==null?void 0:r.name)||"Unknown World"),s.h("p",{class:"description-text"},((l=n.worlds[n.currentIndex])==null?void 0:l.description)||"No description available"),s.h("div",{class:"action-buttons"},s.h("button",{class:"btn add-world-btn",title:"Add New World",$onclick:"open-world-create"},s.h("span",{class:"plus-icon"},"+")),s.h("a",{href:"/World/"+(((o=n.worlds[n.currentIndex])==null?void 0:o.name)||"")},s.h("button",{class:"btn btn-primary enter-btn"},"Enter ",((i=n.worlds[n.currentIndex])==null?void 0:i.name)||"World")),s.h("button",{class:"btn add-world-btn delete-world-btn",title:"Delete World",$onclick:["open-world-delete",n.worlds[n.currentIndex]]},s.h("span",{class:"plus-icon"},"×")))))),n.showWorldEdit&&s.h(Nr,{world:n.selectedWorldForEdit,mode:n.worldEditMode,parentComponent:this}))});A(this,"update",{"prev-world":n=>({...n,currentIndex:n.currentIndex>0?n.currentIndex-1:n.worlds.length-1}),"next-world":n=>({...n,currentIndex:n.currentIndex<n.worlds.length-1?n.currentIndex+1:0}),"select-world":(n,r)=>{const l=n.worlds.findIndex(o=>o.name===r.name);return{...n,currentIndex:l>=0?l:n.currentIndex}},"enter-world":(n,r)=>{window.location.href="/World/"+r.name},"open-world-create":n=>({...n,showWorldEdit:!0,worldEditMode:"create",selectedWorldForEdit:null}),"open-world-edit":(n,r)=>({...n,showWorldEdit:!0,worldEditMode:"edit",selectedWorldForEdit:r}),"open-world-delete":(n,r)=>({...n,showWorldEdit:!0,worldEditMode:"delete",selectedWorldForEdit:r}),"close-world-edit":n=>({...n,showWorldEdit:!1})})}}function yt(t){return t?t.replace(/\s+/g,"-").replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[^a-zA-Z0-9-]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").toLowerCase():""}function sn(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Ee=sn();function Cr(t){Ee=t}var Ze={exec:()=>null};function E(t,e=""){let n=typeof t=="string"?t:t.source,r={replace:(l,o)=>{let i=typeof o=="string"?o:o.source;return i=i.replace(H.caret,"$1"),n=n.replace(l,i),r},getRegex:()=>new RegExp(n,e)};return r}var H={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},So=/^(?:[ \t]*(?:\n|$))+/,vo=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Eo=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Qe=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,_o=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,an=/(?:[*+-]|\d{1,9}[.)])/,Rr=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Lr=E(Rr).replace(/bull/g,an).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),To=E(Rr).replace(/bull/g,an).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),cn=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,No=/^[^\n]+/,un=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Co=E(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",un).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Ro=E(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,an).getRegex(),xt="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",dn=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Lo=E("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",dn).replace("tag",xt).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Mr=E(cn).replace("hr",Qe).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xt).getRegex(),Mo=E(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Mr).getRegex(),hn={blockquote:Mo,code:vo,def:Co,fences:Eo,heading:_o,hr:Qe,html:Lo,lheading:Lr,list:Ro,newline:So,paragraph:Mr,table:Ze,text:No},Qn=E("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Qe).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xt).getRegex(),Oo={...hn,lheading:To,table:Qn,paragraph:E(cn).replace("hr",Qe).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Qn).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xt).getRegex()},Io={...hn,html:E(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",dn).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Ze,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:E(cn).replace("hr",Qe).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Lr).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},$o=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Po=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Or=/^( {2,}|\\)\n(?!\s*$)/,Do=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,St=/[\p{P}\p{S}]/u,pn=/[\s\p{P}\p{S}]/u,Ir=/[^\s\p{P}\p{S}]/u,Wo=E(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,pn).getRegex(),$r=/(?!~)[\p{P}\p{S}]/u,Uo=/(?!~)[\s\p{P}\p{S}]/u,zo=/(?:[^\s\p{P}\p{S}]|~)/u,Fo=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<(?! )[^<>]*?>/g,Pr=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Ho=E(Pr,"u").replace(/punct/g,St).getRegex(),Bo=E(Pr,"u").replace(/punct/g,$r).getRegex(),Dr="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",jo=E(Dr,"gu").replace(/notPunctSpace/g,Ir).replace(/punctSpace/g,pn).replace(/punct/g,St).getRegex(),qo=E(Dr,"gu").replace(/notPunctSpace/g,zo).replace(/punctSpace/g,Uo).replace(/punct/g,$r).getRegex(),Go=E("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Ir).replace(/punctSpace/g,pn).replace(/punct/g,St).getRegex(),Vo=E(/\\(punct)/,"gu").replace(/punct/g,St).getRegex(),Yo=E(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Zo=E(dn).replace("(?:-->|$)","-->").getRegex(),Xo=E("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Zo).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),wt=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Ko=E(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",wt).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Wr=E(/^!?\[(label)\]\[(ref)\]/).replace("label",wt).replace("ref",un).getRegex(),Ur=E(/^!?\[(ref)\](?:\[\])?/).replace("ref",un).getRegex(),Qo=E("reflink|nolink(?!\\()","g").replace("reflink",Wr).replace("nolink",Ur).getRegex(),gn={_backpedal:Ze,anyPunctuation:Vo,autolink:Yo,blockSkip:Fo,br:Or,code:Po,del:Ze,emStrongLDelim:Ho,emStrongRDelimAst:jo,emStrongRDelimUnd:Go,escape:$o,link:Ko,nolink:Ur,punctuation:Wo,reflink:Wr,reflinkSearch:Qo,tag:Xo,text:Do,url:Ze},Jo={...gn,link:E(/^!?\[(label)\]\((.*?)\)/).replace("label",wt).getRegex(),reflink:E(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",wt).getRegex()},Jt={...gn,emStrongRDelimAst:qo,emStrongLDelim:Bo,url:E(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},es={...Jt,br:E(Or).replace("{2,}","*").getRegex(),text:E(Jt.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},it={normal:hn,gfm:Oo,pedantic:Io},Fe={normal:gn,gfm:Jt,breaks:es,pedantic:Jo},ts={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Jn=t=>ts[t];function ne(t,e){if(e){if(H.escapeTest.test(t))return t.replace(H.escapeReplace,Jn)}else if(H.escapeTestNoEncode.test(t))return t.replace(H.escapeReplaceNoEncode,Jn);return t}function er(t){try{t=encodeURI(t).replace(H.percentDecode,"%")}catch{return null}return t}function tr(t,e){var o;let n=t.replace(H.findPipe,(i,a,u)=>{let h=!1,d=a;for(;--d>=0&&u[d]==="\\";)h=!h;return h?"|":" |"}),r=n.split(H.splitPipe),l=0;if(r[0].trim()||r.shift(),r.length>0&&!((o=r.at(-1))!=null&&o.trim())&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;l<r.length;l++)r[l]=r[l].trim().replace(H.slashPipe,"|");return r}function He(t,e,n){let r=t.length;if(r===0)return"";let l=0;for(;l<r&&t.charAt(r-l-1)===e;)l++;return t.slice(0,r-l)}function ns(t,e){if(t.indexOf(e[1])===-1)return-1;let n=0;for(let r=0;r<t.length;r++)if(t[r]==="\\")r++;else if(t[r]===e[0])n++;else if(t[r]===e[1]&&(n--,n<0))return r;return n>0?-2:-1}function nr(t,e,n,r,l){let o=e.href,i=e.title||null,a=t[1].replace(l.other.outputLinkReplace,"$1");r.state.inLink=!0;let u={type:t[0].charAt(0)==="!"?"image":"link",raw:n,href:o,title:i,text:a,tokens:r.inlineTokens(a)};return r.state.inLink=!1,u}function rs(t,e,n){let r=t.match(n.other.indentCodeCompensation);if(r===null)return e;let l=r[1];return e.split(`
`).map(o=>{let i=o.match(n.other.beginningSpace);if(i===null)return o;let[a]=i;return a.length>=l.length?o.slice(l.length):o}).join(`
`)}var kt=class{constructor(t){A(this,"options");A(this,"rules");A(this,"lexer");this.options=t||Ee}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let n=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?n:He(n,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let n=e[0],r=rs(n,e[3]||"",this.rules);return{type:"code",raw:n,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:r}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let n=e[2].trim();if(this.rules.other.endingHash.test(n)){let r=He(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:He(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let n=He(e[0],`
`).split(`
`),r="",l="",o=[];for(;n.length>0;){let i=!1,a=[],u;for(u=0;u<n.length;u++)if(this.rules.other.blockquoteStart.test(n[u]))a.push(n[u]),i=!0;else if(!i)a.push(n[u]);else break;n=n.slice(u);let h=a.join(`
`),d=h.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${h}`:h,l=l?`${l}
${d}`:d;let b=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,o,!0),this.lexer.state.top=b,n.length===0)break;let f=o.at(-1);if((f==null?void 0:f.type)==="code")break;if((f==null?void 0:f.type)==="blockquote"){let S=f,k=S.raw+`
`+n.join(`
`),C=this.blockquote(k);o[o.length-1]=C,r=r.substring(0,r.length-S.raw.length)+C.raw,l=l.substring(0,l.length-S.text.length)+C.text;break}else if((f==null?void 0:f.type)==="list"){let S=f,k=S.raw+`
`+n.join(`
`),C=this.list(k);o[o.length-1]=C,r=r.substring(0,r.length-f.raw.length)+C.raw,l=l.substring(0,l.length-S.raw.length)+C.raw,n=k.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:o,text:l}}}list(t){let e=this.rules.block.list.exec(t);if(e){let n=e[1].trim(),r=n.length>1,l={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");let o=this.rules.other.listItemRegex(n),i=!1;for(;t;){let u=!1,h="",d="";if(!(e=o.exec(t))||this.rules.block.hr.test(t))break;h=e[0],t=t.substring(h.length);let b=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,Q=>" ".repeat(3*Q.length)),f=t.split(`
`,1)[0],S=!b.trim(),k=0;if(this.options.pedantic?(k=2,d=b.trimStart()):S?k=e[1].length+1:(k=e[2].search(this.rules.other.nonSpaceChar),k=k>4?1:k,d=b.slice(k),k+=e[1].length),S&&this.rules.other.blankLine.test(f)&&(h+=f+`
`,t=t.substring(f.length+1),u=!0),!u){let Q=this.rules.other.nextBulletRegex(k),le=this.rules.other.hrRegex(k),J=this.rules.other.fencesBeginRegex(k),O=this.rules.other.headingBeginRegex(k),pe=this.rules.other.htmlBeginRegex(k);for(;t;){let ge=t.split(`
`,1)[0],fe;if(f=ge,this.options.pedantic?(f=f.replace(this.rules.other.listReplaceNesting,"  "),fe=f):fe=f.replace(this.rules.other.tabCharGlobal,"    "),J.test(f)||O.test(f)||pe.test(f)||Q.test(f)||le.test(f))break;if(fe.search(this.rules.other.nonSpaceChar)>=k||!f.trim())d+=`
`+fe.slice(k);else{if(S||b.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||J.test(b)||O.test(b)||le.test(b))break;d+=`
`+f}!S&&!f.trim()&&(S=!0),h+=ge+`
`,t=t.substring(ge.length+1),b=fe.slice(k)}}l.loose||(i?l.loose=!0:this.rules.other.doubleBlankLine.test(h)&&(i=!0));let C=null,de;this.options.gfm&&(C=this.rules.other.listIsTask.exec(d),C&&(de=C[0]!=="[ ] ",d=d.replace(this.rules.other.listReplaceTask,""))),l.items.push({type:"list_item",raw:h,task:!!C,checked:de,loose:!1,text:d,tokens:[]}),l.raw+=h}let a=l.items.at(-1);if(a)a.raw=a.raw.trimEnd(),a.text=a.text.trimEnd();else return;l.raw=l.raw.trimEnd();for(let u=0;u<l.items.length;u++)if(this.lexer.state.top=!1,l.items[u].tokens=this.lexer.blockTokens(l.items[u].text,[]),!l.loose){let h=l.items[u].tokens.filter(b=>b.type==="space"),d=h.length>0&&h.some(b=>this.rules.other.anyLine.test(b.raw));l.loose=d}if(l.loose)for(let u=0;u<l.items.length;u++)l.items[u].loose=!0;return l}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let n=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",l=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:n,raw:e[0],href:r,title:l}}}table(t){var i;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let n=tr(e[1]),r=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),l=(i=e[3])!=null&&i.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(n.length===r.length){for(let a of r)this.rules.other.tableAlignRight.test(a)?o.align.push("right"):this.rules.other.tableAlignCenter.test(a)?o.align.push("center"):this.rules.other.tableAlignLeft.test(a)?o.align.push("left"):o.align.push(null);for(let a=0;a<n.length;a++)o.header.push({text:n[a],tokens:this.lexer.inline(n[a]),header:!0,align:o.align[a]});for(let a of l)o.rows.push(tr(a,o.header.length).map((u,h)=>({text:u,tokens:this.lexer.inline(u),header:!1,align:o.align[h]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let n=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:n,tokens:this.lexer.inline(n)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let n=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let o=He(n.slice(0,-1),"\\");if((n.length-o.length)%2===0)return}else{let o=ns(e[2],"()");if(o===-2)return;if(o>-1){let i=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,i).trim(),e[3]=""}}let r=e[2],l="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(r);o&&(r=o[1],l=o[3])}else l=e[3]?e[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),nr(e,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:l&&l.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){let r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),l=e[r.toLowerCase()];if(!l){let o=n[0].charAt(0);return{type:"text",raw:o,text:o}}return nr(n,l,n[0],this.lexer,this.rules)}}emStrong(t,e,n=""){let r=this.rules.inline.emStrongLDelim.exec(t);if(!(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!n||this.rules.inline.punctuation.exec(n))){let l=[...r[0]].length-1,o,i,a=l,u=0,h=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,e=e.slice(-1*t.length+l);(r=h.exec(e))!=null;){if(o=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!o)continue;if(i=[...o].length,r[3]||r[4]){a+=i;continue}else if((r[5]||r[6])&&l%3&&!((l+i)%3)){u+=i;continue}if(a-=i,a>0)continue;i=Math.min(i,i+a+u);let d=[...r[0]][0].length,b=t.slice(0,l+r.index+d+i);if(Math.min(l,i)%2){let S=b.slice(1,-1);return{type:"em",raw:b,text:S,tokens:this.lexer.inlineTokens(S)}}let f=b.slice(2,-2);return{type:"strong",raw:b,text:f,tokens:this.lexer.inlineTokens(f)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let n=e[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(n),l=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&l&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:e[0],text:n}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){let e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let n,r;return e[2]==="@"?(n=e[1],r="mailto:"+n):(n=e[1],r=n),{type:"link",raw:e[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(t){var n;let e;if(e=this.rules.inline.url.exec(t)){let r,l;if(e[2]==="@")r=e[0],l="mailto:"+r;else{let o;do o=e[0],e[0]=((n=this.rules.inline._backpedal.exec(e[0]))==null?void 0:n[0])??"";while(o!==e[0]);r=e[0],e[1]==="www."?l="http://"+e[0]:l=e[0]}return{type:"link",raw:e[0],text:r,href:l,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let n=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:n}}}},ce=class en{constructor(e){A(this,"tokens");A(this,"options");A(this,"state");A(this,"tokenizer");A(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Ee,this.options.tokenizer=this.options.tokenizer||new kt,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:H,block:it.normal,inline:Fe.normal};this.options.pedantic?(n.block=it.pedantic,n.inline=Fe.pedantic):this.options.gfm&&(n.block=it.gfm,this.options.breaks?n.inline=Fe.breaks:n.inline=Fe.gfm),this.tokenizer.rules=n}static get rules(){return{block:it,inline:Fe}}static lex(e,n){return new en(n).lex(e)}static lexInline(e,n){return new en(n).inlineTokens(e)}lex(e){e=e.replace(H.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[],r=!1){var l,o,i;for(this.options.pedantic&&(e=e.replace(H.tabCharGlobal,"    ").replace(H.spaceLine,""));e;){let a;if((o=(l=this.options.extensions)==null?void 0:l.block)!=null&&o.some(h=>(a=h.call({lexer:this},e,n))?(e=e.substring(a.raw.length),n.push(a),!0):!1))continue;if(a=this.tokenizer.space(e)){e=e.substring(a.raw.length);let h=n.at(-1);a.raw.length===1&&h!==void 0?h.raw+=`
`:n.push(a);continue}if(a=this.tokenizer.code(e)){e=e.substring(a.raw.length);let h=n.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=`
`+a.raw,h.text+=`
`+a.text,this.inlineQueue.at(-1).src=h.text):n.push(a);continue}if(a=this.tokenizer.fences(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.heading(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.hr(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.blockquote(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.list(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.html(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.def(e)){e=e.substring(a.raw.length);let h=n.at(-1);(h==null?void 0:h.type)==="paragraph"||(h==null?void 0:h.type)==="text"?(h.raw+=`
`+a.raw,h.text+=`
`+a.raw,this.inlineQueue.at(-1).src=h.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title});continue}if(a=this.tokenizer.table(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.lheading(e)){e=e.substring(a.raw.length),n.push(a);continue}let u=e;if((i=this.options.extensions)!=null&&i.startBlock){let h=1/0,d=e.slice(1),b;this.options.extensions.startBlock.forEach(f=>{b=f.call({lexer:this},d),typeof b=="number"&&b>=0&&(h=Math.min(h,b))}),h<1/0&&h>=0&&(u=e.substring(0,h+1))}if(this.state.top&&(a=this.tokenizer.paragraph(u))){let h=n.at(-1);r&&(h==null?void 0:h.type)==="paragraph"?(h.raw+=`
`+a.raw,h.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):n.push(a),r=u.length!==e.length,e=e.substring(a.raw.length);continue}if(a=this.tokenizer.text(e)){e=e.substring(a.raw.length);let h=n.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=`
`+a.raw,h.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=h.text):n.push(a);continue}if(e){let h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){var a,u,h;let r=e,l=null;if(this.tokens.links){let d=Object.keys(this.tokens.links);if(d.length>0)for(;(l=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)d.includes(l[0].slice(l[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,l.index)+"["+"a".repeat(l[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(l=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,l.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(l=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,l.index)+"["+"a".repeat(l[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let o=!1,i="";for(;e;){o||(i=""),o=!1;let d;if((u=(a=this.options.extensions)==null?void 0:a.inline)!=null&&u.some(f=>(d=f.call({lexer:this},e,n))?(e=e.substring(d.raw.length),n.push(d),!0):!1))continue;if(d=this.tokenizer.escape(e)){e=e.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.tag(e)){e=e.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.link(e)){e=e.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(d.raw.length);let f=n.at(-1);d.type==="text"&&(f==null?void 0:f.type)==="text"?(f.raw+=d.raw,f.text+=d.text):n.push(d);continue}if(d=this.tokenizer.emStrong(e,r,i)){e=e.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.codespan(e)){e=e.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.br(e)){e=e.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.del(e)){e=e.substring(d.raw.length),n.push(d);continue}if(d=this.tokenizer.autolink(e)){e=e.substring(d.raw.length),n.push(d);continue}if(!this.state.inLink&&(d=this.tokenizer.url(e))){e=e.substring(d.raw.length),n.push(d);continue}let b=e;if((h=this.options.extensions)!=null&&h.startInline){let f=1/0,S=e.slice(1),k;this.options.extensions.startInline.forEach(C=>{k=C.call({lexer:this},S),typeof k=="number"&&k>=0&&(f=Math.min(f,k))}),f<1/0&&f>=0&&(b=e.substring(0,f+1))}if(d=this.tokenizer.inlineText(b)){e=e.substring(d.raw.length),d.raw.slice(-1)!=="_"&&(i=d.raw.slice(-1)),o=!0;let f=n.at(-1);(f==null?void 0:f.type)==="text"?(f.raw+=d.raw,f.text+=d.text):n.push(d);continue}if(e){let f="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return n}},At=class{constructor(t){A(this,"options");A(this,"parser");this.options=t||Ee}space(t){return""}code({text:t,lang:e,escaped:n}){var o;let r=(o=(e||"").match(H.notSpaceStart))==null?void 0:o[0],l=t.replace(H.endingNewline,"")+`
`;return r?'<pre><code class="language-'+ne(r)+'">'+(n?l:ne(l,!0))+`</code></pre>
`:"<pre><code>"+(n?l:ne(l,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,n=t.start,r="";for(let i=0;i<t.items.length;i++){let a=t.items[i];r+=this.listitem(a)}let l=e?"ol":"ul",o=e&&n!==1?' start="'+n+'"':"";return"<"+l+o+`>
`+r+"</"+l+`>
`}listitem(t){var n;let e="";if(t.task){let r=this.checkbox({checked:!!t.checked});t.loose?((n=t.tokens[0])==null?void 0:n.type)==="paragraph"?(t.tokens[0].text=r+" "+t.tokens[0].text,t.tokens[0].tokens&&t.tokens[0].tokens.length>0&&t.tokens[0].tokens[0].type==="text"&&(t.tokens[0].tokens[0].text=r+" "+ne(t.tokens[0].tokens[0].text),t.tokens[0].tokens[0].escaped=!0)):t.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):e+=r+" "}return e+=this.parser.parse(t.tokens,!!t.loose),`<li>${e}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",n="";for(let l=0;l<t.header.length;l++)n+=this.tablecell(t.header[l]);e+=this.tablerow({text:n});let r="";for(let l=0;l<t.rows.length;l++){let o=t.rows[l];n="";for(let i=0;i<o.length;i++)n+=this.tablecell(o[i]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+r+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${ne(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:n}){let r=this.parser.parseInline(n),l=er(t);if(l===null)return r;t=l;let o='<a href="'+t+'"';return e&&(o+=' title="'+ne(e)+'"'),o+=">"+r+"</a>",o}image({href:t,title:e,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));let l=er(t);if(l===null)return ne(n);t=l;let o=`<img src="${t}" alt="${n}"`;return e&&(o+=` title="${ne(e)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:ne(t.text)}},fn=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}},ue=class tn{constructor(e){A(this,"options");A(this,"renderer");A(this,"textRenderer");this.options=e||Ee,this.options.renderer=this.options.renderer||new At,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new fn}static parse(e,n){return new tn(n).parse(e)}static parseInline(e,n){return new tn(n).parseInline(e)}parse(e,n=!0){var l,o;let r="";for(let i=0;i<e.length;i++){let a=e[i];if((o=(l=this.options.extensions)==null?void 0:l.renderers)!=null&&o[a.type]){let h=a,d=this.options.extensions.renderers[h.type].call({parser:this},h);if(d!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(h.type)){r+=d||"";continue}}let u=a;switch(u.type){case"space":{r+=this.renderer.space(u);continue}case"hr":{r+=this.renderer.hr(u);continue}case"heading":{r+=this.renderer.heading(u);continue}case"code":{r+=this.renderer.code(u);continue}case"table":{r+=this.renderer.table(u);continue}case"blockquote":{r+=this.renderer.blockquote(u);continue}case"list":{r+=this.renderer.list(u);continue}case"html":{r+=this.renderer.html(u);continue}case"paragraph":{r+=this.renderer.paragraph(u);continue}case"text":{let h=u,d=this.renderer.text(h);for(;i+1<e.length&&e[i+1].type==="text";)h=e[++i],d+=`
`+this.renderer.text(h);n?r+=this.renderer.paragraph({type:"paragraph",raw:d,text:d,tokens:[{type:"text",raw:d,text:d,escaped:!0}]}):r+=d;continue}default:{let h='Token with "'+u.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return r}parseInline(e,n=this.renderer){var l,o;let r="";for(let i=0;i<e.length;i++){let a=e[i];if((o=(l=this.options.extensions)==null?void 0:l.renderers)!=null&&o[a.type]){let h=this.options.extensions.renderers[a.type].call({parser:this},a);if(h!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){r+=h||"";continue}}let u=a;switch(u.type){case"escape":{r+=n.text(u);break}case"html":{r+=n.html(u);break}case"link":{r+=n.link(u);break}case"image":{r+=n.image(u);break}case"strong":{r+=n.strong(u);break}case"em":{r+=n.em(u);break}case"codespan":{r+=n.codespan(u);break}case"br":{r+=n.br(u);break}case"del":{r+=n.del(u);break}case"text":{r+=n.text(u);break}default:{let h='Token with "'+u.type+'" type was not found.';if(this.options.silent)return console.error(h),"";throw new Error(h)}}}return r}},qt,pt=(qt=class{constructor(t){A(this,"options");A(this,"block");this.options=t||Ee}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}provideLexer(){return this.block?ce.lex:ce.lexInline}provideParser(){return this.block?ue.parse:ue.parseInline}},A(qt,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),qt),ls=class{constructor(...t){A(this,"defaults",sn());A(this,"options",this.setOptions);A(this,"parse",this.parseMarkdown(!0));A(this,"parseInline",this.parseMarkdown(!1));A(this,"Parser",ue);A(this,"Renderer",At);A(this,"TextRenderer",fn);A(this,"Lexer",ce);A(this,"Tokenizer",kt);A(this,"Hooks",pt);this.use(...t)}walkTokens(t,e){var r,l;let n=[];for(let o of t)switch(n=n.concat(e.call(this,o)),o.type){case"table":{let i=o;for(let a of i.header)n=n.concat(this.walkTokens(a.tokens,e));for(let a of i.rows)for(let u of a)n=n.concat(this.walkTokens(u.tokens,e));break}case"list":{let i=o;n=n.concat(this.walkTokens(i.items,e));break}default:{let i=o;(l=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&l[i.type]?this.defaults.extensions.childTokens[i.type].forEach(a=>{let u=i[a].flat(1/0);n=n.concat(this.walkTokens(u,e))}):i.tokens&&(n=n.concat(this.walkTokens(i.tokens,e)))}}return n}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(n=>{let r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(l=>{if(!l.name)throw new Error("extension name required");if("renderer"in l){let o=e.renderers[l.name];o?e.renderers[l.name]=function(...i){let a=l.renderer.apply(this,i);return a===!1&&(a=o.apply(this,i)),a}:e.renderers[l.name]=l.renderer}if("tokenizer"in l){if(!l.level||l.level!=="block"&&l.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[l.level];o?o.unshift(l.tokenizer):e[l.level]=[l.tokenizer],l.start&&(l.level==="block"?e.startBlock?e.startBlock.push(l.start):e.startBlock=[l.start]:l.level==="inline"&&(e.startInline?e.startInline.push(l.start):e.startInline=[l.start]))}"childTokens"in l&&l.childTokens&&(e.childTokens[l.name]=l.childTokens)}),r.extensions=e),n.renderer){let l=this.defaults.renderer||new At(this.defaults);for(let o in n.renderer){if(!(o in l))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let i=o,a=n.renderer[i],u=l[i];l[i]=(...h)=>{let d=a.apply(l,h);return d===!1&&(d=u.apply(l,h)),d||""}}r.renderer=l}if(n.tokenizer){let l=this.defaults.tokenizer||new kt(this.defaults);for(let o in n.tokenizer){if(!(o in l))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let i=o,a=n.tokenizer[i],u=l[i];l[i]=(...h)=>{let d=a.apply(l,h);return d===!1&&(d=u.apply(l,h)),d}}r.tokenizer=l}if(n.hooks){let l=this.defaults.hooks||new pt;for(let o in n.hooks){if(!(o in l))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let i=o,a=n.hooks[i],u=l[i];pt.passThroughHooks.has(o)?l[i]=h=>{if(this.defaults.async)return Promise.resolve(a.call(l,h)).then(b=>u.call(l,b));let d=a.call(l,h);return u.call(l,d)}:l[i]=(...h)=>{let d=a.apply(l,h);return d===!1&&(d=u.apply(l,h)),d}}r.hooks=l}if(n.walkTokens){let l=this.defaults.walkTokens,o=n.walkTokens;r.walkTokens=function(i){let a=[];return a.push(o.call(this,i)),l&&(a=a.concat(l.call(this,i))),a}}this.defaults={...this.defaults,...r}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return ce.lex(t,e??this.defaults)}parser(t,e){return ue.parse(t,e??this.defaults)}parseMarkdown(t){return(e,n)=>{let r={...n},l={...this.defaults,...r},o=this.onError(!!l.silent,!!l.async);if(this.defaults.async===!0&&r.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));l.hooks&&(l.hooks.options=l,l.hooks.block=t);let i=l.hooks?l.hooks.provideLexer():t?ce.lex:ce.lexInline,a=l.hooks?l.hooks.provideParser():t?ue.parse:ue.parseInline;if(l.async)return Promise.resolve(l.hooks?l.hooks.preprocess(e):e).then(u=>i(u,l)).then(u=>l.hooks?l.hooks.processAllTokens(u):u).then(u=>l.walkTokens?Promise.all(this.walkTokens(u,l.walkTokens)).then(()=>u):u).then(u=>a(u,l)).then(u=>l.hooks?l.hooks.postprocess(u):u).catch(o);try{l.hooks&&(e=l.hooks.preprocess(e));let u=i(e,l);l.hooks&&(u=l.hooks.processAllTokens(u)),l.walkTokens&&this.walkTokens(u,l.walkTokens);let h=a(u,l);return l.hooks&&(h=l.hooks.postprocess(h)),h}catch(u){return o(u)}}}onError(t,e){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let r="<p>An error occurred:</p><pre>"+ne(n.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(n);throw n}}},Se=new ls;function v(t,e){return Se.parse(t,e)}v.options=v.setOptions=function(t){return Se.setOptions(t),v.defaults=Se.defaults,Cr(v.defaults),v};v.getDefaults=sn;v.defaults=Ee;v.use=function(...t){return Se.use(...t),v.defaults=Se.defaults,Cr(v.defaults),v};v.walkTokens=function(t,e){return Se.walkTokens(t,e)};v.parseInline=Se.parseInline;v.Parser=ue;v.parser=ue.parse;v.Renderer=At;v.TextRenderer=fn;v.Lexer=ce;v.lexer=ce.lex;v.Tokenizer=kt;v.Hooks=pt;v.parse=v;v.options;v.setOptions;v.use;v.walkTokens;v.parseInline;ue.parse;ce.lex;/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:zr,setPrototypeOf:rr,isFrozen:os,getPrototypeOf:ss,getOwnPropertyDescriptor:is}=Object;let{freeze:B,seal:K,create:Fr}=Object,{apply:nn,construct:rn}=typeof Reflect<"u"&&Reflect;B||(B=function(e){return e});K||(K=function(e){return e});nn||(nn=function(e,n,r){return e.apply(n,r)});rn||(rn=function(e,n){return new e(...n)});const at=j(Array.prototype.forEach),as=j(Array.prototype.lastIndexOf),lr=j(Array.prototype.pop),Be=j(Array.prototype.push),cs=j(Array.prototype.splice),gt=j(String.prototype.toLowerCase),zt=j(String.prototype.toString),or=j(String.prototype.match),je=j(String.prototype.replace),us=j(String.prototype.indexOf),ds=j(String.prototype.trim),ee=j(Object.prototype.hasOwnProperty),F=j(RegExp.prototype.test),qe=hs(TypeError);function j(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),l=1;l<n;l++)r[l-1]=arguments[l];return nn(t,e,r)}}function hs(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rn(t,n)}}function x(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:gt;rr&&rr(t,null);let r=e.length;for(;r--;){let l=e[r];if(typeof l=="string"){const o=n(l);o!==l&&(os(e)||(e[r]=o),l=o)}t[l]=!0}return t}function ps(t){for(let e=0;e<t.length;e++)ee(t,e)||(t[e]=null);return t}function ae(t){const e=Fr(null);for(const[n,r]of zr(t))ee(t,n)&&(Array.isArray(r)?e[n]=ps(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=ae(r):e[n]=r);return e}function Ge(t,e){for(;t!==null;){const r=is(t,e);if(r){if(r.get)return j(r.get);if(typeof r.value=="function")return j(r.value)}t=ss(t)}function n(){return null}return n}const sr=B(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ft=B(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ht=B(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),gs=B(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Bt=B(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),fs=B(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ir=B(["#text"]),ar=B(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),jt=B(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),cr=B(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ct=B(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ms=K(/\{\{[\w\W]*|[\w\W]*\}\}/gm),bs=K(/<%[\w\W]*|[\w\W]*%>/gm),ys=K(/\$\{[\w\W]*/gm),ws=K(/^data-[\-\w.\u00B7-\uFFFF]+$/),ks=K(/^aria-[\-\w]+$/),Hr=K(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),As=K(/^(?:\w+script|data):/i),xs=K(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Br=K(/^html$/i),Ss=K(/^[a-z][.\w]*(-[.\w]+)+$/i);var ur=Object.freeze({__proto__:null,ARIA_ATTR:ks,ATTR_WHITESPACE:xs,CUSTOM_ELEMENT:Ss,DATA_ATTR:ws,DOCTYPE_NAME:Br,ERB_EXPR:bs,IS_ALLOWED_URI:Hr,IS_SCRIPT_OR_DATA:As,MUSTACHE_EXPR:ms,TMPLIT_EXPR:ys});const Ve={element:1,text:3,progressingInstruction:7,comment:8,document:9},vs=function(){return typeof window>"u"?null:window},Es=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const l="data-tt-policy-suffix";n&&n.hasAttribute(l)&&(r=n.getAttribute(l));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(i){return i},createScriptURL(i){return i}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},dr=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function jr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vs();const e=y=>jr(y);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==Ve.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,l=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:i,Node:a,Element:u,NodeFilter:h,NamedNodeMap:d=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:b,DOMParser:f,trustedTypes:S}=t,k=u.prototype,C=Ge(k,"cloneNode"),de=Ge(k,"remove"),Q=Ge(k,"nextSibling"),le=Ge(k,"childNodes"),J=Ge(k,"parentNode");if(typeof i=="function"){const y=n.createElement("template");y.content&&y.content.ownerDocument&&(n=y.content.ownerDocument)}let O,pe="";const{implementation:ge,createNodeIterator:fe,createDocumentFragment:Vr,getElementsByTagName:Yr}=n,{importNode:Zr}=r;let z=dr();e.isSupported=typeof zr=="function"&&typeof J=="function"&&ge&&ge.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:vt,ERB_EXPR:Et,TMPLIT_EXPR:_t,DATA_ATTR:Xr,ARIA_ATTR:Kr,IS_SCRIPT_OR_DATA:Qr,ATTR_WHITESPACE:mn,CUSTOM_ELEMENT:Jr}=ur;let{IS_ALLOWED_URI:bn}=ur,I=null;const yn=x({},[...sr,...Ft,...Ht,...Bt,...ir]);let P=null;const wn=x({},[...ar,...jt,...cr,...ct]);let R=Object.seal(Fr(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Pe=null,Tt=null,kn=!0,Nt=!0,An=!1,xn=!0,_e=!1,Je=!0,me=!1,Ct=!1,Rt=!1,Te=!1,et=!1,tt=!1,Sn=!0,vn=!1;const el="user-content-";let Lt=!0,De=!1,Ne={},Ce=null;const En=x({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let _n=null;const Tn=x({},["audio","video","img","source","image","track"]);let Mt=null;const Nn=x({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),nt="http://www.w3.org/1998/Math/MathML",rt="http://www.w3.org/2000/svg",oe="http://www.w3.org/1999/xhtml";let Re=oe,Ot=!1,It=null;const tl=x({},[nt,rt,oe],zt);let lt=x({},["mi","mo","mn","ms","mtext"]),ot=x({},["annotation-xml"]);const nl=x({},["title","style","font","a","script"]);let We=null;const rl=["application/xhtml+xml","text/html"],ll="text/html";let $=null,Le=null;const ol=n.createElement("form"),Cn=function(c){return c instanceof RegExp||c instanceof Function},$t=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Le&&Le===c)){if((!c||typeof c!="object")&&(c={}),c=ae(c),We=rl.indexOf(c.PARSER_MEDIA_TYPE)===-1?ll:c.PARSER_MEDIA_TYPE,$=We==="application/xhtml+xml"?zt:gt,I=ee(c,"ALLOWED_TAGS")?x({},c.ALLOWED_TAGS,$):yn,P=ee(c,"ALLOWED_ATTR")?x({},c.ALLOWED_ATTR,$):wn,It=ee(c,"ALLOWED_NAMESPACES")?x({},c.ALLOWED_NAMESPACES,zt):tl,Mt=ee(c,"ADD_URI_SAFE_ATTR")?x(ae(Nn),c.ADD_URI_SAFE_ATTR,$):Nn,_n=ee(c,"ADD_DATA_URI_TAGS")?x(ae(Tn),c.ADD_DATA_URI_TAGS,$):Tn,Ce=ee(c,"FORBID_CONTENTS")?x({},c.FORBID_CONTENTS,$):En,Pe=ee(c,"FORBID_TAGS")?x({},c.FORBID_TAGS,$):ae({}),Tt=ee(c,"FORBID_ATTR")?x({},c.FORBID_ATTR,$):ae({}),Ne=ee(c,"USE_PROFILES")?c.USE_PROFILES:!1,kn=c.ALLOW_ARIA_ATTR!==!1,Nt=c.ALLOW_DATA_ATTR!==!1,An=c.ALLOW_UNKNOWN_PROTOCOLS||!1,xn=c.ALLOW_SELF_CLOSE_IN_ATTR!==!1,_e=c.SAFE_FOR_TEMPLATES||!1,Je=c.SAFE_FOR_XML!==!1,me=c.WHOLE_DOCUMENT||!1,Te=c.RETURN_DOM||!1,et=c.RETURN_DOM_FRAGMENT||!1,tt=c.RETURN_TRUSTED_TYPE||!1,Rt=c.FORCE_BODY||!1,Sn=c.SANITIZE_DOM!==!1,vn=c.SANITIZE_NAMED_PROPS||!1,Lt=c.KEEP_CONTENT!==!1,De=c.IN_PLACE||!1,bn=c.ALLOWED_URI_REGEXP||Hr,Re=c.NAMESPACE||oe,lt=c.MATHML_TEXT_INTEGRATION_POINTS||lt,ot=c.HTML_INTEGRATION_POINTS||ot,R=c.CUSTOM_ELEMENT_HANDLING||{},c.CUSTOM_ELEMENT_HANDLING&&Cn(c.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(R.tagNameCheck=c.CUSTOM_ELEMENT_HANDLING.tagNameCheck),c.CUSTOM_ELEMENT_HANDLING&&Cn(c.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(R.attributeNameCheck=c.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),c.CUSTOM_ELEMENT_HANDLING&&typeof c.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(R.allowCustomizedBuiltInElements=c.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),_e&&(Nt=!1),et&&(Te=!0),Ne&&(I=x({},ir),P=[],Ne.html===!0&&(x(I,sr),x(P,ar)),Ne.svg===!0&&(x(I,Ft),x(P,jt),x(P,ct)),Ne.svgFilters===!0&&(x(I,Ht),x(P,jt),x(P,ct)),Ne.mathMl===!0&&(x(I,Bt),x(P,cr),x(P,ct))),c.ADD_TAGS&&(I===yn&&(I=ae(I)),x(I,c.ADD_TAGS,$)),c.ADD_ATTR&&(P===wn&&(P=ae(P)),x(P,c.ADD_ATTR,$)),c.ADD_URI_SAFE_ATTR&&x(Mt,c.ADD_URI_SAFE_ATTR,$),c.FORBID_CONTENTS&&(Ce===En&&(Ce=ae(Ce)),x(Ce,c.FORBID_CONTENTS,$)),Lt&&(I["#text"]=!0),me&&x(I,["html","head","body"]),I.table&&(x(I,["tbody"]),delete Pe.tbody),c.TRUSTED_TYPES_POLICY){if(typeof c.TRUSTED_TYPES_POLICY.createHTML!="function")throw qe('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof c.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw qe('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');O=c.TRUSTED_TYPES_POLICY,pe=O.createHTML("")}else O===void 0&&(O=Es(S,l)),O!==null&&typeof pe=="string"&&(pe=O.createHTML(""));B&&B(c),Le=c}},Rn=x({},[...Ft,...Ht,...gs]),Ln=x({},[...Bt,...fs]),sl=function(c){let g=J(c);(!g||!g.tagName)&&(g={namespaceURI:Re,tagName:"template"});const m=gt(c.tagName),N=gt(g.tagName);return It[c.namespaceURI]?c.namespaceURI===rt?g.namespaceURI===oe?m==="svg":g.namespaceURI===nt?m==="svg"&&(N==="annotation-xml"||lt[N]):!!Rn[m]:c.namespaceURI===nt?g.namespaceURI===oe?m==="math":g.namespaceURI===rt?m==="math"&&ot[N]:!!Ln[m]:c.namespaceURI===oe?g.namespaceURI===rt&&!ot[N]||g.namespaceURI===nt&&!lt[N]?!1:!Ln[m]&&(nl[m]||!Rn[m]):!!(We==="application/xhtml+xml"&&It[c.namespaceURI]):!1},te=function(c){Be(e.removed,{element:c});try{J(c).removeChild(c)}catch{de(c)}},Me=function(c,g){try{Be(e.removed,{attribute:g.getAttributeNode(c),from:g})}catch{Be(e.removed,{attribute:null,from:g})}if(g.removeAttribute(c),c==="is")if(Te||et)try{te(g)}catch{}else try{g.setAttribute(c,"")}catch{}},Mn=function(c){let g=null,m=null;if(Rt)c="<remove></remove>"+c;else{const M=or(c,/^[\r\n\t ]+/);m=M&&M[0]}We==="application/xhtml+xml"&&Re===oe&&(c='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+c+"</body></html>");const N=O?O.createHTML(c):c;if(Re===oe)try{g=new f().parseFromString(N,We)}catch{}if(!g||!g.documentElement){g=ge.createDocument(Re,"template",null);try{g.documentElement.innerHTML=Ot?pe:N}catch{}}const W=g.body||g.documentElement;return c&&m&&W.insertBefore(n.createTextNode(m),W.childNodes[0]||null),Re===oe?Yr.call(g,me?"html":"body")[0]:me?g.documentElement:W},On=function(c){return fe.call(c.ownerDocument||c,c,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},Pt=function(c){return c instanceof b&&(typeof c.nodeName!="string"||typeof c.textContent!="string"||typeof c.removeChild!="function"||!(c.attributes instanceof d)||typeof c.removeAttribute!="function"||typeof c.setAttribute!="function"||typeof c.namespaceURI!="string"||typeof c.insertBefore!="function"||typeof c.hasChildNodes!="function")},In=function(c){return typeof a=="function"&&c instanceof a};function se(y,c,g){at(y,m=>{m.call(e,c,g,Le)})}const $n=function(c){let g=null;if(se(z.beforeSanitizeElements,c,null),Pt(c))return te(c),!0;const m=$(c.nodeName);if(se(z.uponSanitizeElement,c,{tagName:m,allowedTags:I}),Je&&c.hasChildNodes()&&!In(c.firstElementChild)&&F(/<[/\w!]/g,c.innerHTML)&&F(/<[/\w!]/g,c.textContent)||c.nodeType===Ve.progressingInstruction||Je&&c.nodeType===Ve.comment&&F(/<[/\w]/g,c.data))return te(c),!0;if(!I[m]||Pe[m]){if(!Pe[m]&&Dn(m)&&(R.tagNameCheck instanceof RegExp&&F(R.tagNameCheck,m)||R.tagNameCheck instanceof Function&&R.tagNameCheck(m)))return!1;if(Lt&&!Ce[m]){const N=J(c)||c.parentNode,W=le(c)||c.childNodes;if(W&&N){const M=W.length;for(let G=M-1;G>=0;--G){const ie=C(W[G],!0);ie.__removalCount=(c.__removalCount||0)+1,N.insertBefore(ie,Q(c))}}}return te(c),!0}return c instanceof u&&!sl(c)||(m==="noscript"||m==="noembed"||m==="noframes")&&F(/<\/no(script|embed|frames)/i,c.innerHTML)?(te(c),!0):(_e&&c.nodeType===Ve.text&&(g=c.textContent,at([vt,Et,_t],N=>{g=je(g,N," ")}),c.textContent!==g&&(Be(e.removed,{element:c.cloneNode()}),c.textContent=g)),se(z.afterSanitizeElements,c,null),!1)},Pn=function(c,g,m){if(Sn&&(g==="id"||g==="name")&&(m in n||m in ol))return!1;if(!(Nt&&!Tt[g]&&F(Xr,g))){if(!(kn&&F(Kr,g))){if(!P[g]||Tt[g]){if(!(Dn(c)&&(R.tagNameCheck instanceof RegExp&&F(R.tagNameCheck,c)||R.tagNameCheck instanceof Function&&R.tagNameCheck(c))&&(R.attributeNameCheck instanceof RegExp&&F(R.attributeNameCheck,g)||R.attributeNameCheck instanceof Function&&R.attributeNameCheck(g))||g==="is"&&R.allowCustomizedBuiltInElements&&(R.tagNameCheck instanceof RegExp&&F(R.tagNameCheck,m)||R.tagNameCheck instanceof Function&&R.tagNameCheck(m))))return!1}else if(!Mt[g]){if(!F(bn,je(m,mn,""))){if(!((g==="src"||g==="xlink:href"||g==="href")&&c!=="script"&&us(m,"data:")===0&&_n[c])){if(!(An&&!F(Qr,je(m,mn,"")))){if(m)return!1}}}}}}return!0},Dn=function(c){return c!=="annotation-xml"&&or(c,Jr)},Wn=function(c){se(z.beforeSanitizeAttributes,c,null);const{attributes:g}=c;if(!g||Pt(c))return;const m={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:P,forceKeepAttr:void 0};let N=g.length;for(;N--;){const W=g[N],{name:M,namespaceURI:G,value:ie}=W,Ue=$(M),Dt=ie;let U=M==="value"?Dt:ds(Dt);if(m.attrName=Ue,m.attrValue=U,m.keepAttr=!0,m.forceKeepAttr=void 0,se(z.uponSanitizeAttribute,c,m),U=m.attrValue,vn&&(Ue==="id"||Ue==="name")&&(Me(M,c),U=el+U),Je&&F(/((--!?|])>)|<\/(style|title)/i,U)){Me(M,c);continue}if(m.forceKeepAttr)continue;if(!m.keepAttr){Me(M,c);continue}if(!xn&&F(/\/>/i,U)){Me(M,c);continue}_e&&at([vt,Et,_t],zn=>{U=je(U,zn," ")});const Un=$(c.nodeName);if(!Pn(Un,Ue,U)){Me(M,c);continue}if(O&&typeof S=="object"&&typeof S.getAttributeType=="function"&&!G)switch(S.getAttributeType(Un,Ue)){case"TrustedHTML":{U=O.createHTML(U);break}case"TrustedScriptURL":{U=O.createScriptURL(U);break}}if(U!==Dt)try{G?c.setAttributeNS(G,M,U):c.setAttribute(M,U),Pt(c)?te(c):lr(e.removed)}catch{Me(M,c)}}se(z.afterSanitizeAttributes,c,null)},il=function y(c){let g=null;const m=On(c);for(se(z.beforeSanitizeShadowDOM,c,null);g=m.nextNode();)se(z.uponSanitizeShadowNode,g,null),$n(g),Wn(g),g.content instanceof o&&y(g.content);se(z.afterSanitizeShadowDOM,c,null)};return e.sanitize=function(y){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=null,m=null,N=null,W=null;if(Ot=!y,Ot&&(y="<!-->"),typeof y!="string"&&!In(y))if(typeof y.toString=="function"){if(y=y.toString(),typeof y!="string")throw qe("dirty is not a string, aborting")}else throw qe("toString is not a function");if(!e.isSupported)return y;if(Ct||$t(c),e.removed=[],typeof y=="string"&&(De=!1),De){if(y.nodeName){const ie=$(y.nodeName);if(!I[ie]||Pe[ie])throw qe("root node is forbidden and cannot be sanitized in-place")}}else if(y instanceof a)g=Mn("<!---->"),m=g.ownerDocument.importNode(y,!0),m.nodeType===Ve.element&&m.nodeName==="BODY"||m.nodeName==="HTML"?g=m:g.appendChild(m);else{if(!Te&&!_e&&!me&&y.indexOf("<")===-1)return O&&tt?O.createHTML(y):y;if(g=Mn(y),!g)return Te?null:tt?pe:""}g&&Rt&&te(g.firstChild);const M=On(De?y:g);for(;N=M.nextNode();)$n(N),Wn(N),N.content instanceof o&&il(N.content);if(De)return y;if(Te){if(et)for(W=Vr.call(g.ownerDocument);g.firstChild;)W.appendChild(g.firstChild);else W=g;return(P.shadowroot||P.shadowrootmode)&&(W=Zr.call(r,W,!0)),W}let G=me?g.outerHTML:g.innerHTML;return me&&I["!doctype"]&&g.ownerDocument&&g.ownerDocument.doctype&&g.ownerDocument.doctype.name&&F(Br,g.ownerDocument.doctype.name)&&(G="<!DOCTYPE "+g.ownerDocument.doctype.name+`>
`+G),_e&&at([vt,Et,_t],ie=>{G=je(G,ie," ")}),O&&tt?O.createHTML(G):G},e.setConfig=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};$t(y),Ct=!0},e.clearConfig=function(){Le=null,Ct=!1},e.isValidAttribute=function(y,c,g){Le||$t({});const m=$(y),N=$(c);return Pn(m,N,g)},e.addHook=function(y,c){typeof c=="function"&&Be(z[y],c)},e.removeHook=function(y,c){if(c!==void 0){const g=as(z[y],c);return g===-1?void 0:cs(z[y],g,1)[0]}return lr(z[y])},e.removeHooks=function(y){z[y]=[]},e.removeAllHooks=function(){z=dr()},e}var _s=jr();v.setOptions({gfm:!0,breaks:!0,tables:!0,headerIds:!1,mangle:!1});const Ts=["p","br","strong","em","u","strike","del","s","h1","h2","h3","h4","h5","h6","ul","ol","li","blockquote","code","pre","table","thead","tbody","tr","th","td","a","img","hr","div","span"],Ns={a:["href","title"],img:["src","alt","title","width","height"],table:["class"],th:["align","class"],td:["align","class"],code:["class"],pre:["class"],div:["class"],span:["class"]};function Cs(t){if(!t||typeof t!="string")return"";try{const e=v(t);return _s.sanitize(e,{ALLOWED_TAGS:Ts,ALLOWED_ATTR:Ns,ALLOW_DATA_ATTR:!1,ALLOW_UNKNOWN_PROTOCOLS:!1,FORBID_SCRIPT:!0,FORBID_TAGS:["script","object","embed","form","input","button"],FORBID_ATTR:["onload","onerror","onclick","onmouseover","onfocus","onblur"]})}catch(e){return console.error("Error rendering markdown:",e),t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}}function Rs(t){const{worldName:e,messages:n=[],userInput:r="",messagesLoading:l,isSending:o,isWaiting:i,activeAgent:a,selectedAgent:u}=t,h=d=>{const b=yt(d.sender),f=yt(d.fromAgentId);return b!==f};return s.h("fieldset",{className:"chat-fieldset"},s.h("legend",null,e),s.h("div",{className:"chat-container"},s.h("div",{className:"conversation-area",ref:d=>d.scrollTop=d.scrollHeight},l?s.h("div",{className:"loading-messages"},"Loading messages..."):n.length===0?s.h("div",{className:"no-messages"},"No messages yet. Start a conversation!"):n.map((d,b)=>{const f=h(d),S=d.sender==="system"||d.sender==="SYSTEM",Q=`message ${d.sender==="HUMAN"||d.sender==="USER"||d.type==="user"?"user-message":"agent-message"} ${S?"system-message":""} ${f?"cross-agent-message":""}`.trim();return s.h("div",{key:d.id||b,className:Q},s.h("div",{className:"message-sender"},d.sender||(d.type==="user"?"User":"Agent"),f&&d.fromAgentId&&s.h("span",{className:"source-agent-indicator",title:`From agent: ${d.fromAgentId}`},"→ ",d.fromAgentId)),s.h("div",{className:"message-content"},mt(Cs(d.text))),s.h("div",{className:"message-timestamp"},d.createdAt?new Date(d.createdAt).toLocaleTimeString():"Now"),d.isStreaming&&s.h("div",{className:"streaming-indicator"},s.h("div",{className:"streaming-content"},s.h("div",{className:`agent-sprite sprite-${(a==null?void 0:a.spriteIndex)??0}`}),s.h("span",null,"responding ..."))),d.hasError&&s.h("div",{className:"error-indicator"},"Error: ",d.errorMessage),s.h("div",{className:"message-debug-info"},JSON.stringify({type:d.type,sender:d.sender,fromAgentId:d.fromAgentId})))}),i&&s.h("div",{className:"message user-message waiting-message"},s.h("div",{className:"message-content"},s.h("div",{className:"waiting-dots"},s.h("span",null,"."),s.h("span",null,"."),s.h("span",null,"."))))),s.h("div",{className:"input-area"},s.h("div",{className:"input-container"},s.h("input",{type:"text",className:"message-input",placeholder:"Type your message...",value:r||"",$oninput:"update-input",$onkeypress:"key-press"}),s.h("button",{className:"send-button",$onclick:"send-message",disabled:!r.trim()||o},o?"Sending...":"Send")))))}function Ls(t){const{world:e,selectedSettingsTarget:n,selectedAgent:r,totalMessages:l}=t,o=()=>{n==="agent"&&r?confirm(`Clear all messages for agent ${r.name}?`)&&s.run("clear-agent-messages",r):n==="world"&&e&&confirm(`Clear all messages for world ${e.name}?`)&&s.run("clear-world-messages")};return s.h("fieldset",{className:"settings-fieldset"},s.h("legend",null,n==="agent"&&r?`${r.name} Settings`:n==="world"&&e?`${e.name} Settings`:"Settings"),s.h("div",{className:"chat-settings"},n==="agent"&&r?s.h("div",{className:"agent-settings"},s.h("div",{className:"setting-item"},s.h("label",null,"Agent Name:"),s.h("span",null,s.h("span",{className:"setting-value"},r.name),s.h("button",{className:"action-btn",$onclick:["open-agent-edit",r],title:"Edit agent"},s.h("span",{className:"btn-icon"},"⚙")),s.h("button",{className:"action-btn",$onclick:["open-agent-delete",r],title:"Delete agent"},s.h("span",{className:"btn-icon"},"×")))),s.h("div",{className:"setting-item"},s.h("label",null,"Message Count:"),s.h("span",null,s.h("span",{className:"setting-value"},r.messageCount),s.h("button",{className:"action-btn",onclick:o,title:"Clear agent messages"},s.h("span",{className:"btn-icon"},"-")))),s.h("div",{className:"setting-item"},s.h("label",null,"LLM Provider:"),s.h("span",{className:"setting-value"},r.provider||"N/A")),s.h("div",{className:"setting-item"},s.h("label",null,"Model:"),s.h("span",{className:"setting-value"},r.model||"N/A")),s.h("div",{className:"setting-item"},s.h("label",null,"Temperature:"),s.h("span",{className:"setting-value"},r.temperature!==void 0?r.temperature:"N/A")),s.h("div",{className:"setting-item"},s.h("label",null,"System Prompt:"),s.h("span",{className:"system-prompt-preview"},r.systemPrompt?r.systemPrompt.length>100?r.systemPrompt.substring(0,100)+"...":r.systemPrompt:"N/A"))):n==="world"&&e?s.h("div",{className:"world-settings"},s.h("div",{className:"setting-item"},s.h("label",null,"World Name:"),s.h("span",null,s.h("span",{className:"setting-value"},e.name),s.h("button",{className:"action-btn",$onclick:"open-world-edit",title:"Edit world"},s.h("span",{className:"btn-icon"},"⚙")))),s.h("div",{className:"setting-item"},s.h("label",null,"Export World:"),s.h("span",null,s.h("button",{className:"action-btn",$onclick:["export-world-markdown",e.name],title:"Export world to markdown file"},s.h("span",{className:"btn-icon"},"↓")),s.h("button",{className:"action-btn",$onclick:["view-world-markdown",e.name],title:"View world markdown in new tab"},s.h("span",{className:"btn-icon"},"👁")))),s.h("div",{className:"setting-item"},s.h("label",null,"Agents Count:"),s.h("span",null,s.h("span",{className:"setting-value"},e.agents.length),s.h("button",{className:"action-btn",$onclick:"open-agent-create",title:"Add new agent"},s.h("span",{className:"btn-icon"},"+")))),s.h("div",{className:"setting-item"},s.h("label",null,"Total Messages:"),s.h("span",null,s.h("span",{className:"setting-value"},l),s.h("button",{className:"action-btn",$onclick:o,title:"Clear all messages"},s.h("span",{className:"btn-icon"},"-")))),s.h("div",{className:"setting-item"},s.h("label",null,"LLM Call Limit:"),s.h("span",{className:"setting-value"},e.llmCallLimit||"Unlimited"))):s.h("div",{className:"default-settings"},s.h("p",null,"Click on an agent or the gear icon to view settings"))))}const Ms=t=>({mode:t.mode||"create",worldName:t.worldName,agent:t.agent||qr,parentComponent:t.parentComponent,loading:!1}),qr={name:"",description:"",provider:"ollama",model:"llama3.2:3b",temperature:.7,systemPrompt:"You are a helpful assistant."},hr=async function*(t){if(!t.agent.name.trim()){yield{...t,error:"Agent name is required"};return}yield{...t,loading:!0,error:null};try{t.mode==="create"?await Z.createAgent(t.worldName,t.agent):await Z.updateAgent(t.worldName,t.agent.name,t.agent);const e=t.mode==="create"?"Agent created successfully!":"Agent updated successfully!";yield{...t,loading:!1,successMessage:e},setTimeout(()=>{t.parentComponent.run("agent-saved")},2e3)}catch(e){yield{...t,loading:!1,error:e.message||"Failed to save agent"}}},pr=async function*(t){yield{...t,loading:!0,error:null};try{await Z.deleteAgent(t.worldName,t.agent.name),yield{...t,loading:!1,successMessage:"Agent deleted successfully!"},setTimeout(()=>{t.parentComponent.run("agent-deleted")},2e3)}catch(e){yield{...t,loading:!1,error:e.message||"Failed to delete agent"}}},Ae=t=>{t!=null&&t.parentComponent&&typeof t.parentComponent.run=="function"?t.parentComponent.run("close-agent-edit"):s.run("close-agent-edit")};class Os extends xe{constructor(){super(...arguments);A(this,"mounted",n=>Ms(n));A(this,"state",{mode:"create",worldName:"",agent:qr,parentComponent:void 0,loading:!0});A(this,"view",n=>{if(n.loading)return s.h("div",{className:"modal-backdrop"},s.h("div",{className:"modal-content"},s.h("div",{className:"modal-body"},s.h("div",{className:"loading-spinner"},n.mode==="create"?"Creating agent...":n.mode==="edit"?"Updating agent...":"Deleting agent..."))));if(n.successMessage)return s.h("div",{className:"modal-backdrop",$onclick:Ae},s.h("div",{className:"modal-content",onclick:i=>i.stopPropagation()},s.h("div",{className:"modal-header"},s.h("h2",{className:"modal-title"},"Success!"),s.h("button",{className:"modal-close-btn",$onclick:Ae,title:"Close"},"×")),s.h("div",{className:"modal-body"},s.h("div",{className:"success-message"},s.h("p",null,n.successMessage)))));const r=n.mode==="edit",l=n.mode==="delete";let o;return l?o=`Delete ${n.agent.name||"Agent"}`:r?o=`Edit ${n.agent.name||"Agent"}`:o="Create New Agent",s.h("div",{className:"modal-backdrop",$onclick:Ae},s.h("div",{className:"modal-content",onclick:i=>i.stopPropagation()},s.h("div",{className:"modal-header"},s.h("h2",{className:"modal-title"},o),s.h("button",{className:"modal-close-btn",$onclick:Ae,title:"Close"},"×")),s.h("div",{className:"modal-body"},n.error&&s.h("div",{className:"error-message"},n.error),l?s.h("div",{className:"delete-confirmation"},s.h("p",{style:"font-size: 1rem;"},"Are you sure you want to delete ",s.h("span",{style:"font-size: 1.2rem;"},'"',n.agent.name,'"'),"?"),s.h("p",{style:"font-size: 1rem;"},"This action cannot be undone.")):s.h("form",{className:"agent-form"},s.h("div",{className:`form-group ${r?"hidden":""}`},s.h("div",{className:"form-row"},s.h("div",{className:"form-group"},s.h("label",{htmlFor:"agent-name"},"Agent Name *"),s.h("input",{id:"agent-name",type:"text",className:"form-input",placeholder:"Enter agent name",value:n.agent.name,$bind:"agent.name",disabled:n.loading})),s.h("div",{className:"form-group"},s.h("label",{htmlFor:"agent-temperature"},"Temperature"),s.h("input",{id:"agent-temperature",type:"number",className:"form-input",placeholder:"0.0 - 2.0",min:"0",max:"2",step:"0.1",value:n.agent.temperature,$bind:"agent.temperature",disabled:n.loading})))),s.h("div",{className:"form-section"},s.h("div",{className:"form-row"},s.h("div",{className:"form-group"},s.h("label",{htmlFor:"agent-provider"},"Provider"),s.h("select",{id:"agent-provider",className:"form-select",value:n.agent.provider,$bind:"agent.provider",disabled:n.loading},s.h("option",{value:"",selected:!n.agent.provider},"Select provider"),s.h("option",{value:"openai",selected:n.agent.provider==="openai"},"OpenAI"),s.h("option",{value:"anthropic",selected:n.agent.provider==="anthropic"},"Anthropic"),s.h("option",{value:"google",selected:n.agent.provider==="google"},"Google"),s.h("option",{value:"azure",selected:n.agent.provider==="azure"},"Azure"),s.h("option",{value:"ollama",selected:n.agent.provider==="ollama"},"Ollama"))),s.h("div",{className:"form-group"},s.h("label",{htmlFor:"agent-model"},"Model"),s.h("input",{id:"agent-model",type:"text",className:"form-input",placeholder:"e.g. gpt-4, claude-3-sonnet, llama3.2:3b",value:n.agent.model,$bind:"agent.model",disabled:n.loading})))),s.h("div",{className:"form-section"},s.h("div",{className:"form-group"},s.h("label",{htmlFor:"agent-prompt"},"System Prompt"),s.h("textarea",{id:"agent-prompt",className:"form-textarea",placeholder:"Enter the system prompt for this agent...",rows:8,value:n.agent.systemPrompt,$bind:"agent.systemPrompt",disabled:n.loading}))))),s.h("div",{className:"modal-footer"},s.h("div",{className:"modal-actions"},l?s.h("div",{className:"modal-primary-actions",style:"margin-left: auto;"},s.h("button",{className:"btn btn-secondary",$onclick:Ae,disabled:n.loading},"Cancel"),s.h("button",{className:"btn btn-danger",$onclick:[pr],disabled:n.loading},n.loading?"Deleting...":"Delete")):r?s.h(s.Fragment,null,s.h("button",{className:"btn btn-danger",$onclick:[pr],disabled:n.loading,title:"Delete agent"},n.loading?"Deleting...":"Delete"),s.h("div",{className:"modal-primary-actions"},s.h("button",{className:"btn btn-secondary",$onclick:Ae,disabled:n.loading},"Cancel"),s.h("button",{className:"btn btn-primary",$onclick:[hr],disabled:n.loading||!n.agent.name.trim()},n.loading?"Saving...":"Update"))):s.h("div",{className:"modal-primary-actions",style:"margin-left: auto;"},s.h("button",{className:"btn btn-secondary",$onclick:Ae,disabled:n.loading},"Cancel"),s.h("button",{className:"btn btn-primary",$onclick:[hr],disabled:n.loading||!n.agent.name.trim()},n.loading?"Saving...":"Create"))))))})}}function Gr(t){return t&&typeof t=="object"&&typeof t.worldName=="string"&&Array.isArray(t.messages)&&t.world&&Array.isArray(t.world.agents)}const re=(t,e)=>{s!=null&&s.run?s.run(t,e):console.warn("AppRun app not available for event:",t)};let X={activeMessages:new Map,currentWorldName:null};const Is=t=>{var e;!t||typeof t!="object"||(t.type==="sse"?$s(t):t.type==="message"?re("handleMessage",t):t.type==="response"||(t.type==="error"?re("handleError",{message:t.message||"SSE error"}):t.type==="connected"?(re("handleConnectionStatus","connected"),X.currentWorldName=((e=t.payload)==null?void 0:e.worldName)||null):t.type==="complete"&&re("handleComplete",t.payload)))},$s=t=>{const e=t.data;if(!e)return;const n=e.messageId||"default",r=e.sender||"Agent";switch(e.type){case"start":X.activeMessages.set(n,{content:"",sender:r,messageId:n,isStreaming:!0}),re("handleStreamStart",{messageId:n,sender:r,worldName:e.worldName||X.currentWorldName});break;case"chunk":const l=X.activeMessages.get(n);if(l){const i=e.accumulatedContent!==void 0?e.accumulatedContent:l.content+(e.content||"");l.content=i,re("handleStreamChunk",{messageId:n,sender:r,content:i,isAccumulated:e.accumulatedContent!==void 0,worldName:e.worldName||X.currentWorldName})}break;case"end":const o=X.activeMessages.get(n);if(o){const i=e.finalContent!==void 0?e.finalContent:o.content;re("handleStreamEnd",{messageId:n,sender:r,content:i,worldName:e.worldName||X.currentWorldName}),X.activeMessages.delete(n),X.activeMessages.size}break;case"error":re("handleStreamError",{messageId:n,sender:r,error:e.error||"Streaming error",worldName:e.worldName||X.currentWorldName}),X.activeMessages.delete(n);break}};async function Ps(t,e,n="HUMAN",r,l,o){if(!t||!e)throw new Error("World name and message are required");if(!e.trim())throw new Error("Message cannot be empty");X.currentWorldName=t;const i={message:e,sender:n},u=(await q(`/worlds/${encodeURIComponent(t)}/chat`,{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json",Accept:"text/event-stream","Cache-Control":"no-cache"}})).body.getReader(),h=new TextDecoder;let d="",b=!0;const f=()=>{if(b){b=!1;try{u.cancel()}catch(k){console.warn("Error canceling SSE reader:",k)}}};return(async()=>{try{for(;b;){const{done:k,value:C}=await u.read();if(k)break;d+=h.decode(C,{stream:!0});const de=d.split(`
`);d=de.pop()||"";for(const Q of de)if(Q.trim()!==""&&Q.startsWith("data: "))try{const le=Q.slice(6).trim();if(le==="")continue;const J=JSON.parse(le);Is(J),J.type}catch(le){console.error("Error parsing SSE data:",le),re("handleError",{message:"Failed to parse SSE data"})}}}catch(k){console.error("SSE stream error:",k);const C={message:k.message||"SSE stream error"};re("handleError",C)}finally{f()}})(),f}const Ds=(t,e)=>{const{messageId:n,sender:r,worldName:l}=e,o=r||"Agent";let i;if(Gr(t)&&t.world&&Array.isArray(t.world.agents)){const a=t.world.agents.find(u=>u.name===o);i=a==null?void 0:a.id}return{...t,messages:[...t.messages||[],{id:Date.now()+Math.random(),type:"agent-stream",sender:o,text:"",createdAt:new Date().toISOString(),worldName:l||t.worldName,isStreaming:!0,messageId:n,fromAgentId:i}],needScroll:!0}},Ws=(t,e)=>{const{messageId:n,sender:r,content:l,isAccumulated:o}=e,i=[...t.messages||[]];for(let a=i.length-1;a>=0;a--)if(i[a].isStreaming&&(i[a].messageId===n||!n&&i[a].sender===r&&i[a].type==="agent-stream"))return i[a]={...i[a],text:l||"",createdAt:new Date().toISOString()},{...t,messages:i,needScroll:!0};return{...t,messages:[...i,{id:Date.now()+Math.random(),type:"agent-stream",sender:r||"Agent",text:l||"",createdAt:new Date().toISOString(),worldName:e.worldName||t.worldName,isStreaming:!0,messageId:n}],needScroll:!0}},Us=(t,e)=>(t.messages=t.messages.filter(n=>n.messageId!==e.messageId),t),zs=(t,e)=>{const{messageId:n,sender:r,error:l}=e,o=(t.messages||[]).map(i=>i.isStreaming&&(i.messageId===n||!n&&i.sender===r&&i.type==="agent-stream")?{...i,isStreaming:!1,hasError:!0,errorMessage:l}:i);return{...t,messages:o}},Fs=(t,e)=>{const n=e.data||{},r=n.sender||n.agentName||"Agent";let l;if(Gr(t)&&t.world&&Array.isArray(t.world.agents)){const i=t.world.agents.find(a=>a.name===r);i&&i.messageCount++,l=i==null?void 0:i.id}const o={id:Date.now()+Math.random(),type:n.type||"message",sender:r,text:n.content||n.message||"",createdAt:n.createdAt||new Date().toISOString(),worldName:n.worldName||t.worldName,fromAgentId:l};return{...t,messages:[...t.messages||[],o],needScroll:!0,isWaiting:!1}},Hs=(t,e)=>({...t,connectionStatus:e,wsError:e==="error"?t.wsError:null}),Bs=(t,e)=>{const n=e.message||"SSE error",r={id:Date.now()+Math.random(),type:"error",sender:"System",text:n,createdAt:new Date().toISOString(),worldName:t.worldName,hasError:!0};return{...t,wsError:n,messages:[...t.messages||[],r],needScroll:!0}},js=(t,e)=>({...t,connectionStatus:"completed",isSending:!1,isWaiting:!1}),qs={"/World":async function*(t,e){if(!e){location.href="/";return}const n=decodeURIComponent(e);try{yield{...t,worldName:n,loading:!0,error:null,isWaiting:!1,activeAgent:null};const r=await Z.getWorld(n);if(!r){yield{...t,worldName:n,loading:!1,error:"World not found",isWaiting:!1,selectedSettingsTarget:"world",selectedAgent:null,activeAgent:null};return}let l=[];const o=await Promise.all(r.agents.map(async(a,u)=>{var h;if(a.memory&&Array.isArray(a.memory)){const d=a.memory.map(b=>{const f=yt(b.sender||a.name);let S="agent";return(f==="HUMAN"||f==="USER")&&(S="user"),{id:b.id||`${b.createdAt||Date.now()}-${Math.random()}`,sender:f,text:b.text||b.content||"",createdAt:b.createdAt||new Date().toISOString(),type:S,fromAgentId:a.id}});l=l.concat(d)}return{...a,spriteIndex:u%9,messageCount:((h=a.memory)==null?void 0:h.length)||0}})),i=l.sort((a,u)=>{const h=new Date(a.createdAt).getTime(),d=new Date(u.createdAt).getTime();return h-d});yield{...t,worldName:n,world:{name:n,agents:o,llmCallLimit:r.llmCallLimit||r.turnLimit},messages:i,loading:!1,error:null,isWaiting:!1,selectedSettingsTarget:"world",selectedAgent:null,activeAgent:null}}catch(r){yield{...t,worldName:n,world:{name:n,agents:[],llmCallLimit:void 0},loading:!1,error:r.message||"Failed to load world data",isWaiting:!1,selectedSettingsTarget:"world",selectedAgent:null,activeAgent:null}}},"update-input":(t,e)=>({...t,userInput:e.target.value}),"key-press":(t,e)=>{e.key==="Enter"&&(t.userInput||"").trim()&&s.run("send-message")},"send-message":async t=>{if(!(t.userInput||"").trim())return t;const e=t.userInput||"",n={id:Date.now()+Math.random(),type:"user",sender:"HUMAN",text:e,createdAt:new Date().toISOString(),worldName:t.worldName,userEntered:!0},r={...t,messages:[...t.messages||[],n],userInput:"",isSending:!0,isWaiting:!0};try{return await Ps(t.worldName,e,"HUMAN"),{...r,isSending:!1}}catch(l){return{...r,isSending:!1,isWaiting:!1,error:l.message||"Failed to send message"}}},handleStreamStart:(t,e)=>{var o;const n=Ds(t,e),r=e.sender,l=(o=t.world)==null?void 0:o.agents.find(i=>i.name===r);return{...n,isWaiting:!1,activeAgent:l?{spriteIndex:l.spriteIndex,name:l.name}:null}},handleStreamChunk:(t,e)=>Ws(t,e),handleStreamEnd:(t,e)=>({...Us(t,e),activeAgent:null}),handleStreamError:(t,e)=>({...zs(t,e),activeAgent:null}),handleMessage:(t,e)=>Fs(t,e),handleConnectionStatus:(t,e)=>Hs(t,e),handleError:(t,e)=>Bs(t,e),handleComplete:(t,e)=>js(t),"clear-agent-messages":async(t,e)=>{var n,r;try{await Z.clearAgentMemory(t.worldName,e.name);const l=(n=t.world)==null?void 0:n.agents.map(u=>u.id===e.id?{...u,messageCount:0}:u),o=(t.messages||[]).filter(u=>u.sender!==e.name),i=((r=t.selectedAgent)==null?void 0:r.id)===e.id?{...t.selectedAgent,messageCount:0}:t.selectedAgent,a=t.world?{...t.world,agents:l??[]}:null;return{...t,world:a,messages:o,selectedAgent:i}}catch(l){return{...t,error:l.message||"Failed to clear agent messages"}}},"clear-world-messages":async t=>{var e,n;try{await Promise.all((((e=t.world)==null?void 0:e.agents)??[]).map(i=>Z.clearAgentMemory(t.worldName,i.name)));const r=(((n=t.world)==null?void 0:n.agents)??[]).map(i=>({...i,messageCount:0})),l=t.selectedAgent?{...t.selectedAgent,messageCount:0}:null,o=t.world?{...t.world,agents:r??[]}:null;return{...t,world:o,messages:[],selectedAgent:l}}catch(r){return{...t,error:r.message||"Failed to clear world messages"}}},"select-world-settings":t=>({...t,selectedSettingsTarget:"world",selectedAgent:null,messages:(t.messages||[]).filter(e=>!e.userEntered)}),"select-agent-settings":(t,e)=>{var n;return t.selectedSettingsTarget==="agent"&&((n=t.selectedAgent)==null?void 0:n.id)===e.id?{...t,selectedSettingsTarget:"world",selectedAgent:null,messages:(t.messages||[]).filter(r=>!r.userEntered),userInput:""}:{...t,selectedSettingsTarget:"agent",selectedAgent:e,messages:(t.messages||[]).filter(r=>!r.userEntered),userInput:"@"+yt(e.name||"")+" "}},"delete-agent":async(t,e)=>{var n,r,l;try{await Z.deleteAgent(t.worldName,e.name);const o=(((n=t.world)==null?void 0:n.agents)??[]).filter(d=>d.id!==e.id),i=(t.messages||[]).filter(d=>d.sender!==e.name),a=t.world?{...t.world,agents:o??[]}:null,u=((r=t.selectedAgent)==null?void 0:r.id)===e.id?null:t.selectedAgent,h=((l=t.selectedAgent)==null?void 0:l.id)===e.id?"world":t.selectedSettingsTarget;return{...t,world:a,messages:i,selectedAgent:u,selectedSettingsTarget:h}}catch(o){return{...t,error:o.message||"Failed to delete agent"}}},"export-world-markdown":async(t,e)=>{try{return await Z.exportWorldToMarkdown(e),t}catch(n){return{...t,error:n.message||"Failed to export world"}}},"view-world-markdown":async(t,e)=>{try{const n=await Z.getWorldMarkdown(e),l=(a=>{let u=a;return u=u.replace(/^### (.*$)/gim,"<h3>$1</h3>"),u=u.replace(/^## (.*$)/gim,"<h2>$1</h2>"),u=u.replace(/^# (.*$)/gim,"<h1>$1</h1>"),u=u.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),u=u.replace(/\*(.*?)\*/g,"<em>$1</em>"),u=u.replace(/```([\s\S]*?)```/g,"<pre><code>$1</code></pre>"),u=u.replace(/`(.*?)`/g,"<code>$1</code>"),u=u.replace(/^\- (.*$)/gim,"<li>$1</li>"),u=u.replace(/(<li>.*<\/li>)/s,"<ul>$1</ul>"),u=u.replace(/\n/g,"<br>"),u=u.replace(/^---$/gm,"<hr>"),u})(n),o=`
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Export: ${e}</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }
        h1, h2, h3 { color: #2c3e50; }
        h1 { border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        h2 { border-bottom: 1px solid #bdc3c7; padding-bottom: 5px; }
        code { 
            background: #f8f9fa; 
            padding: 2px 4px; 
            border-radius: 3px; 
            font-family: 'Monaco', 'Consolas', monospace;
        }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        pre code {
            background: none;
            padding: 0;
        }
        ul { padding-left: 20px; }
        li { margin-bottom: 5px; }
        hr { 
            border: none; 
            height: 1px; 
            background: #bdc3c7; 
            margin: 30px 0; 
        }
        strong { color: #2c3e50; }
    </style>
</head>
<body>
    ${l}
</body>
</html>`,i=window.open();return i&&(i.document.write(o),i.document.close()),t}catch(n){return{...t,error:n.message||"Failed to view world markdown"}}}};class Gs extends xe{constructor(){super(...arguments);A(this,"state",async()=>({worldName:"World",world:null,messages:[],userInput:"",loading:!0,error:null,messagesLoading:!1,isSending:!1,isWaiting:!1,selectedSettingsTarget:"world",selectedAgent:null,activeAgent:null,showAgentEdit:!1,agentEditMode:"create",selectedAgentForEdit:null,showWorldEdit:!1,worldEditMode:"edit",selectedWorldForEdit:null,connectionStatus:"disconnected",wsError:null,needScroll:!1}));A(this,"view",n=>{var r,l,o;return n.loading?s.h("div",{className:"world-container"},s.h("div",{className:"world-columns"},s.h("div",{className:"chat-column"},s.h("div",{className:"agents-section"},s.h("div",{className:"agents-row"},s.h("div",{className:"loading-agents"},"Loading..."))),s.h("div",{className:"loading-state"},s.h("p",null,"Loading world data..."))),s.h("div",{className:"settings-column"},s.h("div",{className:"settings-section"},s.h("div",{className:"settings-row"},s.h("button",{className:"world-settings-btn",title:"World Settings"},s.h("span",{className:"world-gear-icon"},"⚙"))))))):n.error?s.h("div",{className:"world-container"},s.h("div",{className:"world-columns"},s.h("div",{className:"chat-column"},s.h("div",{className:"agents-section"},s.h("div",{className:"agents-row"},s.h("div",{className:"no-agents"},"Error"))),s.h("div",{className:"error-state"},s.h("p",null,"Error: ",n.error),s.h("button",{$onclick:["/World",n.worldName]},"Retry"))),s.h("div",{className:"settings-column"},s.h("div",{className:"settings-section"},s.h("div",{className:"settings-row"},s.h("button",{className:"world-settings-btn",title:"World Settings"},s.h("span",{className:"world-gear-icon"},"⚙"))))))):s.h("div",{className:"world-container"},s.h("div",{className:"world-columns"},s.h("div",{className:"chat-column"},s.h("div",{className:"agents-section"},s.h("div",{className:"agents-row agents-row-with-back"},s.h("div",{className:"back-button-container"},s.h("a",{href:"/"},s.h("button",{className:"back-button",title:"Back to Worlds"},s.h("span",{className:"world-back-icon"},"←")))),s.h("div",{className:"agents-list-container"},n.loading?s.h("div",{className:"loading-agents"},"Loading agents..."):(l=(r=n.world)==null?void 0:r.agents)!=null&&l.length?s.h("div",{className:"agents-list"},(o=n.world)==null?void 0:o.agents.map((i,a)=>{var h;const u=n.selectedSettingsTarget==="agent"&&((h=n.selectedAgent)==null?void 0:h.id)===i.id;return s.h("div",{key:`agent-${i.id||a}`,className:`agent-item ${u?"selected":""}`,$onclick:["select-agent-settings",i]},s.h("div",{className:"agent-sprite-container"},s.h("div",{className:`agent-sprite sprite-${i.spriteIndex}`}),s.h("div",{className:"message-badge"},i.messageCount)),s.h("div",{className:"agent-name"},i.name))})):s.h("div",{className:"no-agents"},"No agents in this world:",s.h("span",null," ",mt(`<a href="#" onclick="app.run('open-agent-create')">Create Agent</a>`)))))),s.h(Rs,{worldName:n.worldName,messages:n.messages,userInput:n.userInput,messagesLoading:n.messagesLoading,isSending:n.isSending,isWaiting:n.isWaiting,activeAgent:n.activeAgent,selectedAgent:n.selectedSettingsTarget==="agent"?n.selectedAgent:null})),s.h("div",{className:"settings-column"},s.h("div",{className:"settings-section"},s.h("div",{className:"settings-row"},s.h("button",{className:"world-settings-btn",title:"World Settings",$onclick:"select-world-settings"},s.h("span",{className:"world-gear-icon"},"⊕")))),s.h(Ls,{world:n.world,selectedSettingsTarget:n.selectedSettingsTarget,selectedAgent:n.selectedAgent,totalMessages:(n.messages||[]).length}))),n.showAgentEdit&&s.h(Os,{agent:n.selectedAgentForEdit,mode:n.agentEditMode,worldName:n.worldName,parentComponent:this}),n.showWorldEdit&&s.h(Nr,{world:n.selectedWorldForEdit,mode:n.worldEditMode,parentComponent:this}))});A(this,"is_global_event",()=>!0);A(this,"update",{...qs,"open-agent-create":n=>({...n,showAgentEdit:!0,agentEditMode:"create",selectedAgentForEdit:null}),"open-agent-edit":(n,r)=>({...n,showAgentEdit:!0,agentEditMode:"edit",selectedAgentForEdit:r}),"open-agent-delete":(n,r)=>({...n,showAgentEdit:!0,agentEditMode:"delete",selectedAgentForEdit:r}),"close-agent-edit":n=>({...n,showAgentEdit:!1}),"open-world-edit":n=>({...n,showWorldEdit:!0,worldEditMode:"edit",selectedWorldForEdit:n.world}),"close-world-edit":n=>({...n,showWorldEdit:!1}),"agent-saved":n=>{location.reload()},"agent-deleted":n=>{location.reload()}})}}s.render("#root",s.h(oo,null));s.addComponents("#pages",{"/":xo,"/World":Gs});
