var Te=Object.defineProperty;var Pe=(t,e,n)=>e in t?Te(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var k=(t,e,n)=>Pe(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(l){if(l.ep)return;l.ep=!0;const o=n(l);fetch(l.href,o)}})();const we="3.37.2",Ie=`AppRun-${we}`;class Se{constructor(){this._events={}}on(e,n,r={}){this._events[e]=this._events[e]||[],this._events[e].push({fn:n,options:r})}off(e,n){const r=this._events[e]||[];this._events[e]=r.filter(l=>l.fn!==n)}find(e){return this._events[e]}run(e,...n){const r=this.getSubscribers(e,this._events);return console.assert(r&&r.length>0,"No subscriber for event: "+e),r.forEach(l=>{const{fn:o,options:a}=l;if(!o||typeof o!="function")return console.error(`AppRun event handler for '${e}' is not a function:`,o),!1;if(a.delay)this.delay(e,o,n,a);else try{Object.keys(a).length>0?o.apply(this,[...n,a]):o.apply(this,n)}catch(i){console.error(`Error in event handler for '${e}':`,i)}return!l.options.once}),r.length}once(e,n,r={}){this.on(e,n,{...r,once:!0})}delay(e,n,r,l){l._t&&clearTimeout(l._t),l._t=setTimeout(()=>{clearTimeout(l._t);try{Object.keys(l).length>0?n.apply(this,[...r,l]):n.apply(this,r)}catch(o){console.error(`Error in delayed event handler for '${e}':`,o)}},l.delay)}runAsync(e,...n){const r=this.getSubscribers(e,this._events);console.assert(r&&r.length>0,"No subscriber for event: "+e);const l=r.map(o=>{const{fn:a,options:i}=o;if(!a||typeof a!="function")return console.error(`AppRun async event handler for '${e}' is not a function:`,a),Promise.resolve(null);try{return Object.keys(i).length>0?a.apply(this,[...n,i]):a.apply(this,n)}catch(h){return console.error(`Error in async event handler for '${e}':`,h),Promise.reject(h)}});return Promise.all(l)}query(e,...n){return console.warn("app.query() is deprecated. Use app.runAsync() instead."),this.runAsync(e,...n)}getSubscribers(e,n){const r=n[e]||[];return n[e]=r.filter(l=>!l.options.once),Object.keys(n).filter(l=>l.endsWith("*")&&e.startsWith(l.replace("*",""))).sort((l,o)=>o.length-l.length).forEach(l=>r.push(...n[l].map(o=>({...o,options:{...o.options,event:e}})))),r}}const Re=Ie;let z;const W=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};W.app&&W._AppRunVersions?z=W.app:(z=new Se,W.app=z,W._AppRunVersions=Re);const g=z;function M(t){return(t==null?void 0:t.target)instanceof HTMLElement?t.target:null}function De(t,e=document){try{return e.querySelector(t)}catch(n){return console.warn(`Invalid selector: ${t}`,n),null}}function We(t){try{return document.getElementById(t)}catch(e){return console.warn(`Error getting element by id: ${t}`,e),null}}const L=(t,e)=>(e?t.state[e]:t.state)||"",O=(t,e,n)=>{if(e){const r=t.state||{};r[e]=n,t.setState(r)}else t.setState(n)},$e=(t,e,n,r)=>{if(t.startsWith("$on")){const l=e[t];if(t=t.substring(1),typeof l=="boolean")e[t]=o=>r.run?r.run(t,o):g.run(t,o);else if(typeof l=="string")e[t]=o=>r.run?r.run(l,o):g.run(l,o);else if(typeof l=="function")e[t]=o=>r.setState(l(r.state,o));else if(Array.isArray(l)){const[o,...a]=l;typeof o=="string"?e[t]=i=>r.run?r.run(o,...a,i):g.run(o,...a,i):typeof o=="function"&&(e[t]=i=>r.setState(o(r.state,...a,i)))}}else if(t==="$bind"){const l=e.type||"text",o=typeof e[t]=="string"?e[t]:e.name;if(n==="input")switch(l){case"checkbox":e.checked=L(r,o),e.onclick=a=>{const i=M(a);i&&O(r,o||i.name,i.checked)};break;case"radio":e.checked=L(r,o)===e.value,e.onclick=a=>{const i=M(a);i&&O(r,o||i.name,i.value)};break;case"number":case"range":e.value=L(r,o),e.oninput=a=>{const i=M(a);i&&O(r,o||i.name,Number(i.value))};break;default:e.value=L(r,o),e.oninput=a=>{const i=M(a);i&&O(r,o||i.name,i.value)}}else n==="select"?(e.value=L(r,o),e.onchange=a=>{const i=M(a);i&&!i.multiple&&O(r,o||i.name,i.value)}):n==="option"?(e.selected=L(r,o),e.onclick=a=>{const i=M(a);i&&O(r,o||i.name,i.selected)}):n==="textarea"&&(e.innerHTML=L(r,o),e.oninput=a=>{const i=M(a);i&&O(r,o||i.name,i.value)})}else g.run("$",{key:t,tag:n,props:e,component:r})},K=(t,e)=>{if(Array.isArray(t))return t.map(n=>K(n,e));{let{type:n,tag:r,props:l,children:o}=t;return r=r||n,o=o||(l==null?void 0:l.children),l&&Object.keys(l).forEach(a=>{a.startsWith("$")&&($e(a,l,r,e),delete l[a])}),o&&K(o,e),t}};class H{constructor(e,n,r){this.normal=n,this.property=e,r&&(this.space=r)}}H.prototype.normal={};H.prototype.property={};H.prototype.space=void 0;function Ae(t,e){const n={},r={};for(const l of t)Object.assign(n,l.property),Object.assign(r,l.normal);return new H(n,r,e)}function ee(t){return t.toLowerCase()}class w{constructor(e,n){this.attribute=n,this.property=e}}w.prototype.attribute="";w.prototype.booleanish=!1;w.prototype.boolean=!1;w.prototype.commaOrSpaceSeparated=!1;w.prototype.commaSeparated=!1;w.prototype.defined=!1;w.prototype.mustUseProperty=!1;w.prototype.number=!1;w.prototype.overloadedBoolean=!1;w.prototype.property="";w.prototype.spaceSeparated=!1;w.prototype.space=void 0;let Ue=0;const f=T(),y=T(),ne=T(),u=T(),m=T(),I=T(),A=T();function T(){return 2**++Ue}const te=Object.freeze(Object.defineProperty({__proto__:null,boolean:f,booleanish:y,commaOrSpaceSeparated:A,commaSeparated:I,number:u,overloadedBoolean:ne,spaceSeparated:m},Symbol.toStringTag,{value:"Module"})),J=Object.keys(te);class ae extends w{constructor(e,n,r,l){let o=-1;if(super(e,n),ue(this,"space",l),typeof r=="number")for(;++o<J.length;){const a=J[o];ue(this,J[o],(r&te[a])===te[a])}}}ae.prototype.defined=!0;function ue(t,e,n){n&&(t[e]=n)}function R(t){const e={},n={};for(const[r,l]of Object.entries(t.properties)){const o=new ae(r,t.transform(t.attributes||{},r),l,t.space);t.mustUseProperty&&t.mustUseProperty.includes(r)&&(o.mustUseProperty=!0),e[r]=o,n[ee(r)]=r,n[ee(o.attribute)]=r}return new H(e,n,t.space)}const Ce=R({properties:{ariaActiveDescendant:null,ariaAtomic:y,ariaAutoComplete:null,ariaBusy:y,ariaChecked:y,ariaColCount:u,ariaColIndex:u,ariaColSpan:u,ariaControls:m,ariaCurrent:null,ariaDescribedBy:m,ariaDetails:null,ariaDisabled:y,ariaDropEffect:m,ariaErrorMessage:null,ariaExpanded:y,ariaFlowTo:m,ariaGrabbed:y,ariaHasPopup:null,ariaHidden:y,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:m,ariaLevel:u,ariaLive:null,ariaModal:y,ariaMultiLine:y,ariaMultiSelectable:y,ariaOrientation:null,ariaOwns:m,ariaPlaceholder:null,ariaPosInSet:u,ariaPressed:y,ariaReadOnly:y,ariaRelevant:null,ariaRequired:y,ariaRoleDescription:m,ariaRowCount:u,ariaRowIndex:u,ariaRowSpan:u,ariaSelected:y,ariaSetSize:u,ariaSort:null,ariaValueMax:u,ariaValueMin:u,ariaValueNow:u,ariaValueText:null,role:null},transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function Ne(t,e){return e in t?t[e]:e}function _e(t,e){return Ne(t,e.toLowerCase())}const je=R({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:I,acceptCharset:m,accessKey:m,action:null,allow:null,allowFullScreen:f,allowPaymentRequest:f,allowUserMedia:f,alt:null,as:null,async:f,autoCapitalize:null,autoComplete:m,autoFocus:f,autoPlay:f,blocking:m,capture:null,charSet:null,checked:f,cite:null,className:m,cols:u,colSpan:null,content:null,contentEditable:y,controls:f,controlsList:m,coords:u|I,crossOrigin:null,data:null,dateTime:null,decoding:null,default:f,defer:f,dir:null,dirName:null,disabled:f,download:ne,draggable:y,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:f,formTarget:null,headers:m,height:u,hidden:ne,high:u,href:null,hrefLang:null,htmlFor:m,httpEquiv:m,id:null,imageSizes:null,imageSrcSet:null,inert:f,inputMode:null,integrity:null,is:null,isMap:f,itemId:null,itemProp:m,itemRef:m,itemScope:f,itemType:m,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:f,low:u,manifest:null,max:null,maxLength:u,media:null,method:null,min:null,minLength:u,multiple:f,muted:f,name:null,nonce:null,noModule:f,noValidate:f,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:f,optimum:u,pattern:null,ping:m,placeholder:null,playsInline:f,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:f,referrerPolicy:null,rel:m,required:f,reversed:f,rows:u,rowSpan:u,sandbox:m,scope:null,scoped:f,seamless:f,selected:f,shadowRootClonable:f,shadowRootDelegatesFocus:f,shadowRootMode:null,shape:null,size:u,sizes:null,slot:null,span:u,spellCheck:y,src:null,srcDoc:null,srcLang:null,srcSet:null,start:u,step:null,style:null,tabIndex:u,target:null,title:null,translate:null,type:null,typeMustMatch:f,useMap:null,value:y,width:u,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:m,axis:null,background:null,bgColor:null,border:u,borderColor:null,bottomMargin:u,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:f,declare:f,event:null,face:null,frame:null,frameBorder:null,hSpace:u,leftMargin:u,link:null,longDesc:null,lowSrc:null,marginHeight:u,marginWidth:u,noResize:f,noHref:f,noShade:f,noWrap:f,object:null,profile:null,prompt:null,rev:null,rightMargin:u,rules:null,scheme:null,scrolling:y,standby:null,summary:null,text:null,topMargin:u,valueType:null,version:null,vAlign:null,vLink:null,vSpace:u,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:f,disableRemotePlayback:f,prefix:null,property:null,results:u,security:null,unselectable:null},space:"html",transform:_e}),He=R({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:A,accentHeight:u,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:u,amplitude:u,arabicForm:null,ascent:u,attributeName:null,attributeType:null,azimuth:u,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:u,by:null,calcMode:null,capHeight:u,className:m,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:u,diffuseConstant:u,direction:null,display:null,dur:null,divisor:u,dominantBaseline:null,download:f,dx:null,dy:null,edgeMode:null,editable:null,elevation:u,enableBackground:null,end:null,event:null,exponent:u,externalResourcesRequired:null,fill:null,fillOpacity:u,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:I,g2:I,glyphName:I,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:u,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:u,horizOriginX:u,horizOriginY:u,id:null,ideographic:u,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:u,k:u,k1:u,k2:u,k3:u,k4:u,kernelMatrix:A,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:u,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:u,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:u,overlineThickness:u,paintOrder:null,panose1:null,path:null,pathLength:u,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:m,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:u,pointsAtY:u,pointsAtZ:u,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:A,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:A,rev:A,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:A,requiredFeatures:A,requiredFonts:A,requiredFormats:A,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:u,specularExponent:u,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:u,strikethroughThickness:u,string:null,stroke:null,strokeDashArray:A,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:u,strokeOpacity:u,strokeWidth:null,style:null,surfaceScale:u,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:A,tabIndex:u,tableValues:null,target:null,targetX:u,targetY:u,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:A,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:u,underlineThickness:u,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:u,values:null,vAlphabetic:u,vMathematical:u,vectorEffect:null,vHanging:u,vIdeographic:u,version:null,vertAdvY:u,vertOriginX:u,vertOriginY:u,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:u,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:Ne}),Ee=R({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()}}),ke=R({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:_e}),xe=R({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()}}),Be=/[A-Z]/g,ce=/-[a-z]/g,Fe=/^data[-\w.:]+$/i;function ze(t,e){const n=ee(e);let r=e,l=w;if(n in t.normal)return t.property[t.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&Fe.test(e)){if(e.charAt(4)==="-"){const o=e.slice(5).replace(ce,qe);r="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=e.slice(4);if(!ce.test(o)){let a=o.replace(Be,Ve);a.charAt(0)!=="-"&&(a="-"+a),e="data"+a}}l=ae}return new l(r,e)}function Ve(t){return"-"+t.toLowerCase()}function qe(t){return t.charAt(1).toUpperCase()}const Ke=Ae([Ce,je,Ee,ke,xe],"html"),Xe=Ae([Ce,He,Ee,ke,xe],"svg"),de="_props",he=new Map;function Ye(t,e){if(e&&(e.class=e.class||e.className,delete e.className),!t||Object.keys(t).length===0)return e||{};if(!e||Object.keys(e).length===0){const r={};return Object.keys(t).forEach(l=>r[l]=null),r}const n={};return Object.keys(t).forEach(r=>{r in e||(n[r]=null)}),Object.keys(e).forEach(r=>n[r]=e[r]),n}function Ge(t){return t.length<=1?t.toLowerCase():t.split("-").map((e,n)=>n===0?e.toLowerCase():e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join("")}function Ze(t,e){const n=`${t}:${e}`;let r=he.get(n);return r===void 0&&(r=ze(e?Xe:Ke,t)||null,he.set(n,r)),r}function Je(t,e,n){const r=Ge(e.slice(5));n==null?delete t.dataset[r]:t.dataset[r]=String(n)}function Qe(t,e,n){e.startsWith("on")&&(!n||typeof n=="function"?t[e]=n:typeof n=="string"&&(n?t.setAttribute(e,n):t.removeAttribute(e)))}function fe(t,e,n){en(n)?t.setAttribute(e,e):t.removeAttribute(e)}function F(t,e,n){try{t[e]=n}catch{V(t,e,n,!1)}}function V(t,e,n,r){if(n==null){t.removeAttribute(e);return}const l=String(n);if(r&&e.includes(":")){const[o]=e.split(":");o==="xlink"?t.setAttributeNS("http://www.w3.org/1999/xlink",e,l):t.setAttribute(e,l)}else t.setAttribute(e,l)}function en(t){return t==null||t===!1||t===""?!1:t===!0?!0:typeof t=="string"?t.toLowerCase()!=="false"&&t!=="0":!!t}function nn(t,e,n,r){if(tn(t,e))return;if(e==="style"){if(t.style.cssText&&(t.style.cssText=""),typeof n=="string")t.style.cssText=n;else if(n&&typeof n=="object")for(const o in n)t.style[o]!==n[o]&&(t.style[o]=n[o]);return}if(e==="key"){n!=null&&(t.key=n);return}if(e.startsWith("data-")){Je(t,e,n);return}if(e.startsWith("on")){Qe(t,e,n);return}if((t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.tagName==="SELECT")&&(e==="value"||e==="selected"||e==="selectedIndex")){F(t,e,n);return}if(t.tagName==="INPUT"&&e==="checked"){F(t,e,n),fe(t,e,n);return}const l=Ze(e,r);l?l.boolean||l.overloadedBoolean?fe(t,l.attribute,n):l.mustUseProperty&&!r?F(t,l.property,n):V(t,l.attribute,n,r):e.startsWith("aria-")||e==="role"?V(t,e,n,r):e in t||t[e]!==void 0?F(t,e,n):V(t,e,n,r)}function tn(t,e){return document.activeElement===t?["selectionStart","selectionEnd","selectionDirection"].includes(e):!!(e==="scrollTop"||e==="scrollLeft"||t instanceof HTMLMediaElement&&["currentTime","paused","playbackRate","volume"].includes(e))}function rn(t){return/^[a-zA-Z_:][\w\-:.]*$/.test(t)&&!t.includes("<")&&!t.includes(">")&&!t.includes('"')&&!t.includes("'")}function ie(t,e,n){const r=t[de]||{},l=Ye(r,e);t[de]=e||{},ln(t,l,e,n)}function ln(t,e,n,r){for(const l in e)rn(l)&&nn(t,l,e[l],r);e&&typeof e.ref=="function"&&window.requestAnimationFrame(()=>e.ref(t))}function on(t,...e){return Me(e)}function Me(t){const e=[],n=r=>{r!=null&&r!==""&&r!==!1&&e.push(typeof r=="function"||typeof r=="object"?r:`${r}`)};return t&&t.forEach(r=>{Array.isArray(r)?r.forEach(l=>n(l)):n(r)}),e}const $={};let ge=0;const sn=500,an=1e3;function un(){if(!(Object.keys($).length<=an))for(const[t,e]of Object.entries($))e.isConnected||delete $[t]}function cn(t,e,...n){const r=Me(n);if(typeof t=="string")return{tag:t,props:e,children:r};if(Array.isArray(t))return t;if(t===void 0&&n)return r;if(Object.getPrototypeOf(t).__isAppRunComponent)return{tag:t,props:e,children:r};if(typeof t=="function")return t(e,r);throw new Error(`Unknown tag in vdom ${t}`)}const dn=(t,e,n={})=>{if(e==null||e===!1)return;const r=typeof t=="string"&&t?document.getElementById(t)||document.querySelector(t):t;e=K(e,n),hn(r,e,n)};function hn(t,e,n={}){if(e==null||e===!1||(e=q(e,n),!t))return;const r=t.nodeName==="SVG";Array.isArray(e)?re(t,e,r):re(t,[e],r)}function fn(t,e){const n=t.nodeName,r=`${e.tag||""}`;return n.toUpperCase()===r.toUpperCase()}function Q(t,e,n){if(n=n||e.tag==="svg",!fn(t,e)){t.parentNode.replaceChild(X(e,n),t);return}re(t,e.children,n),ie(t,e.props,n)}function re(t,e,n){var i,h;const r=((i=t.childNodes)==null?void 0:i.length)||0,l=(e==null?void 0:e.length)||0,o=Math.min(r,l);for(let d=0;d<o;d++){const c=e[d],p=t.childNodes[d];if(typeof c=="string")p.textContent!==c&&(p.nodeType===3?p.nodeValue=c:t.replaceChild(le(c),p));else if(c instanceof HTMLElement||c instanceof SVGElement)t.insertBefore(c,p);else{const b=c.props&&c.props.key;if(b)if(p.key===b)Q(t.childNodes[d],c,n);else{const S=$[b];S?(t.insertBefore(S,p),Q(t.childNodes[d],c,n)):t.replaceChild(X(c,n),p)}else Q(t.childNodes[d],c,n)}}let a=((h=t.childNodes)==null?void 0:h.length)||0;for(;a>o;)t.removeChild(t.lastChild),a--;if(l>o){const d=document.createDocumentFragment();for(let c=o;c<e.length;c++)d.appendChild(X(e[c],n));t.appendChild(d)}}const pe=t=>{const e=document.createElement("section");return e.insertAdjacentHTML("afterbegin",t),Array.from(e.children)};function le(t){if((t==null?void 0:t.indexOf("_html:"))===0){const e=document.createElement("div");return e.insertAdjacentHTML("afterbegin",t.substring(6)),e}else return document.createTextNode(t??"")}function X(t,e){if(t instanceof HTMLElement||t instanceof SVGElement)return t;if(typeof t=="string")return le(t);if(!t.tag||typeof t.tag=="function")return le(JSON.stringify(t));e=e||t.tag==="svg";const n=e?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag);return ie(n,t.props,e),t.children&&t.children.forEach(r=>n.appendChild(X(r,e))),t.props&&t.props.key!==void 0&&(n.key=t.props.key,$[t.props.key]=n,++ge>=sn&&(un(),ge=0)),n}function gn(t,e,n){const{tag:r,props:l,children:o}=t;let a=`_${n}`,i=l&&l.id;i?a=i:i=`_${n}${Date.now()}`;let h="section";l&&l.as&&(h=l.as,delete l.as),e.__componentCache||(e.__componentCache={});let d=e.__componentCache[a];if(!d||!(d instanceof r)||!d.element){const c=document.createElement(h);d=e.__componentCache[a]=new r({...l,children:o}).mount(c,{render:!0})}else d.renderState(d.state);if(d.mounted){const c=d.mounted(l,o,d.state);typeof c<"u"&&d.setState(c)}return ie(d.element,l,!1),d.element}function q(t,e,n=0){var l;if(typeof t=="string")return t;if(Array.isArray(t))return t.map(o=>q(o,e,n++));let r=t;if(t&&typeof t.tag=="function"&&Object.getPrototypeOf(t.tag).__isAppRunComponent&&(r=gn(t,e,n)),r&&Array.isArray(r.children)){const o=(l=r.props)==null?void 0:l._component;if(o){let a=0;r.children=r.children.map(i=>q(i,o,a++))}else r.children=r.children.map(a=>q(a,e,n++))}return r}const pn=(t,e={})=>class extends HTMLElement{constructor(){super()}get component(){return this._component}get state(){return this._component.state}static get observedAttributes(){return(e.observedAttributes||[]).map(r=>r.toLowerCase())}connectedCallback(){if(this.isConnected&&!this._component){const r=e||{};this._shadowRoot=r.shadow?this.attachShadow({mode:"open"}):this;const l=r.observedAttributes||[],o=l.reduce((i,h)=>{const d=h.toLowerCase();return d!==h&&(i[d]=h),i},{});this._attrMap=i=>o[i]||i;const a={};Array.from(this.attributes).forEach(i=>a[this._attrMap(i.name)]=i.value),l.forEach(i=>{this[i]!==void 0&&(a[i]=this[i]),Object.defineProperty(this,i,{get(){return a[i]},set(h){this.attributeChangedCallback(i,a[i],h)},configurable:!0,enumerable:!0})}),requestAnimationFrame(()=>{const i=this.children?Array.from(this.children):[];if(this._component=new t({...a,children:i}).mount(this._shadowRoot,r),this._component._props=a,this._component.dispatchEvent=this.dispatchEvent.bind(this),this._component.mounted){const h=this._component.mounted(a,i,this._component.state);typeof h<"u"&&(this._component.state=h)}this.on=this._component.on.bind(this._component),this.run=this._component.run.bind(this._component),r.render!==!1&&this._component.run(".")})}}disconnectedCallback(){var r,l,o,a;(l=(r=this._component)==null?void 0:r.unload)==null||l.call(r),(a=(o=this._component)==null?void 0:o.unmount)==null||a.call(o),this._component=null}attributeChangedCallback(r,l,o){if(this._component){const a=this._attrMap(r);this._component._props[a]=o,this._component.run("attributeChanged",a,l,o),o!==l&&e.render!==!1&&window.requestAnimationFrame(()=>{this._component.run(".")})}}},Le=(t,e,n)=>{typeof customElements<"u"&&customElements.define(t,pn(e,n))},oe={meta:new WeakMap,defineMetadata(t,e,n){this.meta.has(n)||this.meta.set(n,{}),this.meta.get(n)[t]=e},getMetadataKeys(t){return t=Object.getPrototypeOf(t),this.meta.get(t)?Object.keys(this.meta.get(t)):[]},getMetadata(t,e){return e=Object.getPrototypeOf(e),this.meta.get(e)?this.meta.get(e)[t]:null}};function mn(t,e={}){return function(n,r){const l=t?t.toString():r;oe.defineMetadata(`apprun-update:${l}`,{name:l,key:r,options:e},n)}}function yn(t,e){return function(r){return Le(t,r,e),r}}const me=t=>t,v=g;class U{renderState(e,n=null){if(!this.view)return;let r=n||this.view(e);if(v.debug&&v.run("debug",{component:this,_:r?".":"-",state:e,vdom:r,el:this.element}),typeof document!="object")return;const l=typeof this.element=="string"&&this.element?We(this.element)||De(this.element):this.element;if(!l){console.warn(`Component element not found: ${this.element}`);return}const o="_c";this.unload?(l._component!==this||l.getAttribute(o)!==this.tracking_id)&&(this.tracking_id=new Date().valueOf().toString(),l.setAttribute(o,this.tracking_id),typeof MutationObserver<"u"&&(this.observer||(this.observer=new MutationObserver(a=>{(a[0].oldValue===this.tracking_id||!document.body.contains(l))&&(this.unload(this.state),this.observer.disconnect(),this.observer=null)})),this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:[o]}))):l.removeAttribute&&l.removeAttribute(o),l._component=this,!n&&r&&(r=K(r,this),this.options.transition&&document&&document.startViewTransition?document.startViewTransition(()=>v.render(l,r,this)):v.render(l,r,this)),this.rendered&&this.rendered(this.state)}setState(e,n={render:!0,history:!1}){const r=async o=>{try{for(;;){const{value:a,done:i}=await o.next();if(i)break;this.setState(a,n)}}catch(a){console.error("Error in async iterator:",a)}},l=e;if(l!=null&&l[Symbol.asyncIterator]){this.setState(r(l[Symbol.asyncIterator]()),n);return}else if(l!=null&&l[Symbol.iterator]&&typeof l.next=="function"){for(const o of l)this.setState(o,n);return}else if(e&&e instanceof Promise)Promise.resolve(e).then(o=>{this.setState(o,n),this._state=e});else{if(this._state=e,e==null)return;this.state=e,n.render!==!1&&(n.transition&&document&&document.startViewTransition?document.startViewTransition(()=>this.renderState(e)):this.renderState(e)),n.history!==!1&&this.enable_history&&(this._history=[...this._history,e],this._history_idx=this._history.length-1),typeof n.callback=="function"&&n.callback(this.state)}}constructor(e,n,r,l){this.state=e,this.view=n,this.update=r,this.options=l,this._app=new Se,this._actions=[],this._global_events=[],this._history=[],this._history_idx=-1,this._history_prev=()=>{this._history_idx--,this._history_idx>=0?this.setState(this._history[this._history_idx],{render:!0,history:!1}):this._history_idx=0},this._history_next=()=>{this._history_idx++,this._history_idx<this._history.length?this.setState(this._history[this._history_idx],{render:!0,history:!1}):this._history_idx=this._history.length-1},this.start=(o=null,a)=>{if(this.mount(o,{render:!0,...a}),this.mounted&&typeof this.mounted=="function"){const i=this.mounted({},[],this.state);typeof i<"u"&&this.setState(i)}return this}}mount(e=null,n){var r;return console.assert(!this.element,"Component already mounted."),this.options=n={...this.options,...n},this.element=e,this.global_event=n.global_event,this.enable_history=!!n.history,this.enable_history&&(this.on(n.history.prev||"history-prev",this._history_prev),this.on(n.history.next||"history-next",this._history_next)),n.route&&(this.update=this.update||{},this.update[n.route]||(this.update[n.route]=me)),this.add_actions(),this.state=this.state??this.model??{},typeof this.state=="function"&&(this.state=this.state()),this.setState(this.state,{render:!!n.render,history:!0}),v.debug&&((r=v.find("debug-create-component"))!=null&&r.length)&&v.run("debug-create-component",this),this}is_global_event(e){return e&&(this.global_event||this._global_events.indexOf(e)>=0||e.startsWith("#")||e.startsWith("/")||e.startsWith("@"))}add_action(e,n,r={}){if(!n||typeof n!="function"){console.warn(`Component action for '${e}' is not a valid function:`,n);return}r.global&&this._global_events.push(e),this.on(e,(...l)=>{v.debug&&v.run("debug",{component:this,_:">",event:e,p:l,current_state:this.state,options:r});try{const o=n(this.state,...l);v.debug&&v.run("debug",{component:this,_:"<",event:e,p:l,newState:o,state:this.state,options:r}),this.setState(o,r)}catch(o){console.error(`Error in component action '${e}':`,o),v.debug&&v.run("debug",{component:this,_:"!",event:e,p:l,error:o,state:this.state,options:r})}},r)}add_actions(){const e=this.update||{};oe.getMetadataKeys(this).forEach(r=>{if(r.startsWith("apprun-update:")){const l=oe.getMetadata(r,this);e[l.name]=[this[l.key].bind(this),l.options]}});const n={};Array.isArray(e)?e.forEach(r=>{const[l,o,a]=r;l.toString().split(",").forEach(h=>n[h.trim()]=[o,a])}):Object.keys(e).forEach(r=>{const l=e[r];(typeof l=="function"||Array.isArray(l))&&r.split(",").forEach(o=>n[o.trim()]=l)}),n["."]||(n["."]=me),Object.keys(n).forEach(r=>{const l=n[r];typeof l=="function"?this.add_action(r,l):Array.isArray(l)&&this.add_action(r,l[0],l[1])})}run(e,...n){if(this.state instanceof Promise)return Promise.resolve(this.state).then(r=>{this.state=r,this.run(e,...n)});{const r=e.toString();return this.is_global_event(r)?v.run(r,...n):this._app.run(r,...n)}}on(e,n,r){const l=e.toString();return this._actions.push({name:l,fn:n}),this.is_global_event(l)?v.on(l,n,r):this._app.on(l,n,r)}runAsync(e,...n){const r=e.toString();return this.is_global_event(r)?v.runAsync(r,...n):this._app.runAsync(r,...n)}query(e,...n){return console.warn("component.query() is deprecated. Use component.runAsync() instead."),this.runAsync(e,...n)}unmount(){var e;(e=this.observer)==null||e.disconnect(),this._actions.forEach(n=>{const{name:r,fn:l}=n;this.is_global_event(r)?v.off(r,l):this._app.off(r,l)})}}U.__isAppRunComponent=!0;function bn(t){return t?t.startsWith("#/")?t.substring(2).split("/"):t.startsWith("#")||t.startsWith("/")?t.substring(1).split("/"):t.split("/"):[]}function vn(t){return!t||t==="/"||t==="#"||t==="#/"?t:t.endsWith("/")?t.slice(0,-1):t}function wn(t){const e=t.filter(Boolean);e.length>11&&console.warn(`Deep route hierarchy detected: ${e.join("/")} (${e.length} levels)`)}function Sn(t,e){if(!e||e==="/"||e==="")return t;const n=e.startsWith("/")?e:"/"+e;if(t.startsWith(n)){const r=t.substring(n.length);return r.startsWith("/")?r:"/"+r}return t}function An(t,e){const n=[];for(let r=t.length;r>0;r--){const l=t.slice(0,r);let o="";switch(e){case"path":o="/"+l.join("/");break;case"hash":o="#"+l.join("/");break;case"hash-slash":o="#/"+l.join("/");break;case"non-prefixed":o=l.join("/");break}n.push(o)}return n}function Cn(t,e){for(let n=0;n<t.length;n++){const r=t[n],l=g.find(r);if(l&&l.length>0){const o=t.length-n,a=e.slice(o);return{eventName:r,parameters:a}}}return null}function ye(){const t=g.find("#");if(t&&t.length>0){g.run("#"),g.run(x,"#");return}const e=g.find("/");if(e&&e.length>0){g.run("/"),g.run(x,"/");return}const n=g.find("#/");if(n&&n.length>0){g.run("#/"),g.run(x,"#/");return}console.warn("No subscribers for event: "),g.run(j,""),g.run(x,"")}function Nn(t){if(!t){ye();return}t=vn(t);const e=g.basePath;e&&(t=Sn(t,e));const n=bn(t);wn(n);let r;t.startsWith("#/")?r="hash-slash":t.startsWith("#")?r="hash":t.startsWith("/")?r="path":r="non-prefixed";const l=An(n,r),o=Cn(l,n);if(o)_n(o.eventName,...o.parameters);else if(l.length>0){const a=l[l.length-1];console.warn(`No subscribers for event: ${a}`),g.run(j,t),g.run(x,t)}else ye()}const _n=(t,...e)=>{if(!t||t===x||t===j)return;const n=g.find(t);!n||n.length===0?(console.warn(`No subscribers for event: ${t}`),g.run(j,t,...e)):g.run(t,...e),g.run(x,t,...e)},x="//",j="///",P=t=>{g.lastUrl!==t&&(g.lastUrl=t,Nn(t))};function be(t){return t&&typeof t=="object"&&typeof t.mount=="function"}function se(t){return typeof t=="function"&&t.prototype&&t.prototype.constructor===t&&(t.prototype.mount!==void 0||t.prototype.state!==void 0||t.prototype.view!==void 0)}function Oe(t){return typeof t=="function"&&!se(t)}async function En(t,e=3){let n=t,r=0;for(;Oe(n)&&r<e;)try{const l=await n();if(l===n)break;n=l,r++}catch(l){console.error(`Error executing component function: ${l}`);break}return n}const kn=async(t,e)=>{for(const[n,r]of Object.entries(e)){if(!r||!n){console.error(`Invalid component configuration: component=${r}, route=${n}`);continue}if(be(r)){const l={route:n};r.mount(t,l);continue}if(se(r)){const l=new r,o={route:n};l.mount(t,o);continue}if(Oe(r)){let l=await En(r);if(be(l)){const o={route:n};l.mount(t,o);continue}if(se(l)){const o=new l,a={route:n};o.mount(t,a);continue}g.on(n,(...o)=>{const a=r(...o);if(typeof t=="string"&&(t=document.querySelector(t),!t)){console.error(`Element not found: ${t}`);return}return g.render(t,a)});continue}console.error("Invalid component: component must be a class, instance, or function that returns a class/instance")}},s=g;if(!s.start){s.version=we,s.h=s.createElement=cn,s.render=dn,s.Fragment=on,s.webComponent=Le,s.safeHTML=pe,s.start=(e,n,r,l,o)=>{const a={render:!0,global_event:!0,...o},i=new U(n,r,l);return o&&o.rendered&&(i.rendered=o.rendered),o&&o.mounted&&(i.mounted=o.mounted),i.start(e,a),i},s.query=s.query||s.runAsync;const t=e=>{};if(s.on("/",t),s.on("debug",e=>t),s.on(x,t),s.on(j,t),s.route=P,s.on("route",e=>s.route&&s.route(e)),typeof document=="object"&&document.addEventListener("DOMContentLoaded",()=>{const e=document.body.hasAttribute("apprun-no-init")||s["no-init-route"]||!1,n=s.find("#")||s.find("#/")||!1;window.addEventListener("hashchange",()=>P(location.hash)),window.addEventListener("popstate",()=>P(location.pathname)),n?!e&&P(location.hash):(!e&&(()=>{const r=s.basePath||"";let l=location.pathname;r&&l.startsWith(r)&&(l=l.substring(r.length),l.startsWith("/")||(l="/"+l)),P(l)})(),document.body.addEventListener("click",r=>{const l=r.target;if(!l)return;const o=l.tagName==="A"?l:l.closest("a");if(o&&o.origin===location.origin&&o.pathname){r.preventDefault();const i=(s.basePath||"")+o.pathname;history.pushState(null,"",i),P(o.pathname)}}))}),typeof window=="object"){const e=window;e.Component=U,e._React=e.React,e.React=s,e.on=mn,e.customElement=yn,e.safeHTML=pe}s.use_render=(e,n=0)=>{n===0?s.render=(r,l)=>e(l,r):s.render=(r,l)=>e(r,l)},s.use_react=(e,n)=>{if(!e||!n){console.error("AppRun use_react: React and ReactDOM parameters are required");return}if(typeof e.createElement!="function"){console.error("AppRun use_react: Invalid React object - createElement method not found");return}if(!e.Fragment){console.error("AppRun use_react: Invalid React object - Fragment not found");return}if(s.h=s.createElement=e.createElement,s.Fragment=e.Fragment,e.version&&e.version.startsWith("18")){if(!n.createRoot||typeof n.createRoot!="function"){console.error("AppRun use_react: ReactDOM.createRoot not found in React 18+");return}s.render=(r,l)=>{!r||l===void 0||(r._root||(r._root=n.createRoot(r)),r._root.render(l))}}else{if(!n.render||typeof n.render!="function"){console.error("AppRun use_react: ReactDOM.render not found in legacy React");return}s.render=(r,l)=>n.render(l,r)}},s.addComponents=kn}const xn=()=>s.h("div",{id:"main"},s.h("div",{id:"pages"})),Mn="/api";async function Y(t,e={}){const n=`${Mn}${t}`;try{const r=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!r.ok){let l=`HTTP ${r.status}: ${r.statusText}`;try{const o=await r.json();o.error&&(l=o.error,o.code&&(l+=` (${o.code})`))}catch{}throw new Error(l)}return r}catch(r){throw console.error(`API request failed for ${t}:`,r),r}}async function Ln(){return(await Y("/worlds")).json()}async function On(t){if(!t)throw new Error("World name is required");return(await Y(`/worlds/${encodeURIComponent(t)}`)).json()}async function ve(t,e){if(!t||!e)throw new Error("World name and agent name are required");await Y(`/worlds/${encodeURIComponent(t)}/agents/${encodeURIComponent(e)}/memory`,{method:"DELETE"})}class Tn extends U{constructor(){super(...arguments);k(this,"state",async()=>({worlds:await Ln(),currentIndex:0,loading:!1,error:null}));k(this,"view",n=>{var r,l,o,a;return n.loading?s.h("div",{class:"container"},s.h("div",{class:"row"},s.h("div",{class:"col"},s.h("div",{class:"loading-message"},"Loading worlds...")))):n.error?s.h("div",{class:"container"},s.h("div",{class:"row"},s.h("div",{class:"col"},s.h("div",{class:"error-message"},s.h("h3",null,"Error loading worlds"),s.h("p",null,n.error),s.h("button",{class:"btn btn-primary",$onclick:"/"},"Retry"))))):n.worlds.length===0?s.h("div",{class:"container"},s.h("div",{class:"row"},s.h("div",{class:"col"},s.h("div",{class:"no-worlds-message"},s.h("h3",null,"No worlds found"),s.h("p",null,"Create your first world to get started!"),s.h("a",{href:"/World"},s.h("button",{class:"btn btn-primary"},"Create World")))))):s.h("div",{class:"container"},s.h("div",{class:"row"},s.h("div",{class:"col banner-col"},s.h("h1",{class:"banner-title"},"PICK YOUR WORLD"))),s.h("div",{class:"row carousel-row"},s.h("div",{class:"col"},s.h("div",{class:"world-carousel"},s.h("button",{class:"btn carousel-arrow",$onclick:"prev-world"},"‹"),s.h("div",{class:"world-cards"},n.worlds.map((i,h)=>{const d=h===n.currentIndex;let c=!1;return n.worlds.length<=3?c=!0:c=Math.abs(h-n.currentIndex)<=1,c?s.h("button",{class:`btn world-card-btn ${d?"btn-primary center":"btn-secondary side"}`,$onclick:d?["enter-world",i]:["select-world",i]},s.h("span",{class:"world-name"},i.name)):null})),s.h("button",{class:"btn carousel-arrow",$onclick:"next-world"},"›")),s.h("div",{class:"world-indicators"},n.worlds.map((i,h)=>s.h("button",{class:`world-dot ${h===n.currentIndex?"active":""}`,$onclick:["select-world",i],title:i.name}))))),s.h("div",{class:"row"},s.h("div",{class:"col"},s.h("div",{class:"description-card"},s.h("h4",{class:"description-title"},((r=n.worlds[n.currentIndex])==null?void 0:r.name)||"Unknown World"),s.h("p",{class:"description-text"},((l=n.worlds[n.currentIndex])==null?void 0:l.description)||"No description available"),s.h("div",{class:"action-buttons"},s.h("a",{href:"/World"},s.h("button",{class:"btn add-world-btn",title:"Add New World"},s.h("span",{class:"plus-icon"},"+"))),s.h("a",{href:"/World/"+(((o=n.worlds[n.currentIndex])==null?void 0:o.name)||"")},s.h("button",{class:"btn btn-primary enter-btn"},"Enter ",((a=n.worlds[n.currentIndex])==null?void 0:a.name)||"World")),s.h("a",{href:"/Settings"},s.h("button",{class:"btn settings-btn",title:"Settings"},s.h("span",{class:"gear-icon"},"⚙"))))))))});k(this,"update",{"prev-world":n=>({...n,currentIndex:n.currentIndex>0?n.currentIndex-1:n.worlds.length-1}),"next-world":n=>({...n,currentIndex:n.currentIndex<n.worlds.length-1?n.currentIndex+1:0}),"select-world":(n,r)=>{const l=n.worlds.findIndex(o=>o.name===r.name);return{...n,currentIndex:l>=0?l:n.currentIndex}},"enter-world":(n,r)=>{window.location.href="/World/"+r.name}})}}const _=(t,e)=>{s!=null&&s.run?s.run(t,e):console.warn("AppRun app not available for event:",t)};let C={activeMessages:new Map,currentWorldName:null};const Pn=t=>{var e;!t||typeof t!="object"||(t.type==="sse"?In(t):t.type==="message"?_("handleMessage",t):t.type==="response"||(t.type==="error"?_("handleError",{message:t.message||"SSE error"}):t.type==="connected"?(_("handleConnectionStatus","connected"),C.currentWorldName=((e=t.payload)==null?void 0:e.worldName)||null):t.type==="complete"&&_("handleComplete",t.payload)))},In=t=>{const e=t.data;if(!e)return;const n=e.messageId||"default",r=e.sender||"Agent";switch(e.type){case"start":C.activeMessages.set(n,{content:"",sender:r,messageId:n,isStreaming:!0}),_("handleStreamStart",{messageId:n,sender:r,worldName:e.worldName||C.currentWorldName});break;case"chunk":const l=C.activeMessages.get(n);if(l){const a=e.accumulatedContent!==void 0?e.accumulatedContent:l.content+(e.content||"");l.content=a,_("handleStreamChunk",{messageId:n,sender:r,content:a,isAccumulated:e.accumulatedContent!==void 0,worldName:e.worldName||C.currentWorldName})}break;case"end":const o=C.activeMessages.get(n);if(o){const a=e.finalContent!==void 0?e.finalContent:o.content;_("handleStreamEnd",{messageId:n,sender:r,content:a,worldName:e.worldName||C.currentWorldName}),C.activeMessages.delete(n),C.activeMessages.size}break;case"error":_("handleStreamError",{messageId:n,sender:r,error:e.error||"Streaming error",worldName:e.worldName||C.currentWorldName}),C.activeMessages.delete(n);break}};async function Rn(t,e,n="HUMAN",r,l,o){if(!t||!e)throw new Error("World name and message are required");if(!e.trim())throw new Error("Message cannot be empty");C.currentWorldName=t;const a={message:e,sender:n},h=(await Y(`/worlds/${encodeURIComponent(t)}/chat`,{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json",Accept:"text/event-stream","Cache-Control":"no-cache"}})).body.getReader(),d=new TextDecoder;let c="",p=!0;const b=()=>{if(p){p=!1;try{h.cancel()}catch(N){console.warn("Error canceling SSE reader:",N)}}};return(async()=>{try{for(;p;){const{done:N,value:E}=await h.read();if(N)break;c+=d.decode(E,{stream:!0});const D=c.split(`
`);c=D.pop()||"";for(const G of D)if(G.trim()!==""&&G.startsWith("data: "))try{const B=G.slice(6).trim();if(B==="")continue;const Z=JSON.parse(B);Pn(Z),Z.type}catch(B){console.error("Error parsing SSE data:",B),_("handleError",{message:"Failed to parse SSE data"})}}}catch(N){console.error("SSE stream error:",N);const E={message:N.message||"SSE stream error"};_("handleError",E)}finally{b()}})(),b}const Dn=(t,e)=>{const{messageId:n,sender:r,worldName:l}=e,o=r||"Agent";let a;if("agents"in t&&Array.isArray(t.agents)){const i=t.agents.find(h=>h.name===o);a=i==null?void 0:i.id}return{...t,messages:[...t.messages||[],{id:Date.now()+Math.random(),type:"agent-stream",sender:o,text:"",createdAt:new Date().toISOString(),worldName:l||t.worldName,isStreaming:!0,messageId:n,fromAgentId:a}],needScroll:!0}},Wn=(t,e)=>{const{messageId:n,sender:r,content:l,isAccumulated:o}=e,a=[...t.messages||[]];for(let i=a.length-1;i>=0;i--)if(a[i].isStreaming&&(a[i].messageId===n||!n&&a[i].sender===r&&a[i].type==="agent-stream"))return a[i]={...a[i],text:l||"",createdAt:new Date().toISOString()},{...t,messages:a,needScroll:!0};return{...t,messages:[...a,{id:Date.now()+Math.random(),type:"agent-stream",sender:r||"Agent",text:l||"",createdAt:new Date().toISOString(),worldName:e.worldName||t.worldName,isStreaming:!0,messageId:n}],needScroll:!0}},$n=(t,e)=>{const{messageId:n,sender:r,content:l}=e,o=(t.messages||[]).filter(a=>!(a.isStreaming&&(a.messageId===n||!n&&a.sender===r&&a.type==="agent-stream")));return{...t,messages:o}},Un=(t,e)=>{const{messageId:n,sender:r,error:l}=e,o=(t.messages||[]).map(a=>a.isStreaming&&(a.messageId===n||!n&&a.sender===r&&a.type==="agent-stream")?{...a,isStreaming:!1,hasError:!0,errorMessage:l}:a);return{...t,messages:o}},jn=(t,e)=>{const n=e.data||{},r=n.sender||n.agentName||"Agent";let l;if("agents"in t&&Array.isArray(t.agents)){const a=t.agents.find(i=>i.name===r);l=a==null?void 0:a.id}const o={id:Date.now()+Math.random(),type:n.type||"message",sender:r,text:n.content||n.message||"",createdAt:n.createdAt||new Date().toISOString(),worldName:n.worldName||t.worldName,fromAgentId:l};return{...t,messages:[...t.messages||[],o],needScroll:!0,isWaiting:!1}},Hn=(t,e)=>({...t,connectionStatus:e,wsError:e==="error"?t.wsError:null}),Bn=(t,e)=>{const n=e.message||"SSE error",r={id:Date.now()+Math.random(),type:"error",sender:"System",text:n,createdAt:new Date().toISOString(),worldName:t.worldName,hasError:!0};return{...t,wsError:n,messages:[...t.messages||[],r],needScroll:!0}},Fn=(t,e)=>({...t,connectionStatus:"completed"});function zn(t){const{worldName:e,messages:n,userInput:r,messagesLoading:l,isSending:o,isWaiting:a,activeAgent:i,selectedAgent:h}=t,d=c=>{if(!c.fromAgentId||c.sender==="HUMAN"||c.sender==="USER"||c.type==="user"||c.sender==="system"||c.sender==="SYSTEM")return!1;const p=c.sender.toLowerCase(),b=c.fromAgentId.toLowerCase();return!(p.includes(b)||b.includes(p))};return s.h("fieldset",{className:"chat-fieldset"},s.h("legend",null,e),s.h("div",{className:"chat-container"},s.h("div",{className:"conversation-area",ref:c=>c.scrollTop=c.scrollHeight},l?s.h("div",{className:"loading-messages"},"Loading messages..."):n.length===0?s.h("div",{className:"no-messages"},"No messages yet. Start a conversation!"):n.filter(c=>c.sender==="HUMAN"||c.sender==="USER"||c.type==="user"||c.sender==="system"||c.sender==="SYSTEM"?!0:h!=null&&h.id&&c.fromAgentId!==h.id?!1:c.isStreaming===!0&&c.streamComplete!==!0||c.streamComplete===!0||c.streamComplete===void 0&&c.isStreaming===void 0).map((c,p)=>{const b=d(c),E=`message ${c.sender==="HUMAN"||c.sender==="USER"||c.type==="user"?"user-message":"agent-message"} ${b?"cross-agent-message":""}`.trim();return s.h("div",{key:c.id||p,className:E},s.h("div",{className:"message-sender"},c.sender||(c.type==="user"?"User":"Agent"),b&&c.fromAgentId&&s.h("span",{className:"source-agent-indicator",title:`From agent: ${c.fromAgentId}`},"→ ",c.fromAgentId)),s.h("div",{className:"message-content"},c.text),s.h("div",{className:"message-timestamp"},c.createdAt?new Date(c.createdAt).toLocaleTimeString():"Now"),c.isStreaming&&s.h("div",{className:"streaming-indicator"},s.h("div",{className:"streaming-content"},s.h("div",{className:`agent-sprite sprite-${(i==null?void 0:i.spriteIndex)??0}`}),s.h("span",null,"responding ..."))),c.hasError&&s.h("div",{className:"error-indicator"},"Error: ",c.errorMessage))}),a&&s.h("div",{className:"message user-message waiting-message"},s.h("div",{className:"message-content"},s.h("div",{className:"waiting-dots"},s.h("span",null,"."),s.h("span",null,"."),s.h("span",null,"."))))),s.h("div",{className:"input-area"},s.h("div",{className:"input-container"},s.h("input",{type:"text",className:"message-input",placeholder:"Type your message...",value:r,$oninput:"update-input",$onkeypress:"key-press"}),s.h("button",{className:"send-button",$onclick:"send-message",disabled:!r.trim()||o},o?"Sending...":"Send")))))}function Vn(t){const{world:e,selectedSettingsTarget:n,selectedAgent:r,totalMessages:l}=t,o=()=>{n==="agent"&&r?confirm(`Clear all messages for agent ${r.name}?`)&&s.run("clear-agent-messages",r):n==="world"&&e&&confirm(`Clear all messages for world ${e.name}?`)&&s.run("clear-world-messages")};return s.h("fieldset",{className:"settings-fieldset"},s.h("legend",null,n==="agent"&&r?`${r.name} Settings`:n==="world"&&e?`${e.name} Settings`:"Settings"),s.h("div",{className:"chat-settings"},n==="agent"&&r?s.h("div",{className:"agent-settings"},s.h("div",{className:"setting-item"},s.h("label",null,"Agent Name:"),s.h("span",{className:"setting-value"},r.name)),s.h("div",{className:"setting-item"},s.h("label",null,"Message Count:"),s.h("span",null,s.h("span",{className:"setting-value"},r.messageCount),s.h("button",{className:"action-btn",$onclick:o,title:"Clear agent messages"},s.h("span",{className:"btn-icon"},"×")))),s.h("div",{className:"setting-item"},s.h("label",null,"LLM Provider:"),s.h("span",{className:"setting-value"},r.provider||"N/A")),s.h("div",{className:"setting-item"},s.h("label",null,"Model:"),s.h("span",{className:"setting-value"},r.model||"N/A")),s.h("div",{className:"setting-item"},s.h("label",null,"Temperature:"),s.h("span",{className:"setting-value"},r.temperature!==void 0?r.temperature:"N/A")),s.h("div",{className:"setting-item"},s.h("div",{className:"setting-label-row"},s.h("label",null,"System Prompt:"),s.h("button",{className:"action-btn edit-prompt-btn",$onclick:()=>s.run("edit-agent-prompt",r),title:"Edit system prompt"},s.h("span",{className:"btn-icon"},"⚙"))),s.h("span",{className:"system-prompt-preview"},r.systemPrompt?r.systemPrompt.length>100?r.systemPrompt.substring(0,100)+"...":r.systemPrompt:"N/A"))):n==="world"&&e?s.h("div",{className:"world-settings"},s.h("div",{className:"setting-item"},s.h("label",null,"World Name:"),s.h("span",{className:"setting-value"},e.name)),s.h("div",{className:"setting-item"},s.h("label",null,"Agents Count:"),s.h("span",null,s.h("span",{className:"setting-value"},e.agents.length),s.h("button",{className:"action-btn",$onclick:()=>s.run("add-agent"),title:"Add new agent"},s.h("span",{className:"btn-icon"},"+")))),s.h("div",{className:"setting-item"},s.h("label",null,"Total Messages:"),s.h("span",null,s.h("span",{className:"setting-value"},l),s.h("button",{className:"action-btn",$onclick:o,title:"Clear all messages"},s.h("span",{className:"btn-icon"},"×")))),s.h("div",{className:"setting-item"},s.h("label",null,"LLM Call Limit:"),s.h("span",{className:"setting-value"},e.llmCallLimit||"Unlimited"))):s.h("div",{className:"default-settings"},s.h("p",null,"Click on an agent or the gear icon to view settings"))))}class qn extends U{constructor(){super(...arguments);k(this,"is_global_event",()=>!0);k(this,"state",async()=>({worldName:"World",world:null,agents:[],messages:[],userInput:"",loading:!0,error:null,agentsLoading:!0,messagesLoading:!1,isSending:!1,isWaiting:!1,selectedSettingsTarget:"world",selectedAgent:null,activeAgent:null}));k(this,"view",n=>n.loading?s.h("div",{className:"world-container"},s.h("div",{className:"world-columns"},s.h("div",{className:"chat-column"},s.h("div",{className:"agents-section"},s.h("div",{className:"agents-row"},s.h("div",{className:"loading-agents"},"Loading..."))),s.h("div",{className:"loading-state"},s.h("p",null,"Loading world data..."))),s.h("div",{className:"settings-column"},s.h("div",{className:"settings-section"},s.h("div",{className:"settings-row"},s.h("button",{className:"world-settings-btn",title:"World Settings"},s.h("span",{className:"world-gear-icon"},"⚙"))))))):n.error?s.h("div",{className:"world-container"},s.h("div",{className:"world-columns"},s.h("div",{className:"chat-column"},s.h("div",{className:"agents-section"},s.h("div",{className:"agents-row"},s.h("div",{className:"no-agents"},"Error"))),s.h("div",{className:"error-state"},s.h("p",null,"Error: ",n.error),s.h("button",{$onclick:["/World",n.worldName]},"Retry"))),s.h("div",{className:"settings-column"},s.h("div",{className:"settings-section"},s.h("div",{className:"settings-row"},s.h("button",{className:"world-settings-btn",title:"World Settings"},s.h("span",{className:"world-gear-icon"},"⚙"))))))):s.h("div",{className:"world-container"},s.h("div",{className:"world-columns"},s.h("div",{className:"chat-column"},s.h("div",{className:"agents-section"},s.h("div",{className:"agents-row"},n.agentsLoading?s.h("div",{className:"loading-agents"},"Loading agents..."):n.agents.length===0?s.h("div",{className:"no-agents"},"No agents in this world"):s.h("div",{className:"agents-list"},n.agents.map((r,l)=>{var a;const o=n.selectedSettingsTarget==="agent"&&((a=n.selectedAgent)==null?void 0:a.id)===r.id;return s.h("div",{key:`agent-${r.id||l}`,className:`agent-item ${o?"selected":""}`,$onclick:["select-agent-settings",r]},s.h("div",{className:"agent-sprite-container"},s.h("div",{className:`agent-sprite sprite-${r.spriteIndex}`}),s.h("div",{className:"message-badge"},r.messageCount)),s.h("div",{className:"agent-name"},r.name))})))),s.h(zn,{worldName:n.worldName,messages:n.messages,userInput:n.userInput,messagesLoading:n.messagesLoading,isSending:n.isSending,isWaiting:n.isWaiting,activeAgent:n.activeAgent,selectedAgent:n.selectedSettingsTarget==="agent"?n.selectedAgent:null})),s.h("div",{className:"settings-column"},s.h("div",{className:"settings-section"},s.h("div",{className:"settings-row"},s.h("button",{className:"world-settings-btn",title:"World Settings",$onclick:"select-world-settings"},s.h("span",{className:"world-gear-icon"},"⚙")))),s.h(Vn,{world:n.world,selectedSettingsTarget:n.selectedSettingsTarget,selectedAgent:n.selectedAgent,totalMessages:n.messages.length})))));k(this,"update",{"/World":async function*(n,r){const l=r?decodeURIComponent(r):"New World";try{yield{...n,worldName:l,loading:!0,error:null,isWaiting:!1,activeAgent:null};const o=await On(l),a=new Map,i=await Promise.all(o.agents.map(async(d,c)=>{var b;d.memory&&Array.isArray(d.memory)&&d.memory.forEach(S=>{const N=`${S.createdAt||Date.now()}-${S.text||S.content||""}`;if(!a.has(N)){const E=S.sender||d.name;let D="agent";(E==="HUMAN"||E==="USER")&&(D="user"),a.set(N,{id:S.id||N,sender:E,text:S.text||S.content||"",createdAt:S.createdAt||new Date().toISOString(),type:D,streamComplete:!0,fromAgentId:d.id})}});const p=d.systemPrompt||"";return{...d,spriteIndex:c%9,messageCount:((b=d.memory)==null?void 0:b.length)||0,provider:d.provider,model:d.model,temperature:d.temperature,systemPrompt:p}})),h=Array.from(a.values()).sort((d,c)=>{const p=new Date(d.createdAt).getTime(),b=new Date(c.createdAt).getTime();return p-b});yield{...n,worldName:l,world:{name:l,agents:i,llmCallLimit:o.llmCallLimit||o.turnLimit},agents:i,messages:h,agentsLoading:!1,loading:!1,error:null,isWaiting:!1,selectedSettingsTarget:"world",selectedAgent:null,activeAgent:null}}catch(o){yield{...n,worldName:l,world:{name:l,agents:[],llmCallLimit:void 0},loading:!1,error:o.message||"Failed to load world data",isWaiting:!1,selectedSettingsTarget:"world",selectedAgent:null,activeAgent:null}}},"update-input":(n,r)=>({...n,userInput:r.target.value}),"key-press":(n,r)=>{r.key==="Enter"&&n.userInput.trim()&&s.run("send-message")},"select-world-settings":n=>({...n,selectedSettingsTarget:"world",selectedAgent:null,messages:n.messages.filter(r=>!r.userEntered)}),"select-agent-settings":(n,r)=>{var l;return n.selectedSettingsTarget==="agent"&&((l=n.selectedAgent)==null?void 0:l.id)===r.id?{...n,selectedSettingsTarget:"world",selectedAgent:null,messages:n.messages.filter(o=>!o.userEntered)}:{...n,selectedSettingsTarget:"agent",selectedAgent:r,userInput:"@"+r.name+" ",messages:n.messages.filter(o=>!o.userEntered)}},"clear-agent-messages":async(n,r)=>{var l;try{await ve(n.worldName,r.name);const o=n.agents.map(d=>d.id===r.id?{...d,messageCount:0}:d),a=n.messages.filter(d=>d.sender!==r.name),i=((l=n.selectedAgent)==null?void 0:l.id)===r.id?{...n.selectedAgent,messageCount:0}:n.selectedAgent,h=n.world?{...n.world,agents:o}:null;return{...n,world:h,agents:o,messages:a,selectedAgent:i}}catch(o){return{...n,error:o.message||"Failed to clear agent messages"}}},"clear-world-messages":async n=>{try{await Promise.all(n.agents.map(a=>ve(n.worldName,a.name)));const r=n.agents.map(a=>({...a,messageCount:0})),l=n.selectedAgent?{...n.selectedAgent,messageCount:0}:null,o=n.world?{...n.world,agents:r}:null;return{...n,world:o,agents:r,messages:[],selectedAgent:l}}catch(r){return{...n,error:r.message||"Failed to clear world messages"}}},"send-message":async n=>{if(!n.userInput.trim())return n;const r=n.userInput,l={id:Date.now()+Math.random(),type:"user",sender:"HUMAN",text:r,createdAt:new Date().toISOString(),worldName:n.worldName,userEntered:!0},o={...n,messages:[...n.messages,l],userInput:"",isSending:!0,isWaiting:!0};try{return await Rn(n.worldName,r,"HUMAN"),{...o,isSending:!1}}catch(a){return{...o,isSending:!1,isWaiting:!1,error:a.message||"Failed to send message"}}},handleStreamStart:(n,r)=>{const l=Dn(n,r),o=r.sender,a=n.agents.find(i=>i.name===o);return{...l,isWaiting:!1,activeAgent:a?{spriteIndex:a.spriteIndex,name:a.name}:null}},handleStreamChunk:(n,r)=>Wn(n,r),handleStreamEnd:(n,r)=>{var i;const l=$n(n,r),o=r.sender;let a={...l,activeAgent:null};if(o&&o!=="HUMAN"){const h=a.agents.map(p=>p.name===o?{...p,messageCount:p.messageCount+1}:p),d=a.world?{...a.world,agents:h}:null,c=((i=a.selectedAgent)==null?void 0:i.name)===o?{...a.selectedAgent,messageCount:a.selectedAgent.messageCount+1}:a.selectedAgent;a={...a,world:d,agents:h,selectedAgent:c}}return a},handleStreamError:(n,r)=>({...Un(n,r),activeAgent:null}),handleMessage:(n,r)=>jn(n,r),handleConnectionStatus:(n,r)=>Hn(n,r),handleError:(n,r)=>Bn(n,r),handleComplete:(n,r)=>Fn(n)})}}s.render("#root",s.h(xn,null));s.addComponents("#pages",{"/":Tn,"/World":qn});
